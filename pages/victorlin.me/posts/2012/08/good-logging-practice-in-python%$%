<!DOCTYPE html>
<html class="no-js">
<head>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"beacon-6.newrelic.com","errorBeacon":"bam.nr-data.net","licenseKey":"8c89158be8","applicationID":"2375507","transactionName":"IF1XEhQLXlQGQhlIDBBGSkkVDF1P","queueTime":0,"applicationTime":163,"ttGuid":"","agentToken":null,"agent":"js-agent.newrelic.com/nr-411.min.js"}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o?o:n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({D5DuLP:[function(t,n){function e(t,n){var e=r[t];return e?e.apply(this,n):(o[t]||(o[t]=[]),void o[t].push(n))}var r={},o={};n.exports=e,e.queues=o,e.handlers=r},{}],handle:[function(t,n){n.exports=t("D5DuLP")},{}],G9z0Bl:[function(t,n){function e(){var t=l.info=NREUM.info;if(t&&t.agent&&t.licenseKey&&t.applicationID&&p&&p.body){l.proto="https"===f.split(":")[0]||t.sslForHttp?"https://":"http://",i("mark",["onload",a()]);var n=p.createElement("script");n.src=l.proto+t.agent,p.body.appendChild(n)}}function r(){"complete"===p.readyState&&o()}function o(){i("mark",["domContent",a()])}function a(){return(new Date).getTime()}var i=t("handle"),u=window,p=u.document,s="addEventListener",c="attachEvent",f=(""+location).split("?")[0],l=n.exports={offset:a(),origin:f,features:[]};p[s]?(p[s]("DOMContentLoaded",o,!1),u[s]("load",e,!1)):(p[c]("onreadystatechange",r),u[c]("onload",e)),i("mark",["firstbyte",a()])},{handle:"D5DuLP"}],loader:[function(t,n){n.exports=t("G9z0Bl")},{}]},{},["G9z0Bl"]);</script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Good logging practice in Python « Victor Lin's coding notes</title>
<meta content="In reality, logging is important. When you transfer money, there are transfer records. When an ai..." name="description">
<meta content="Logdown, blog, markdown" name="keywords">
<meta content="Good logging practice in Python « Victor Lin's coding notes" property="og:title">
<meta content="In reality, logging is important. When you transfer money, there are transfer records. When an ai..." property="og:description">
<meta content="http://victorlin.me/posts/2012/08/26/good-logging-practice-in-python" property="og:url">
<meta charset="UTF-8">
<meta name="author" content="victorlin">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://cdn-theme.logdown.io/frankies/stylesheets/screen.css">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css">
<style type="text/css">
    p {
        word-wrap: normal !important;
    	  word-break: normal !important;
        text-align: justify !important;
    }
  </style>
<script src="http://cdn-theme.logdown.io/frankies/javascripts/zepto.1.0.min.js"></script><script src="http://cdn-theme.logdown.io/frankies/javascripts/modernizr.custom.32405.js"></script><script src="http://cdn-theme.logdown.io/frankies/javascripts/main.js"></script><!-- Fallback fonts from Google Webfonts --><link href="http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic,700italic%7CSource+Code+Pro:400,700" rel="stylesheet" type="text/css">
<meta name="robots" content="INDEX,FOLLOW">
<link href="https://s3.amazonaws.com/logdown-production/system/blog/819/og_image/704731_649335718414057_1352352219_o.jpg" rel="image_src">
<link href="/posts.rss" rel="alternate" title="Victor Lin's coding notes" type="application/rss+xml">
<link href="/posts.atom" rel="alternate" title="Victor Lin's coding notes" type="application/atom+xml">
<script type="text/javascript">

  var _gaq = _gaq || [];
  var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  
  _gaq.push(['_setAccount', 'UA-41764280-1']);
  _gaq.push(['_trackPageview']);
  _gaq.push(['userblog._setAccount', 'UA-34321195-1']);
  _gaq.push(['userblog._trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
  <div class="container">

    <header><div class="site-header">
        <a href="/" class="header-link">
          <div class="site-cover">
            <img src="https://s3.amazonaws.com/logdown-production/system/blog/819/og_image/704731_649335718414057_1352352219_o.jpg">
</div>
          <h1 class="site-title">Victor Lin's coding notes</h1>
        </a>

        <div class="site-navbar">
          <nav role="navigation"><h3 class="hide">Blog Navigation</h3>
            <div class="site-nav-shadow"></div>
            <ul class="inline-list site-nav-links">
<li><a href="/">Home</a></li>
              <li><a href="http://victorlin.me/archives">Archives</a></li>
              <li><a href="http://victorlin.me/posts.atom" target="_blank">RSS</a></li>
              <li class="search-toggle"><a href="/posts/search">Search</a></li>

              
                
                  <li><a href="http://victorlin.me/pages/about">About</a></li>
                
                  <li><a href="http://victorlin.me/pages/works">Works</a></li>
                
              
            </ul>
<form class="site-search" accept-charset="UTF-8" action="/posts/search" method="get" role="search">

              <button class="btn-cancel" type="button" title="Cancel Search">
                <i class="icon-remove"></i>
                <span class="hide">Cancel Search</span>
              </button>

              <input class="site-search-field" name="q" type="search" placeholder="Search blog..." x-webkit-speech><button class="btn-search" type="submit" title="Search">
                <i class="icon-search"></i>
                <span class="hide">Search</span>
              </button>
            </form>
          </nav>
</div>
      </div>
    </header><div class="main-content" role="main">
      

      

      

      


      
        <article class="blog-post" role="article"><div class="post-header">
            <h2 class="post-title">
              <a href="http://victorlin.me/posts/2012/08/26/good-logging-practice-in-python">
                
                  Good logging practice in Python
                

                
              </a>
            </h2>
          </div>
          <div class="post-content">
            

            

            
              <p>In reality, logging is important. When you transfer money, there are transfer records. When an airplane is flying, black box (flight data recorder) is recording everything. If something goes wrong, people can read the log and has a chance to figure out what happened. Likewise, logging is important for system developing, debugging and running.  When a program crashes, if there is no logging record, you have little chance to understand what happened. For example, when you are writing a server, logging is necessary. Following screenshot is the log file of a <a href="http://ezcomet.com">EZComet.com</a> server.</p>

<p><img src="http://user-image.logdown.io/user/822/blog/819/post/142494/ziCqzyTTlWY38sTiog0U_ezcomet_logging.png" alt="ezcomet_logging.png"></p>

<p>Without the log, I can hardly know what’s wrong if a service goes down. Not only for the servers, logging is also important for desktop GUI applications. For instance, when your program crashes on your customer’s PC, you can ask them to send the log files to you, and you may can figure why. Trust me, you will never know what kind of strange issues there will be in different PC environments. I once received an error log report like this</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="mi">2011</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">22</span> <span class="mi">17</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="mi">828</span> <span class="o">-</span> <span class="n">root</span> <span class="o">-</span> <span class="n">ERROR</span> <span class="o">-</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">10104</span><span class="p">]</span> <span class="n">getaddrinfo</span> <span class="n">failed</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;string&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">124</span><span class="p">,</span> <span class="ow">in</span> <span class="n">main</span>
  <span class="n">File</span> <span class="s">"&lt;string&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">20</span><span class="p">,</span> <span class="ow">in</span> <span class="n">__init__</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/wx._core"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">7978</span><span class="p">,</span> <span class="ow">in</span> <span class="n">__init__</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/wx._core"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">7552</span><span class="p">,</span> <span class="ow">in</span> <span class="n">_BootstrapApp</span>
  <span class="n">File</span> <span class="s">"&lt;string&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">84</span><span class="p">,</span> <span class="ow">in</span> <span class="n">OnInit</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/twisted.internet.wxreactor"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">175</span><span class="p">,</span> <span class="ow">in</span> <span class="n">install</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/twisted.internet._threadedselect"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">106</span><span class="p">,</span> <span class="ow">in</span> <span class="n">__init__</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/twisted.internet.base"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">488</span><span class="p">,</span> <span class="ow">in</span> <span class="n">__init__</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/twisted.internet.posixbase"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">266</span><span class="p">,</span> <span class="ow">in</span> <span class="n">installWaker</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/twisted.internet.posixbase"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">74</span><span class="p">,</span> <span class="ow">in</span> <span class="n">__init__</span>
  <span class="n">File</span> <span class="s">"h:</span><span class="err">\</span><span class="s">workspace</span><span class="err">\</span><span class="s">project</span><span class="se">\b</span><span class="s">uild</span><span class="err">\</span><span class="s">pyi.win32</span><span class="err">\</span><span class="s">mrdj</span><span class="err">\</span><span class="s">outPYZ1.pyz/socket"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">224</span><span class="p">,</span> <span class="ow">in</span> <span class="n">meth</span>
<span class="n">gaierror</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">10104</span><span class="p">]</span> <span class="n">getaddrinfo</span> <span class="n">failed</span>
</pre></div>
</figure><p>And eventually figure out that the customer PC is infected by a virus which makes call to gethostname failed. See, how can you even know this if there is no log to read?</p>
<h3>print is not a good idea</h3>
<p>Although logging is important, not all developers know how to use them correctly. I saw some developers insert print statements when developing and remove those statements when it is finished. It may looks like this</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">print</span> <span class="s">'Start reading database'</span>
<span class="n">records</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">read_recrods</span><span class="p">()</span>
<span class="k">print</span> <span class="s">'# records'</span><span class="p">,</span> <span class="n">records</span>
<span class="k">print</span> <span class="s">'Updating record ...'</span>
<span class="n">model</span><span class="o">.</span><span class="n">update_records</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="k">print</span> <span class="s">'done'</span>
</pre></div>
</figure><p>It works when the program is a simple script, but for complex systems, you better not to use this approach. First of all, you cannot leave only important messages in the log, you may see a lots of garbage messages in the log, but can’t find anything useful.You also cannot control those print statements without modifying code, you may forgot to remove those unused prints. And all printed messages go into stdout, which is bad when you have data to output to stdout. Of course you can print messages to stderr, but still, it is not a good practice to use print for logging.</p>
<h3>Use Python standard logging module</h3>
<p>So, how do you do logging correctly? It’s easy, use the standard Python logging module. Thanks to Python community, logging is a standard module, it was well designed to be easy-to-use and very flexible. You can use the <a href="http://docs.python.org/2/library/logging">logging system</a> like this</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Start reading database'</span><span class="p">)</span>
<span class="c"># read database here
</span>
<span class="n">records</span> <span class="o">=</span> <span class="p">{</span><span class="s">'john'</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span> <span class="s">'tom'</span><span class="p">:</span> <span class="mi">66</span><span class="p">}</span>
<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">'Records: </span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">records</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Updating records ...'</span><span class="p">)</span>
<span class="c"># update records here
</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Finish updating records'</span><span class="p">)</span>
</pre></div>
</figure><p>You can run it and see</p>

<figure class="figure-code code"><div class="highlight"><pre>INFO:__main__:Start reading database
INFO:__main__:Updating records ...
INFO:__main__:Finish updating records
</pre></div>
</figure><p>What’s different between the “print” approach you asked. Well, of course there are benefits:</p>

<ul>
<li>You can control message level and filter out not important ones</li>
<li>You can decide where and how to output later</li>
</ul>
<p>There are different  importance levels you can use, debug, info, warning, error and critical. By giving different level to logger or handler, you can write only error messages to specific log file, or record debug details when debugging. Let’s change the logger level to DEBUG and see the output again</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</pre></div>
</figure><p>The output:</p>

<figure class="figure-code code"><div class="highlight"><pre>INFO:__main__:Start reading database
DEBUG:__main__:Records: {'john': 55, 'tom': 66}
INFO:__main__:Updating records ...
INFO:__main__:Finish updating records
</pre></div>
</figure><p>As you can see, we adjust the logger level to DEBUG, then debug records appear in output. You can also decide how these messages are processed. For example, you can use a FileHandler to write records to a file.</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c"># create a file handler
</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s">'hello.log'</span><span class="p">)</span>
<span class="n">handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c"># create a logging format
</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s">'</span><span class="si">%(asctime)</span><span class="s">s - </span><span class="si">%(name)</span><span class="s">s - </span><span class="si">%(levelname)</span><span class="s">s - </span><span class="si">%(message)</span><span class="s">s'</span><span class="p">)</span>
<span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="c"># add the handlers to the logger
</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Hello baby'</span><span class="p">)</span>
</pre></div>
</figure><p>There are different handlers, you can also send records to you mailbox or even a to a remote server. You can also write your own custom logging handler.  I’m not going to tell you details, please reference to official documents: <a href="http://docs.python.org/2/howto/logging.html#logging-basic-tutorial">Basic Tutorial</a>, <a href="http://docs.python.org/2/howto/logging.html#logging-advanced-tutorial">Advanced Tutorial</a> and <a href="http://docs.python.org/2/howto/logging-cookbook.html#logging-cookbook">Logging Cookbook</a>.</p>
<h3>Write logging records everywhere with proper level</h3>
<p>With flexibility of the logging module, you can write logging record everywhere with proper level and configure them later. What is the proper level to use, you may ask. Here I share my experience.</p>

<p>In most cases, you don’t want to read too much details in the log file. Therefore, debug level is only enabled when you are debugging. I use debug level only for detail debugging information, especially when the data is big or the frequency is high, such as records of algorithm internal state changes in a for-loop.</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">def</span> <span class="nf">complex_algorithm</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
        <span class="c"># do some complex algorithm computation
</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">'</span><span class="si">%</span><span class="s">s iteration, item=</span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</pre></div>
</figure><p>I use info level for routines, for example, handling requests or server state changed.</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">def</span> <span class="nf">handle_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Handling request </span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
    <span class="c"># handle request here
</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">'result'</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Return result: </span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">start_service</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Starting service at port </span><span class="si">%</span><span class="s">s ...'</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Service is started'</span><span class="p">)</span>
</pre></div>
</figure><p>I use warning when it is important, but not an error, for example, when a user attempts to login with wrong password or connection is slow.</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="n">user_name</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">user_name</span> <span class="o">!=</span> <span class="n">USER_NAME</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">!=</span> <span class="n">PASSWORD</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">'Login attempt to </span><span class="si">%</span><span class="s">s from IP </span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">user_name</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="c"># do authentication here
</span></pre></div>
</figure><p>I use error level when something is wrong, for example, an exception is thrown, IO operation failure or connectivity issue.</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">def</span> <span class="nf">get_user_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">read_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">'Cannot find user with user_id=</span><span class="si">%</span><span class="s">s'</span><span class="p">,</span> <span class="n">user_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>
    <span class="k">return</span> <span class="n">user</span>
</pre></div>
</figure><p>I seldom use critical, you can use it when something really bad happen, for example, out of memory, disk is full or a nuclear meltdown (Hope that will not happen :S).</p>
<h3>Use _<em>name</em>_ as the logger name</h3>
<p>You don’t have to set the logger name as _<em>name</em><em>, but by doing that, it brings us some benefits. The variable \</em><em>name</em>_ is current module name in Python. For example, you call logger.getLogger(_<em>name</em>_) in a module “foo.bar.my_module”, then it is logger.getLogger(“foo.bar.my_module”). When you need to configure the logger, you can configure to “foo”, then all modules in “foo” packages shares same configuration. You can also understand what is the module of message when reading the log.</p>
<h3>Capture exceptions and record them with traceback</h3>
<p>It is always a good practice to record when something goes wrong, but it won’t be helpful if there is no traceback. You should capture exceptions and record them with traceback. Following is an example:</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="nb">open</span><span class="p">(</span><span class="s">'/path/to/does/not/exist'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="k">except</span> <span class="p">(</span><span class="nb">SystemExit</span><span class="p">,</span> <span class="nb">KeyboardInterrupt</span><span class="p">):</span>
    <span class="k">raise</span>
<span class="k">except</span> <span class="nb">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">'Failed to open file'</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</figure><p>By calling logger methods with exc_info=True parameter,  traceback is dumped to the logger. As you can see the result</p>

<figure class="figure-code code"><div class="highlight"><pre>ERROR:__main__:Failed to open file
Traceback (most recent call last):
  File "example.py", line 6, in &lt;module&gt;
    open('/path/to/does/not/exist', 'rb')
IOError: [Errno 2] No such file or directory: '/path/to/does/not/exist'
</pre></div>
</figure><p>You can also call logger.exception(msg, *args), it equals to logger.error(msg, exc_info=True, *args).</p>
<h3>Do not get logger at the module level unless disable_existing_loggers is False</h3>
<p>You can see a lots of example out there (including this article, I did it just for giving example in short) get logger at module level. They looks harmless, but actually, there is a pitfall – Python logging module respects all created logger before you load the configuration from a file, if you get logger at the module level like this</p>

<p>my_module.py</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Hi, foo'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Hi, bar'</span><span class="p">)</span>
</pre></div>
</figure><p>main.py</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="c"># load my module
</span>
<span class="kn">import</span> <span class="nn">my_module</span>

<span class="c"># load the logging configuration
</span>
<span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">fileConfig</span><span class="p">(</span><span class="s">'logging.ini'</span><span class="p">)</span>

<span class="n">my_module</span><span class="o">.</span><span class="n">foo</span><span class="p">()</span>
<span class="n">bar</span> <span class="o">=</span> <span class="n">my_module</span><span class="o">.</span><span class="n">Bar</span><span class="p">()</span>
<span class="n">bar</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</figure><p>logging.ini</p>

<figure class="figure-code code"><div class="highlight"><pre>[loggers]
keys=root

[handlers]
keys=consoleHandler

[formatters]
keys=simpleFormatter

[logger_root]
level=DEBUG
handlers=consoleHandler

[handler_consoleHandler]
class=StreamHandler
level=DEBUG
formatter=simpleFormatter
args=(sys.stdout,)

[formatter_simpleFormatter]
format=%(asctime)s - %(name)s - %(levelname)s - %(message)s
datefmt=
</pre></div>
</figure><p>And you expect to see the records appear in log, but you will see nothing. Why? Because you create the logger at module level, you then import the module before you load the logging configuration from a file. The logging.fileConfig and logging.dictConfig disables existing loggers by default. So, those setting in file will not be applied to your logger. It’s better to get the logger when you need it. It’s cheap to create or get a logger. You can write the code like this:</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Hi, foo'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Bar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span> <span class="ow">or</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Hi, bar'</span><span class="p">)</span>
</pre></div>
</figure><p>By doing that, the loggers will be created after you load the configuration. The setting will be applied correctly.</p>

<p>Since Python2.7, a new argument name “disable_existing_loggers” to fileConfig and dictConfig (as a parameter in schema) is added, by setting it to False, problem mentioned above can be solved. For example:</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.config</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="c"># load config from file 
</span>
<span class="c"># logging.config.fileConfig('logging.ini', disable_existing_loggers=False)
</span>
<span class="c"># or, for dictConfig
</span>
<span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">({</span>
    <span class="s">'version'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>              
    <span class="s">'disable_existing_loggers'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>  <span class="c"># this fixes the problem
</span>
    <span class="s">'formatters'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'standard'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'format'</span><span class="p">:</span> <span class="s">'</span><span class="si">%(asctime)</span><span class="s">s [</span><span class="si">%(levelname)</span><span class="s">s] </span><span class="si">%(name)</span><span class="s">s: </span><span class="si">%(message)</span><span class="s">s'</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s">'handlers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'default'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'level'</span><span class="p">:</span><span class="s">'INFO'</span><span class="p">,</span>    
            <span class="s">'class'</span><span class="p">:</span><span class="s">'logging.StreamHandler'</span><span class="p">,</span>
        <span class="p">},</span>  
    <span class="p">},</span>
    <span class="s">'loggers'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">''</span><span class="p">:</span> <span class="p">{</span>                  
            <span class="s">'handlers'</span><span class="p">:</span> <span class="p">[</span><span class="s">'default'</span><span class="p">],</span>        
            <span class="s">'level'</span><span class="p">:</span> <span class="s">'INFO'</span><span class="p">,</span>  
            <span class="s">'propagate'</span><span class="p">:</span> <span class="bp">True</span>  
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'It works!'</span><span class="p">)</span>
</pre></div>
</figure><h3>Use JSON or YAML logging configuration</h3>
<p>You can configure your logging system in Python code, but it is not flexible. It’s better to use a logging configuration file. After Python 2.7, you can load logging configuration from a dict. It means you can load the logging configuration from a JSON or YAML file. Although you can use the old .ini style logging configuration, it is difficult to read and write. Here I show you an logging configuration example  in JSON or YAML</p>

<p>logging.json</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="p">{</span><span class="w">
    </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"disable_existing_loggers"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="s2">"formatters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"simple"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"%(asctime)s - %(name)s - %(levelname)s - %(message)s"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"handlers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"console"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"logging.StreamHandler"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DEBUG"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"formatter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"simple"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"stream"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ext://sys.stdout"</span><span class="w">
        </span><span class="p">},</span><span class="w">

        </span><span class="s2">"info_file_handler"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"logging.handlers.RotatingFileHandler"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFO"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"formatter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"simple"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"info.log"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"maxBytes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10485760"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"backupCount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"utf8"</span><span class="w">
        </span><span class="p">},</span><span class="w">

        </span><span class="s2">"error_file_handler"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"logging.handlers.RotatingFileHandler"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ERROR"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"formatter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"simple"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"errors.log"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"maxBytes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10485760"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"backupCount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"encoding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"utf8"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"loggers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"my_module"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ERROR"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"handlers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"console"</span><span class="p">],</span><span class="w">
            </span><span class="s2">"propagate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">

    </span><span class="s2">"root"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFO"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"handlers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"console"</span><span class="p">,</span><span class="w"> </span><span class="s2">"info_file_handler"</span><span class="p">,</span><span class="w"> </span><span class="s2">"error_file_handler"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></div>
</figure><p>logging.yaml</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="s">---</span><span class="err">
</span>
<span class="s">version</span><span class="pi">:</span> <span class="s">1</span><span class="err">
</span>
<span class="s">disable_existing_loggers</span><span class="pi">:</span> <span class="s">False</span><span class="err">
</span>
<span class="s">formatters:</span><span class="err">
</span>
    <span class="s">simple:</span><span class="err">
</span>
        <span class="s">format</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%(asctime)s</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">%(name)s</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">%(levelname)s</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">%(message)s"</span><span class="err">
</span>
<span class="err">
</span>
<span class="s">handlers:</span><span class="err">
</span>
    <span class="s">console:</span><span class="err">
</span>
        <span class="s">class</span><span class="pi">:</span> <span class="s">logging.StreamHandler</span><span class="err">
</span>
        <span class="s">level</span><span class="pi">:</span> <span class="s">DEBUG</span><span class="err">
</span>
        <span class="s">formatter</span><span class="pi">:</span> <span class="s">simple</span><span class="err">
</span>
        <span class="s">stream</span><span class="pi">:</span> <span class="s">ext://sys.stdout</span><span class="err">
</span>

    <span class="s">info_file_handler:</span><span class="err">
</span>
        <span class="s">class</span><span class="pi">:</span> <span class="s">logging.handlers.RotatingFileHandler</span><span class="err">
</span>
        <span class="s">level</span><span class="pi">:</span> <span class="s">INFO            </span><span class="err">
</span>
        <span class="s">formatter</span><span class="pi">:</span> <span class="s">simple</span><span class="err">
</span>
        <span class="s">filename</span><span class="pi">:</span> <span class="s">info.log</span><span class="err">
</span>
        <span class="s">maxBytes</span><span class="pi">:</span> <span class="s">10485760</span> <span class="c1"># 10MB
</span>
        <span class="s">backupCount</span><span class="pi">:</span> <span class="s">20</span><span class="err">
</span>
        <span class="s">encoding</span><span class="pi">:</span> <span class="s">utf8</span><span class="err">
</span>

    <span class="s">error_file_handler:</span><span class="err">
</span>
        <span class="s">class</span><span class="pi">:</span> <span class="s">logging.handlers.RotatingFileHandler</span><span class="err">
</span>
        <span class="s">level</span><span class="pi">:</span> <span class="s">ERROR            </span><span class="err">
</span>
        <span class="s">formatter</span><span class="pi">:</span> <span class="s">simple</span><span class="err">
</span>
        <span class="s">filename</span><span class="pi">:</span> <span class="s">errors.log</span><span class="err">
</span>
        <span class="s">maxBytes</span><span class="pi">:</span> <span class="s">10485760</span> <span class="c1"># 10MB
</span>
        <span class="s">backupCount</span><span class="pi">:</span> <span class="s">20</span><span class="err">
</span>
        <span class="s">encoding</span><span class="pi">:</span> <span class="s">utf8</span><span class="err">
</span>

<span class="s">loggers:</span><span class="err">
</span>
    <span class="s">my_module:</span><span class="err">
</span>
        <span class="s">level</span><span class="pi">:</span> <span class="s">ERROR</span><span class="err">
</span>
        <span class="s">handlers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">console</span><span class="pi">]</span><span class="err">
</span>
        <span class="s">propagate</span><span class="pi">:</span> <span class="s">no</span><span class="err">
</span>

<span class="s">root:</span><span class="err">
</span>
    <span class="s">level</span><span class="pi">:</span> <span class="s">INFO</span><span class="err">
</span>
    <span class="s">handlers</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">console</span><span class="pi">,</span> <span class="nv">info_file_handler</span><span class="pi">,</span> <span class="nv">error_file_handler</span><span class="pi">]</span><span class="err">
</span>
<span class="s">...</span><span class="err">
</span></pre></div>
</figure><p>Following recipe shows you how to read logging configuration from a JSON file:</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging.config</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span>
    <span class="n">default_path</span><span class="o">=</span><span class="s">'logging.json'</span><span class="p">,</span> 
    <span class="n">default_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="n">env_key</span><span class="o">=</span><span class="s">'LOG_CFG'</span>
<span class="p">):</span>
    <span class="s">"""Setup logging configuration

    """</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">default_path</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">env_key</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">default_level</span><span class="p">)</span>
</pre></div>
</figure><p>One advantage of using JSON configuration is that the json is a standard library, you don’t need to install it. But personally, I prefer YAML. It’s very clear to read and easy to write. You can also load the YAML configuration with following recipes</p>

<figure class="figure-code code"><figcaption><span>
</span></figcaption><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging.config</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span>
    <span class="n">default_path</span><span class="o">=</span><span class="s">'logging.yaml'</span><span class="p">,</span> 
    <span class="n">default_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="n">env_key</span><span class="o">=</span><span class="s">'LOG_CFG'</span>
<span class="p">):</span>
    <span class="s">"""Setup logging configuration

    """</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">default_path</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="n">env_key</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">'rt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">default_level</span><span class="p">)</span>
</pre></div>
</figure><p>Now, to setup logging, you can call setup_logging when starting your program. It reads logging.json or logging.yaml by default. You can also set LOG_CFG environment variable to load the logging configuration from specific path. For example,</p>

<figure class="figure-code code"><div class="highlight"><pre>LOG_CFG=my_logging.json python my_server.py
</pre></div>
</figure><p>or if you prefer YAML</p>

<figure class="figure-code code"><div class="highlight"><pre>LOG_CFG=my_logging.yaml python my_server.py
</pre></div>
</figure><h3>Use rotating file handler</h3>
<p>If you use FileHandler for writing logs, the size of log file will grow with time. Someday, it will occupy all of your disk. In order to avoid that situation, you should use RotatingFileHandler instead of FileHandler in production environment.</p>
<h3>Setup a central log server when you have multiple servers</h3>
<p>When you have multiple servers and different log files. You can setup a central log system to collect all important (warning and error messages in most cases). Then you can monitor it easily and notice what’s wrong in your system.</p>
<h3>Conclusions</h3>
<p>I’m glad that Python logging library is nicely designed, and the best part is that it is a standard library, you don’t have to choose. It is flexible, you can write your own handlers and filters. There are also third-party handlers such as <a href="http://zeromq.org">ZeroMQ</a> logging handler provided by <a href="http://zeromq.github.io/pyzmq/">pyzmq</a>, it allows you to send logging messages through a zmq socket. If you don’t know how to use the logging system correctly, this article might be helpful. With good logging practice, you can find issues in your system easier. It’s a nice investment, don’t you buy it? :D</p>
            
          </div>

          
            <div class="post-social-share">
              
                <a href="https://twitter.com/share?" class="twitter-share-button">Tweet</a>
              

              
                <div class="g-plusone" data-size="medium"></div>
              

              
                <div class="fb-like" data-href="http://victorlin.me/posts/2012/08/26/good-logging-practice-in-python" data-layout="button_count" data-send="false" data-show-faces="false" data-width="90"></div>
              
            </div>

            <div class="group post-footer">
              <footer><span class="post-meta pull-left">
                  <time datetime="2012-08-26 14:45:00 UTC" pubdate>
                    August 26, 2012
                  </time></span>

                
              </footer>
</div>
          

        </article><div id="disqus_thread"></div>
      <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'victorlinscodingnotes'; // required: replace example with your forum shortname
        var disqus_identifier = 'http://victorlin.me/posts/2012/08/26/good-logging-practice-in-python/';
        var disqus_url = 'http://victorlin.me/posts/2012/08/26/good-logging-practice-in-python/';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
      <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

          

        

      

      
    </div>

    <div class="site-footer">
      <footer><p>
          © 2013 victorlin.
          <span class="powered-by">
            Powered by <a href="http://logdown.com/">Logdown</a>.
          </span>
          <span class="theme-credit">
            Theme Frankies by <a href="http://about.me/zhusee">Zhusee</a>.
          </span>
        </p>
      </footer>
</div>
  </div>

<iframe src="http://logdown.com/pages/top_controls" width="81" height="26" frameborder="0" scrolling="no" style="position: fixed; z-index: 2147483647; border: 0px; background-color: transparent; overflow: hidden; top: 0px; right: 0px;"></iframe>




<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=146125455579724";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><script type="text/x-mathjax-config">
   MathJax.Hub.Config({
    extensions: ["jsMath2jax.js"]
  });
</script><script src="http://mathjax.logdown.io/MathJax.js?config=TeX-AMS_HTML"></script><script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
disqus_shortname = 'victorlinscodingnotes'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script><!-- Start Alexa Certify Javascript --><script type="text/javascript">
_atrk_opts = { atrk_acct:"KOI0g1aYS500G0", domain:"logdown.com",dynamic: true};
(function() { var as = document.createElement('script'); as.type = 'text/javascript'; as.async = true; as.src = "https://d31qbv1cthcecs.cloudfront.net/atrk.js"; var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(as, s); })();
</script><noscript><img src="https://d5nxst8fruw4z.cloudfront.net/atrk.gif?account=KOI0g1aYS500G0" style="display:none" height="1" width="1" alt=""></noscript>
<!-- End Alexa Certify Javascript -->
</body>
</html>
