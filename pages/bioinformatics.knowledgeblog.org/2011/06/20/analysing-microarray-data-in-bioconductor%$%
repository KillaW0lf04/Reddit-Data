<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="bg">
<head>
	<meta http-equiv="Content-Type" content="application/xhtml+xml;charset=UTF-8" />
	<title>  Analysing microarray data in BioConductor | The Bioinformatics Knowledgeblog</title>
	<meta http-equiv="imagetoolbar" content="no" />
	
	<link rel="stylesheet" href="http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/style.css" type="text/css" media="all" />
	
	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" media="screen" href="http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/ie7-style.css" />
	<![endif]-->

	<!--[if IE]>
	<link rel="stylesheet" type="text/css" media="screen" href="http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/ie-style.css" />
	<![endif]-->

	<link rel="stylesheet" href="http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/print.css" type="text/css" media="print" />
	<link rel="stylesheet" href="http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/mobile.css" type="text/css" media="handheld" />

	<style type="text/css">
		@import url(http://bioinformatics.knowledgeblog.org/wp-content/themes/knowledgeblog/mobile.css) screen and (max-width:801px);
	</style>
	
	<link rel="alternate" type="application/rss+xml" title="The Bioinformatics Knowledgeblog RSS Feed" href="http://bioinformatics.knowledgeblog.org/feed/" />
	<link rel="pingback" href="http://bioinformatics.knowledgeblog.org/xmlrpc.php" />
	
	<link rel="alternate" type="application/rss+xml" title="The Bioinformatics Knowledgeblog &raquo; Analysing microarray data in BioConductor Comments Feed" href="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/feed/" />
<link rel='stylesheet' id='shCore-css'  href='http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/css/shCore.css?ver=3.0.83' type='text/css' media='all' />
<link rel='stylesheet' id='shCoreDefault-css'  href='http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/css/shCoreDefault.css?ver=3.0.83' type='text/css' media='all' />
<link rel='stylesheet' id='shThemeDefault-css'  href='http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/css/shThemeDefault.css?ver=3.0.83' type='text/css' media='all' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://bioinformatics.knowledgeblog.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://bioinformatics.knowledgeblog.org/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Announcing a Bioinformatics Kblog writeathon' href='http://bioinformatics.knowledgeblog.org/2011/06/08/announcing-a-bioinformatics-kblog-writeathon/' />
<link rel='next' title='Analysing microarray data in BioConductor: figures and code' href='http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor-figures-and-code/' />
<meta name="generator" content="WordPress 3.9.1" />
<link rel='canonical' href='http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/' />
<link rel='shortlink' href='http://wp.me/p1CafQ-c' />
<!--Google Scholar tags by kblog-metadata.php-->
<meta name="resource_type" content="knowledgeblog"/>
<meta name="citation_journal_title" content="The Bioinformatics Knowledgeblog"/>
<meta name="citation_publication_date" content="2011/06/20"/>
<meta name="citation_date" content="2011"/>
<meta name="citation_author" content="Daniel Swan"/>
<meta name="citation_authors" content="Swan, Daniel"/>
<meta name="citation_title" content="Analysing microarray data in BioConductor"/>
<!--OGP tags by kblog-metadata.php-->
<meta property="og:site_name" content="The Bioinformatics Knowledgeblog"/>
<meta property="og:title" content="Analysing microarray data in BioConductor"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/"/>
<meta property="og:author" content="http://bioinformatics.knowledgeblog.org/?kblog-header-p=12&amp;kblog-header-author=0"/>
<meta property="article:published_time" content="2011-06-20"/>
	
</head>
<body>

	<div id="header">
				<p class="title"><a href="http://bioinformatics.knowledgeblog.org/">The Bioinformatics Knowledgeblog</a></p>
				<div class="description">A bioinformatics tutorial resource</div>
			</div>
			<div id="content" class="single">
						<div class="post" id="post-12">
				<p class="details_small">
					on June 20, 2011 
					<!-- SJC 16112010 -->
					by
					Daniel Swan					in <a href="http://bioinformatics.knowledgeblog.org/category/tutorials/transcriptomics/" title="View all posts in Transcriptomics" rel="category tag">Transcriptomics</a>, <a href="http://bioinformatics.knowledgeblog.org/category/tutorials/" title="View all posts in Tutorials" rel="category tag">Tutorials</a>, 
					<a href="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/#comments" title="Comment on Analysing microarray data in BioConductor">Comments (29)</a>				</p>
				<h1>Analysing microarray data in BioConductor</h1>
				<div class="post_content">

    <!-- PWL -->
      

				<div class="kcite-section" kcite-section-id="12">
<!-- coins metadata inserted by kblog-metadata -->
<span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc&amp;rfr_id=kblog-metadata.php&amp;rft.title=Analysing+microarray+data+in+BioConductor&amp;rft.source=The+Bioinformatics+Knowledgeblog&amp;rft.date=2011-06-20&amp;rft.identifier=http%3A%2F%2Fbioinformatics.knowledgeblog.org%2F2011%2F06%2F20%2Fanalysing-microarray-data-in-bioconductor%2F&amp;rft.au=Daniel+Swan&amp;rft.format=text&amp;rft.language=English"></span><h2>Introduction</h2>
<p>Microarray analysis is a complex procedure, and using <a href="http://www.r-project.org/">R</a> and the associated <a href="http://www.bioconductor.org/">BioConductor</a> packages can be a daunting task. In this tutorial we are going to show you how to install R and BioConductor, download a dataset from <a href="http://www.ncbi.nlm.nih.gov/geo/">GEO</a>, <a href="http://en.wikipedia.org/wiki/Normalization_(statistics)">normalise</a> it, do some quality control checks and finally analyse it to find differentially expressed genes. The following instructions assume that you are working with a fresh install of an <a href="http://www.ubuntu.com/">Ubuntu</a> based Linux distribution, and includes the installation of all the pre-requisites for the analysis. Some familiarity with Linux is ideal and the instructions were developed on Ubuntu 11.04, R 2.12.1. For a full code listing for this tutorial and figures resulting from it see the <a href="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor-figures-and-code">second part of the article</a>.</p>
<h2>Installation</h2>
<p>Open up a terminal (Applications-&gt;Accessories-&gt;Terminal from the the toolbar)</p>
<p>Install R and BioConductor dependencies, and then start R:</p>
<pre class="brush: bash; auto-links: false;">$ sudo apt-get install r-base-core libxml2-dev libcurl4-openssl-dev curl
$ R</pre>
<p>Now at the R prompt:</p>
<pre class="brush: plain; auto-links: false;">
&gt; # download the BioC installation routines
&gt; source("http://bioconductor.org/biocLite.R")
&gt; # install the core packages
&gt; biocLite()
&gt; # install the GEO libraries
&gt; biocLite("GEOquery")
</pre>
<p>If you are running as an unprivileged user you will be prompted to install the packages into a personal library. We&#8217;re also install the <a href="http://www.bioconductor.org/packages/release/bioc/html/GEOquery.html">GEOquery</a> package at this point. Installing the core BioConductor packages will take some time. GEOquery is an interface to the Gene Expression Omnibus at the NCBI, which holds transcriptomics data in a standardised format.</p>
<h2>Getting the data</h2>
<p>For this tutorial we are going to be working with dataset <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE20986">GSE20986</a>, generated by Dr Andrew Browning. HUVECs are cells often used in research, derived from human umbilical vein, used for investigations into the pathology and physiology of endothelial cells. In this experiment iris, retina and choroidal microvascular endothelial cells were isolated from donor eyes, and compared to HUVECs in order to ascertain if the HUVEC line is a suitable surrogate for studying ocular disorders. The GEO page also includes information on the design of the experiment. We can see that there are triplicate measurements for each set of samples. This splits the samples into four groups &#8220;iris&#8221; &#8220;retina&#8221; &#8220;HUVEC&#8221; and &#8220;choroidal&#8221;.</p>
<p>The GEO Platform is <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GPL570">GPL570</a> &#8211; the GEO short code for the <a href="http://www.affymetrix.com/support/technical/byproduct.affx?product=hg-u133-plus">Affymetrix Human Genome U133 Plus 2.0 Array</a>, a commonly used microarray chip for human transcriptome studies. If we investigate the GSM links such as <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM524662">GSM524662</a> we get more detailed information about the experimental conditions used on each chip. They should be the same for each chip, as they are derived from the same experiment. What is captured is information about how the cell lines were extracted, grown, processed for RNA extraction etc. They also include details on how the RNA was processed and hybridised to the microarray chip, and what machine was used to scan the chips. This data is all captured to ensure compliance to <a href="http://www.mged.org/Workgroups/MIAME/miame_2.0.html">MIAME</a> standards.</p>
<p>For each chip, the data table shows the probeset alongside a normalised expression value for the probeset. The table header description let you know how the data was normalised. In this case you can see the GC-RMA algorithm was used. For more information about GC-RMA you can <a href="http://www.nature.com/nbt/journal/v22/n6/full/nbt0604-656b.html">read this paper</a>.</p>
<p>First of all we need to acquire the raw data directly from GEO. We can do this by loading the GEOquery library, and pointing it to the experiment we want to analyse. This download is approximately 53MB.</p>
<pre class="brush: plain; auto-links: false;">&gt; library(GEOquery)
&gt; getGEOSuppFiles("GSE20986")</pre>
<p>If you open a file browser you will see this creates a GSE20986 directory under the directory you launched R in:</p>
<pre class="brush: bash; auto-links: false;">$ ls GSE20986/
filelist.txt GSE20986_RAW.tar</pre>
<p>The GSE20986_RAW.tar file is a compressed archive of the CEL files (the Affymetrix native file format). Before we can work on them we need to uncompress them. We can achieve this at the R prompt. This uncompresses the tar file (which contains compressed CEL files). The CEL files are subsequently decompressed themselves to the directory in which we are working with R.</p>
<pre class="brush: plain; auto-links: false;">&gt; untar("GSE20986/GSE20986_RAW.tar", exdir="data")
&gt; cels &lt;- list.files("data/", pattern = "[gz]")
&gt; sapply(paste("data", cels, sep="/"), gunzip)
&gt; cels</pre>
<h2>Describing the experiment</h2>
<p>We are now ready to start analysis, however in order to do this we need to capture the experimental information. This is just a text file which describes the chip names, and the source of the biological samples hybridised to them.</p>
<p>To load the data into R using simpleaffy we need to create a file to represent this information. Open a new terminal window and type:</p>
<pre class="brush: bash; auto-links: false;">$ ls data/*.CEL &gt; data/phenodata.txt</pre>
<p>Open this file in a text editor. Currently this is a single column listing the files just a list of the CEL files. The final file needs 3 tab-delimited columns named &#8216;Name&#8217; &#8216;FileName&#8217; and &#8216;Target&#8217;. The FileName and Name columns will be identical in this case, although the Name column can be used to provide a more human readable sample name if desired.</p>
<p>The Target column is information about the samples taken from the GEO page. Label the samples appropriately either &#8216;iris&#8217; &#8216;retina&#8217; &#8216;choroid&#8217; or &#8216;huvec&#8217;. This defines our replicate groups for further analysis when we compare the cell line with the tissue samples.</p>
<p>The final result should look like this (ensure that there are tabs between the columns and not spaces!). You can produce this file in any spreadsheet program providing you save it as &#8216;tab-delimited text&#8217;.</p>
<pre class="brush: plain; auto-links: false;">Name FileName Target
GSM524662.CEL GSM524662.CEL iris
GSM524663.CEL GSM524663.CEL retina
GSM524664.CEL GSM524664.CEL retina
GSM524665.CEL GSM524665.CEL iris
GSM524666.CEL GSM524666.CEL retina
GSM524667.CEL GSM524667.CEL iris
GSM524668.CEL GSM524668.CEL choroid
GSM524669.CEL GSM524669.CEL choroid
GSM524670.CEL GSM524670.CEL choroid
GSM524671.CEL GSM524671.CEL huvec
GSM524672.CEL GSM524672.CEL huvec
GSM524673.CEL GSM524673.CEL huvec</pre>
<h2>Loading and normalising the data</h2>
<p>The <a href="http://www.bioconductor.org/packages/release/bioc/html/simpleaffy.html">simpleaffy</a> package provides routines for handling CEL files including normalisation and loading data with sample information. We are going to load the data into an R object called &#8216;celfiles&#8217;</p>
<pre class="brush: plain; auto-links: false;">&gt; library(simpleaffy)
&gt; celfiles &lt;- read.affy(covdesc="phenodata.txt", path="data")</pre>
<p>You can confirm this has worked, and download the chip annotations at the same time (if this is your first run) by typing:</p>
<pre class="brush: plain; auto-links: false;">&gt; celfiles
AffyBatch object
size of arrays=1164x1164 features (12 kb)
cdf=HG-U133_Plus_2 (54675 affyids)
number of samples=12
number of genes=54675
annotation=hgu133plus2
notes=</pre>
<p>Now we can normalise the data. As with the data deposited in GEO we are going to use the GC-RMA algorithm. If this is the first time you have run it, it will download additional files during the process.</p>
<pre class="brush: plain; auto-links: false;">&gt; celfiles.gcrma &lt;- gcrma(celfiles)
Adjusting for optical effect............Done.
Computing affinitiesLoading required package: AnnotationDbi
.Done.
Adjusting for non-specific binding............Done.
Normalizing
Calculating Expression
</pre>
<p>If you want to see the data associated with the normalised object you can &#8211; you will notice this is no longer an AffyBatch object, but an ExpressionSet object, which holds normalised values.</p>
<pre class="brush: plain; auto-links: false;">&gt; celfiles.gcrma
ExpressionSet (storageMode: lockedEnvironment)
assayData: 54675 features, 12 samples
element names: exprs
protocolData
sampleNames: GSM524662.CEL GSM524663.CEL ... GSM524673.CEL (12 total)
varLabels: ScanDate
varMetadata: labelDescription
phenoData
sampleNames: GSM524662.CEL GSM524663.CEL ... GSM524673.CEL (12 total)
varLabels: sample FileName Target
varMetadata: labelDescription
featureData: none
experimentData: use 'experimentData(object)'
Annotation: hgu133plus2</pre>
<h2>Quality control checks</h2>
<p>Before we analyse the data it is imperative that we do some quality control checks to make sure there are no issues with the dataset. The first thing we can do is check the effects of the GC-RMA normalisation, by plotting a boxplot of probe intensities before and after normalisation.</p>
<pre class="brush: plain; auto-links: false;">
&gt; # load colour libraries
&gt; library(RColorBrewer)
&gt; # set colour palette
&gt; cols &lt;- brewer.pal(8, "Set1")
&gt; # plot a boxplot of unnormalised intensity values
&gt; boxplot(celfiles, col=cols)
&gt; # plot a boxplot of normalised intensity values, affyPLM is required to interrogate celfiles.gcrma
&gt; library(affyPLM)
&gt; boxplot(celfiles.gcrma, col=cols)
&gt; # the boxplots are somewhat skewed by the normalisation algorithm
&gt; # and it is often more informative to look at density plots
&gt; # Plot a density vs log intensity histogram for the unnormalised data
&gt; hist(celfiles, col=cols)
&gt; # Plot a density vs log intensity histogram for the normalised data
&gt; hist(celfiles.gcrma, col=cols)</pre>
<p>From these plots we can conclude that there are no major deviations amongst the 12 chips, and normalisation has brought the intensities from all of the chips into distributions with similar characteristics. To take a closer look at the situation on a per-chip level we can use <a href="http://www.bioconductor.org/packages/release/bioc/html/affyPLM.html">affyPLM</a>. affyPLM allows us to visualise statistical characteristics of the CEL files.</p>
<pre class="brush: plain; auto-links: false;">
&gt; # Perform probe-level metric calculations on the CEL files:
&gt; celfiles.qc &lt;- fitPLM(celfiles)
&gt; # Create an image of GSM24662.CEL:
&gt; image(celfiles.qc, which=1, add.legend=TRUE)
&gt; # Create an image of GSM524665.CEL
&gt; # There is a spatial artifact present
&gt; image(celfiles.qc, which=4, add.legend=TRUE)
&gt; # affyPLM also provides more informative boxplots
&gt; # RLE (Relative Log Expression) plots should have
&gt; # values close to zero. GSM524665.CEL is an outlier
&gt; RLE(celfiles.qc, main="RLE")
&gt; # We can also use NUSE (Normalised Unscaled Standard Errors).
&gt; # The median standard error should be 1 for most genes.
&gt; # GSM524665.CEL appears to be an outlier on this plot too
&gt; NUSE(celfiles.qc, main="NUSE")
</pre>
<p>We can also look at the relationships between the samples using heirarchical clustering:</p>
<pre class="brush: plain; auto-links: false;">
&gt; eset &lt;- exprs(celfiles.gcrma)
&gt; distance &lt;- dist(t(eset),method="maximum")
&gt; clusters &lt;- hclust(distance)
&gt; plot(clusters)</pre>
<p>This suggests our HUVEC samples are very much a separate group compared to the eye tissues, which show some evidence of clustering by tissue type. GSM524665.CEL does not appear to be a particular outlier in this view.</p>
<h2>Filtering data</h2>
<p>Now we have looked at the data, we can go on to analyse it. The first stage of analysis is to filter out uninformative data such as control probesets and other internal controls as well as removing genes with low variance, that would be unlikely to pass statistical tests for differential expression, or are expressed uniformly close to background detection levels. The modifiers to nsFilter below tell nsFilter not to remove probesets without Entrez Gene identifiers, or have duplicated Entrez Gene identifiers.</p>
<pre class="brush: plain; auto-links: false;">
&gt; celfiles.filtered &lt;- nsFilter(celfiles.gcrma, require.entrez=FALSE, remove.dupEntrez=FALSE)
&gt; # What got removed and why?
&gt; celfiles.filtered$filter.log
$numLowVar
[1] 27307

$feature.exclude
[1] 62
</pre>
<p>From this we conclude 27,307 probesets have been removed for reasons of low variance, and 62 control probesets have been removed as well.</p>
<h2>Finding differentially expressed probesets</h2>
<p>Now we have a filtered dataset, we can send the information to limma for differential gene expression analysis. First of all we need to extract information about the samples:</p>
<pre class="brush: plain; auto-links: false;">&gt; samples &lt;- celfiles.gcrma$Target
&gt; # check the results of this
&gt; samples
[1] "iris" "retina" "retina" "iris" "retina" "iris" "choroid"
[8] "choroid" "choroid" "huvec" "huvec" "huvec"
&gt; # convert into factors
&gt; samples &lt;- as.factor(samples)
&gt; # check factors have been assigned
&gt; samples
[1] iris retina retina iris retina iris choroid choroid choroid
[10] huvec huvec huvec
Levels: choroid huvec iris retina
&gt; # set up the experimental design
&gt; design &lt;- model.matrix(~0 + samples)
&gt; colnames(design) &lt;- c("choroid", "huvec", "iris", "retina")
&gt; # inspect the experiment design
&gt; design
choroid huvec iris retina
1 0 0 1 0
2 0 0 0 1
3 0 0 0 1
4 0 0 1 0
5 0 0 0 1
6 0 0 1 0
7 1 0 0 0
8 1 0 0 0
9 1 0 0 0
10 0 1 0 0
11 0 1 0 0
12 0 1 0 0
attr(,"assign")
[1] 1 1 1 1
attr(,"contrasts")
attr(,"contrasts")$samples
[1] "contr.treatment"
</pre>
<p>At this point we have normalised filtered data, and a description of the data and the samples and experimental design. This can be fed into limma for analysis.</p>
<pre class="brush: plain; auto-links: false;">&gt; library(limma)
&gt; # fit the linear model to the filtered expression set
&gt; fit &lt;- lmFit(exprs(celfiles.filtered$eset), design)
&gt; # set up a contrast matrix to compare tissues v cell line
&gt; contrast.matrix &lt;- makeContrasts(huvec_choroid = huvec - choroid, huvec_retina = huvec - retina, huvec_iris &lt;- huvec - iris, levels=design)
&gt; # check the contrast matrix
&gt; contrast.matrix
Contrasts
Levels huvec_choroid huvec_retina huvec_iris
choroid -1 0 0
huvec 1 1 1
iris 0 0 -1
retina 0 -1 0
&gt; # Now the contrast matrix is combined with the per-probeset linear model fit.
&gt; huvec_fits &lt;- contrasts.fit(fit, contrast.matrix)
&gt; huvec_ebFit &lt;- eBayes(huvec_fits)
&gt; # return the top 10 results for any given contrast
&gt; # coef=1 is huvec_choroid, coef=2 is huvec_retina
&gt; topTable(huvec_ebFit, number=10, coef=1)
ID logFC AveExpr t P.Value adj.P.Val
6147 204779_s_at 7.367947 4.171874 72.77016 3.290669e-15 8.985500e-11
7292 207016_s_at 6.934796 4.027229 57.37259 3.712060e-14 5.068076e-10
8741 209631_s_at 5.193313 4.003541 51.22423 1.177337e-13 1.071612e-09
26309 242809_at 6.433514 4.167462 48.52518 2.042404e-13 1.394247e-09
6828 205893_at 4.480463 3.544350 40.59376 1.253534e-12 6.845801e-09
20232 227377_at 3.670688 3.209217 36.03427 4.200854e-12 1.911809e-08
6222 204882_at -5.351976 6.512018 -34.70239 6.154318e-12 2.400711e-08
27051 38149_at -5.051906 6.482418 -31.44098 1.672263e-11 5.282592e-08
6663 205576_at 6.586372 4.139236 31.31584 1.741131e-11 5.282592e-08
6589 205453_at 3.623706 3.210306 30.72793 2.109110e-11 5.759136e-08
B
6147 20.25563
7292 19.44681
8741 18.96282
26309 18.70767
6828 17.75331
20232 17.01960
6222 16.77196
27051 16.08854
6663 16.05990
6589 15.92277
</pre>
<p>To impose a fold change cut off, and see how many genes are returned you can use the lfc modifier for topTable, here we show the results for fold changes of 5,4,3 and 2 in terms of the number of probesets.</p>
<pre class="brush: plain; auto-links: false;">&gt; nrow(topTable(huvec_ebFit, coef=1, number=10000, lfc=5))
[1] 88
&gt; nrow(topTable(huvec_ebFit, coef=1, number=10000, lfc=4))
[1] 194
&gt; nrow(topTable(huvec_ebFit, coef=1, number=10000, lfc=3))
[1] 386
&gt; nrow(topTable(huvec_ebFit, coef=1, number=10000, lfc=2))
[1] 1016
&gt; # Get a list for probesets with a four fold change or more
&gt; probeset.list &lt;- topTable(huvec_ebFit, coef=1, number=10000, lfc=4)
</pre>
<h3>Annotating the results with associated gene symbols</h3>
<p>In order to annotate the probesets into gene symbols we need to install and load the associated database package and the annotate package, then we can extract the probeset ID&#8217;s from the topTable results, and match the symbols</p>
<pre class="brush: plain; auto-links: false;">
&gt; biocLite("hgu133plus2.db")
&gt; library(hgu133plus2.db)
&gt; library(annotate)
&gt; gene.symbols &lt;- getSYMBOL(probeset.list$ID, "hgu133plus2")
&gt; results &lt;- cbind(probeset.list, gene.symbols)
&gt; head(results)
ID logFC AveExpr t P.Value adj.P.Val
6147 204779_s_at 7.367947 4.171874 72.77016 3.290669e-15 8.985500e-11
7292 207016_s_at 6.934796 4.027229 57.37259 3.712060e-14 5.068076e-10
8741 209631_s_at 5.193313 4.003541 51.22423 1.177337e-13 1.071612e-09
26309 242809_at 6.433514 4.167462 48.52518 2.042404e-13 1.394247e-09
6828 205893_at 4.480463 3.544350 40.59376 1.253534e-12 6.845801e-09
6222 204882_at -5.351976 6.512018 -34.70239 6.154318e-12 2.400711e-08
B gene.symbols
6147 20.25563 HOXB7
7292 19.44681 ALDH1A2
8741 18.96282 GPR37
26309 18.70767 IL1RL1
6828 17.75331 NLGN1
6222 16.77196 ARHGAP25
&gt; write.table(results, "results.txt", sep="\t", quote=FALSE)
</pre>
<p>There is a follow-on article from Simon Cockell on analyising the <a href="http://bioinformatics.knowledgeblog.org/2011/06/20/downstream-functional-analysis-of-an-omics-experiment-using-freely-available-tools/">biological significance of results</a> and another article by <a href="http://bioinformatics.knowledgeblog.org/2011/06/21/volcano-plots-of-microarray-data/">Colin Gillespie</a> on visualising data from expression analysis as volcano plots.</p>
<!-- kcite active, but no citations found -->
</div> <!-- kcite-section 12 -->
    <!-- PWL -->
    


				</div>
				<p>Tags: <a href="http://bioinformatics.knowledgeblog.org/tag/analysis/" rel="tag">analysis</a>, <a href="http://bioinformatics.knowledgeblog.org/tag/bioconductor-2/" rel="tag">bioconductor</a>, <a href="http://bioinformatics.knowledgeblog.org/tag/microarray/" rel="tag">microarray</a>, <a href="http://bioinformatics.knowledgeblog.org/tag/r-2/" rel="tag">r</a><br /></p>
							</div>
			<div class="comments">
			<h2 id="comments">29 Comments</h2>
	<ol class="commentlist">
					<li  id="comment-3">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=48' class='avatar avatar-48 photo avatar-default' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor-figures-and-code/' rel='external nofollow' class='url'>Analysing microarray data in BioConductor: figures and code &raquo; The Bioinformatics Knowledgeblog</a></p>
				<p class="comment-data"><a href="#comment-3" title="">June 20, 2011 @ 9:58 am</a></p>
								<p><p>[...] Analysing microarray data in BioConductor [...]</p>
</p>
			</li>
					<li  id="comment-4">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=48' class='avatar avatar-48 photo avatar-default' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://bioinformatics.knowledgeblog.org/2011/06/20/downstream-functional-analysis-of-an-omics-experiment-using-freely-available-tools/' rel='external nofollow' class='url'>Downstream functional analysis of an &#8216;omics experiment using freely available tools &raquo; The Bioinformatics Knowledgeblog</a></p>
				<p class="comment-data"><a href="#comment-4" title="">June 20, 2011 @ 4:45 pm</a></p>
								<p><p>[...] will be introduced. We will focus on the downstream analysis of the gene list produced by the Analysing microarray data in R and BioConductor tutorial. Hypergeometric tests for over-representation of functional [...]</p>
</p>
			</li>
					<li  id="comment-9">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=48' class='avatar avatar-48 photo avatar-default' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://bioinformatics.knowledgeblog.org/2011/06/21/volcano-plots-of-microarray-data/' rel='external nofollow' class='url'>Volcano plots of microarray data &raquo; The Bioinformatics Knowledgeblog</a></p>
				<p class="comment-data"><a href="#comment-9" title="">June 21, 2011 @ 2:14 pm</a></p>
								<p><p>[...] Volcano plots of microarray data  Transcriptomics, Tutorials Add comments   Jun 212011    To run the R commands in this post, you should first work through Analysing microarry data in BioConductor. [...]</p>
</p>
			</li>
					<li  id="comment-26">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/df1645b61197d9464329459b64d4a908?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://Problem' rel='external nofollow' class='url'>Andreas</a></p>
				<p class="comment-data"><a href="#comment-26" title="">June 22, 2011 @ 5:56 am</a></p>
								<p><p>HI Daniel,<br />
Thank you for your wonderful Tutorial. I try to analyze some data, but even when I try to test your example I will get the following warnings and no data was downloaded.<br />
&gt; getGEOSuppFiles(&#8220;GSE20986&#8243;)<br />
[1] &#8220;ftp://ftp.ncbi.nih.gov/pub/geo/DATA/supplementary/series/GSE20986/&#8221;<br />
Warnmeldungen:<br />
1: In download.file(file.path(url, i), destfile = file.path(storedir,  :<br />
  download had nonzero exit status<br />
2: In download.file(file.path(url, i), destfile = file.path(storedir,  :<br />
  download had nonzero exit status</p>
<p>I am using Win Vista (german language) with R 2.13.0. Even with google I couldn&#8217;t find any solution on this problem. I would be very thankful, if you could help me.<br />
Thanks in advance<br />
Andreas</p>
</p>
			</li>
					<li class="author" id="comment-27">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://knowledgeblog.org' rel='external nofollow' class='url'>dswan</a></p>
				<p class="comment-data"><a href="#comment-27" title="">June 22, 2011 @ 8:29 am</a></p>
								<p><p>Andreas, sorry I don&#8217;t use Windows and this was not tested on Windows.  As the automated retrieval of the CEL files is a very minor component I suggest you download them and untar them (with 7zip on Windows) directly from the NCBI site:</p>
<p><a href="ftp://ftp.ncbi.nih.gov/pub/geo/DATA/supplementary/series/GSE20986/GSE20986_RAW.tar" rel="nofollow">ftp://ftp.ncbi.nih.gov/pub/geo/DATA/supplementary/series/GSE20986/GSE20986_RAW.tar</a></p>
</p>
			</li>
					<li  id="comment-33">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=48' class='avatar avatar-48 photo avatar-default' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://bioinformatics.knowledgeblog.org/2011/06/21/review-of-analysing-microarray-data-in-bioconductor/' rel='external nofollow' class='url'>Review of &#8220;Analysing microarray data in BioConductor&#8221; &raquo; The Bioinformatics Knowledgeblog</a></p>
				<p class="comment-data"><a href="#comment-33" title="">June 23, 2011 @ 10:58 am</a></p>
								<p><p>[...] article describes a statistical analysis of the GSE20986 data set. This data set consists of four [...]</p>
</p>
			</li>
					<li  id="comment-147">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/256ed551e99eaa53a8668bfe0a1ea0b2?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">guqi</p>
				<p class="comment-data"><a href="#comment-147" title="">August 22, 2011 @ 12:40 am</a></p>
								<p><p>HI Daniel,<br />
Thank you for your Tutorial.But I am facing a problem.<br />
boxplot(celfiles.gcrma,col=cols)<br />
Error in x[!xna] : object of type &#8216;S4&#8242; is not subsettable<br />
In addition: Warning messages:<br />
1: In is.na(x) : is.na() applied to non-(list or vector) of type &#8216;S4&#8242;<br />
2: In is.na(x) : is.na() applied to non-(list or vector) of type &#8216;S4&#8242;</p>
</p>
			</li>
					<li  id="comment-172">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/d7895a61992ff8214a1d0f5eec670a94?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">wkwok</p>
				<p class="comment-data"><a href="#comment-172" title="">September 14, 2011 @ 9:11 pm</a></p>
								<p><p>Hi,</p>
<p>I&#8217;m also having the same problem as guqi. I was wondering if anyone found a solution or a work around yet?</p>
</p>
			</li>
					<li  id="comment-239">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/5f3be1d5ee82b6a3107c28b454006a68?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Kumar</p>
				<p class="comment-data"><a href="#comment-239" title="">March 13, 2012 @ 5:28 am</a></p>
								<p><p>Hi<br />
I am also facing the same problem as wkwok and guqi. I hope author should be able to sort it out.</p>
<p>Regards</p>
</p>
			</li>
					<li class="author" id="comment-241">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-241" title="">March 13, 2012 @ 9:24 am</a></p>
								<p><p>Dear guqi, wkowk and Kumar.  I have just been through the tutorial and it works perfectly well under R 2.11 under Linux.  It seems the error is not due to the command you are running, but the failure of a previous command.  I would need to see the entire session, including all commands run and errors generated.  The output from sessionInfo() would also be useful.  Please do not post them there, but create them on <a href="http://pastebin.com/" rel="nofollow">http://pastebin.com/</a> and provide a link and I will take a look to see if I can help solve the problem, but the tutorial as it stands works perfectly well in my hands.</p>
</p>
			</li>
					<li  id="comment-285">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/56e16555cc2ea875d1c8c852d22bdc19?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Sylvie</p>
				<p class="comment-data"><a href="#comment-285" title="">April 9, 2012 @ 8:05 pm</a></p>
								<p><p>Hello Daniel&#8230;<br />
I am running R 2.10 under Linux and I have the same error message as guqi&#8230; Have you found a solution?</p>
</p>
			</li>
					<li  id="comment-291">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/7b73df6e29eeb3a4974f6ea49aecfb6e?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Ulrik</p>
				<p class="comment-data"><a href="#comment-291" title="">April 13, 2012 @ 9:40 am</a></p>
								<p><p>I had the same problem:</p>
<p>&gt;hist(celfiles.gcrma, col=cols)<br />
Error in hist.default(celfiles.gcrma, col = cols) : &#8216;x&#8217; must be numeric</p>
<p>&gt; boxplot(celfiles.gcrma, col=cols)<br />
Error in x[!xna] : object of type &#8216;S4&#8242; is not subsettable<br />
In addition: Warning messages:<br />
1: In is.na(x) : is.na() applied to non-(list or vector) of type &#8216;S4&#8242;<br />
2: In is.na(x) : is.na() applied to non-(list or vector) of type &#8216;S4&#8242;</p>
<p>I loaded affyPLM and problems were solved</p>
</p>
			</li>
					<li class="author" id="comment-292">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-292" title="">April 13, 2012 @ 1:40 pm</a></p>
								<p><p>Ulrik, thanks very much for spotting this &#8211; I had run through the tutorial in response to questions but I guess my workspace had affyPLM() loaded already.  I have modified the text to reflect the fact affyPLM needs to be loaded earlier.</p>
</p>
			</li>
					<li  id="comment-319">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/b96029ec60d3ee5e01db870c764cf5b4?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/' rel='external nofollow' class='url'>sarita</a></p>
				<p class="comment-data"><a href="#comment-319" title="">April 21, 2012 @ 1:28 pm</a></p>
								<p><p>when i run to programm to on my sample data.i got a geo file then i run a commpressed file into uncompressed file ,i run on this command convert tar into untar the error appeared<br />
untar(“GSE16070/GSE16070_RAW.tar”, exdir=”data”)<br />
Error in getOct(block, 100, 8) : invalid octal digit<br />
pls,what is solution to remove this error.pls sir, help me.</p>
</p>
			</li>
					<li class="author" id="comment-320">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-320" title="">April 21, 2012 @ 1:39 pm</a></p>
								<p><p>Sarita, I believe this might be a bug in the GEOquery package version you are using.  Please upgrade to 2.23.1 from here: <a href="http://bioconductor.org/packages/release/bioc/html/GEOquery.html" rel="nofollow">http://bioconductor.org/packages/release/bioc/html/GEOquery.html</a></p>
<p>Please see this thread for why I think it is the case: </p>
<p><a href="http://permalink.gmane.org/gmane.science.biology.informatics.conductor/40319" rel="nofollow">http://permalink.gmane.org/gmane.science.biology.informatics.conductor/40319</a></p>
<p>As a general hint it would be better to ask on the BioConductor mailing list for help with BioConductor related issues.  BioConductor develops rapidly, as does R, and these instructions are clearly stated to work for R 2.12.1 on Ubuntu.</p>
</p>
			</li>
					<li  id="comment-359">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/c1c43ce4c9158a93f7998f4962329cc6?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Jane</p>
				<p class="comment-data"><a href="#comment-359" title="">May 24, 2012 @ 4:06 am</a></p>
								<p><p>Hi Daniel,<br />
I&#8217;m trying to follow your example before working with a data set that I&#8217;m interested as I&#8217;m new to working with analysing data in bioconductor.<br />
I&#8217;ve created the phenodata.txt file through the shell:<br />
ls unzip/*.CEL &gt; unzip/phenodata.txt</p>
<p>and then when working in R and using the command:<br />
celfiles&lt;-read.affy(covdesc=&quot;phenodata.txt&quot;, path=&quot;unzip&quot;)</p>
<p>it comes back with this :<br />
Error: the following are not valid files:<br />
    unzip/unzip/GSM524663.CEL<br />
   unzip/unzip/GSM524664.CEL<br />
   unzip/unzip/GSM524665.CEL<br />
   unzip/unzip/GSM524666.CEL<br />
   unzip/unzip/GSM524667.CEL<br />
   unzip/unzip/GSM524668.CEL<br />
   unzip/unzip/GSM524669.CEL<br />
   unzip/unzip/GSM524670.CEL<br />
   unzip/unzip/GSM524671.CEL<br />
   unzip/unzip/GSM524672.CEL<br />
   unzip/unzip/GSM524673.CEL</p>
<p>Any advice in this roadblock would be very much appreciated!</p>
</p>
			</li>
					<li  id="comment-360">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/c1c43ce4c9158a93f7998f4962329cc6?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Jane</p>
				<p class="comment-data"><a href="#comment-360" title="">May 24, 2012 @ 4:48 am</a></p>
								<p><p>One more question:<br />
I&#8217;m using the sample data set still as a run through and am returned with &#8220;argument is not a matrix&#8221; when I try to run the below assignment.  </p>
<p>distance &lt;- dist(t(celfiles.gcrma$eset),method=&quot;maximum&quot;)<br />
Error in t.default(celfiles.gcrma$eset) : argument is not a matrix</p>
</p>
			</li>
					<li  id="comment-361">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/1dfdb4a540b375b6751bdacc73a26adf?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Sanchari</p>
				<p class="comment-data"><a href="#comment-361" title="">May 26, 2012 @ 7:21 pm</a></p>
								<p><p>Hi Daniel,<br />
I am a newbie with R.<br />
There was a problem in uncompressing the GSE tar file of the above dataset. So I downloaded the GSMs individually in the working directory. I am confused regarding which command I should execute next ?<br />
Thanks !</p>
</p>
			</li>
					<li class="author" id="comment-362">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-362" title="">May 27, 2012 @ 9:47 am</a></p>
								<p><p>Sanchari, if you have downloaded the files into a subdirectory of your current working directory called &#8220;data&#8221; then going from &#8220;Describing the Experiment&#8221; should work as advertised.</p>
</p>
			</li>
					<li class="author" id="comment-363">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-363" title="">May 27, 2012 @ 9:53 am</a></p>
								<p><p>Jane, your problem is almost certainly related to your paths &#8211; are you sure the files are in an unzip/unzip directory? I think you have inadvertently created an additional level of directories if so, and R is looking in the wrong place for the CEL files.  I suspect you may have introduced the extra directory at the point you create the phenodata.txt file, which you then attempt to use again when you read the data in &#8211; doubly specifying &#8216;unzip&#8217; in the read.affy instruction.</p>
<p>Try sticking to the suggested directory structure in the tutorial if you continue to have problems.</p>
</p>
			</li>
					<li  id="comment-365">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/1dfdb4a540b375b6751bdacc73a26adf?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Sanchari</p>
				<p class="comment-data"><a href="#comment-365" title="">May 28, 2012 @ 6:33 pm</a></p>
								<p><p>Hi Daniel,</p>
<p>Sorry to bother again. I am getting the following error when I am typing:</p>
<p>&gt; distance &lt;- dist(t(celfiles.gcrma$eset),method=&quot;maximum&quot;)&quot;<br />
 Error in t.default(celfiles.gcrma$eset) : argument is not a matrix&quot;</p>
<p>Do you have any idea why I am getting this ?</p>
<p>Thanks!</p>
</p>
			</li>
					<li class="author" id="comment-366">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-366" title="">May 28, 2012 @ 8:32 pm</a></p>
								<p><p>Sanchari, Jane</p>
<p>I don&#8217;t know why that section of the tutorial has changed with R/BioC releases. I&#8217;ve made some changes to that section so it now works &#8211; please have another go!</p>
</p>
			</li>
					<li  id="comment-379">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/1dfdb4a540b375b6751bdacc73a26adf?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Sanchari</p>
				<p class="comment-data"><a href="#comment-379" title="">May 31, 2012 @ 7:15 am</a></p>
								<p><p>Thanks Daniel. I was able to complete the tutorial.</p>
</p>
			</li>
					<li  id="comment-516">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/b3aea574e7e46485823edd9d0e2c2886?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Oskari</p>
				<p class="comment-data"><a href="#comment-516" title="">August 28, 2012 @ 7:44 am</a></p>
								<p><p>Hello,<br />
Very nice and well explained tutorial.</p>
<p>I am mostly a newbie at this sort of thing, so here&#8217;s a sort of a question conserning the use of nsFilter after normalization. nsFilter documents references R. Bourgon et al. (www.pnas.org/cgi/doi/10.1073/pnas.0914005107) in which article the use of filtering is not recommended when using limma with small sample sizes. As this example has three samples per type of different sample, could you elaborate a bit on the usage of filtering (of course I am not exactly sure if the article refers to total sample size or sample size per different type of sample).</p>
</p>
			</li>
					<li class="author" id="comment-518">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/ceaabf10cb9f44271fc2b04f6d6fe774?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://www.ogt.co.uk' rel='external nofollow' class='url'>Daniel Swan</a></p>
				<p class="comment-data"><a href="#comment-518" title="">August 29, 2012 @ 5:21 pm</a></p>
								<p><p>I would highlight that whilst the workflow is something I would use for analysis, it is here for demonstration and tutorial purposes and not as an example of &#8220;best practice&#8221;.  I regard Huber very highly, but I was not aware of this paper when writing the tutorial.  Every expression experiment is different and should be analysed on its own merits &#8211; so not all steps will be appropriate for all experiments.</p>
</p>
			</li>
					<li  id="comment-519">
				<span class="avatar"><img alt='' src='http://1.gravatar.com/avatar/380e246803c0d04e80f3c816dc9ed5ad?s=48&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author"><a href='http://No' rel='external nofollow' class='url'>Omax</a></p>
				<p class="comment-data"><a href="#comment-519" title="">September 12, 2012 @ 7:33 pm</a></p>
								<p><p>Hi,Mr.Daniel, I was quite impressed by the way of presenting the tutorial.Thanks a lot.</p>
</p>
			</li>
					<li  id="comment-689">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/403b09a03a028db7070ccb17cba7b35d?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Feseha</p>
				<p class="comment-data"><a href="#comment-689" title="">January 6, 2013 @ 12:20 pm</a></p>
								<p><p>Hi Daniel;<br />
Thanks for an excellent tutorial.<br />
It run without a problem on Windows7.<br />
Since I have GnuWin32 package on my PATH,<br />
even the linux commands worked fine!<br />
Thank you and Keep up the good work.<br />
Feseha A.</p>
</p>
			</li>
					<li  id="comment-690">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/403b09a03a028db7070ccb17cba7b35d?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Feseha A.</p>
				<p class="comment-data"><a href="#comment-690" title="">January 6, 2013 @ 12:31 pm</a></p>
								<p><p>Hi Daniel;<br />
I just wanted to add that by chance I had installed<br />
a package prior to starting the tutorial and so the<br />
link to biocLite was open. As I progressed in the<br />
tutorial, that allowed the session to download and<br />
install packages it needed with one exception and<br />
even that I was able to install without interrupting<br />
the tutorial by manually invoking on the ptompt like:<br />
&gt;biocLite(&#8220;limma&#8221;)<br />
&#8230; Just in case it hepls future &#8220;students&#8221;<br />
Thanks again<br />
Feseha</p>
</p>
			</li>
					<li  id="comment-757">
				<span class="avatar"><img alt='' src='http://0.gravatar.com/avatar/86e059a7d97968eeb5b88823d223c557?s=48&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D48&amp;r=G' class='avatar avatar-48 photo' height='48' width='48' /></span>
				<p class="comment-author">Leandro Mattos</p>
				<p class="comment-data"><a href="#comment-757" title="">January 28, 2013 @ 8:44 pm</a></p>
								<p><p>Hy Daniel, your tutorial is really very good. Packages in this tutorial are run in several papers published and the step for step of tutorial is very explained. Congratulations!<br />
The same time, I would like of ask you if you have some tutorial about analysis of transcriptional regulatory networks ou Protein-protein interaction using igraph package in R. Because, I&#8217; didn&#8217;t found any tutorial step-step explained, please send for my E-mail: <a href="mailto:mattoslmp@yahoo.com.br">mattoslmp@yahoo.com.br</a>, or if it is possible to publish your bloog.</p>
<p>I will be grateful for any help you can provide.</p>
<p>Leandro</p>
</p>
			</li>
			</ol>
 
							<h2 id="respond">Leave a comment</h2>
									<p><a href="http://bioinformatics.knowledgeblog.org/wp-login.php?redirect_to=http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/">Login</a></p>
										</div>
			<div class="navigation">
				<div class="prev"><a href="http://bioinformatics.knowledgeblog.org/2011/06/08/announcing-a-bioinformatics-kblog-writeathon/" rel="prev">Announcing a Bioinformatics Kblog writeathon</a></div>
				<div class="next"><a href="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor-figures-and-code/" rel="next">Analysing microarray data in BioConductor: figures and code</a></div>
			</div>
		</div>
		<div id="sidebarFrame">	

	<div id="sidebarA" class="sidebar">
	<ul>
		<li id="categories-3" class="widget widget_categories"><h2 class="widgettitle">Categories</h2>
		<ul>
	<li class="cat-item cat-item-7135"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/bioinformatics-apis/" title="View all posts filed under Bioinformatics APIs">Bioinformatics APIs</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/data-integration/" title="View all posts filed under Data integration">Data integration</a>
</li>
	<li class="cat-item cat-item-139"><a href="http://bioinformatics.knowledgeblog.org/category/events/" title="View all posts filed under Events">Events</a>
</li>
	<li class="cat-item cat-item-7144"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/grid-and-cloud-computing/" title="View all posts filed under Grid and Cloud Computing">Grid and Cloud Computing</a>
</li>
	<li class="cat-item cat-item-7119"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/metabolic-modelling/" title="View all posts filed under Metabolic modelling">Metabolic modelling</a>
</li>
	<li class="cat-item cat-item-5733"><a href="http://bioinformatics.knowledgeblog.org/category/reviews/" title="View all posts filed under Reviews">Reviews</a>
</li>
	<li class="cat-item cat-item-7113"><a href="http://bioinformatics.knowledgeblog.org/category/software-comparisons/" title="View all posts filed under Software Comparisons">Software Comparisons</a>
</li>
	<li class="cat-item cat-item-7122"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/statistics/" title="View all posts filed under Statistics">Statistics</a>
</li>
	<li class="cat-item cat-item-7140"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/systems-biology/" title="View all posts filed under Systems Biology">Systems Biology</a>
</li>
	<li class="cat-item cat-item-7101"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/transcriptomics/" title="View all posts filed under Transcriptomics">Transcriptomics</a>
</li>
	<li class="cat-item cat-item-7100"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/" title="View all posts filed under Tutorials">Tutorials</a>
</li>
		</ul>
</li>
<li id="kblog-boilerplate" class="widget kblog_boilerplate_widget">
<h2 class="widgettitle"> Citation </h2>

Please cite this article as:
Daniel Swan (2011) Analysing microarray data in BioConductor. <i>The Bioinformatics Knowledgeblog</i>.
<a href="http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/">http://bioinformatics.knowledgeblog.org/2011/06/20/analysing-microarray-data-in-bioconductor/</a>

<p></li>
<li id="archives-3" class="widget widget_archive"><h2 class="widgettitle">Archives</h2>
		<ul>
	<li><a href='http://bioinformatics.knowledgeblog.org/2011/07/'>July 2011</a></li>
	<li><a href='http://bioinformatics.knowledgeblog.org/2011/06/'>June 2011</a></li>
		</ul>
</li>
<li id="kblog-archive" class="widget kblog_archive_widget">
<h2 class="widgettitle"> Archived </h2>

<ul>
<li><a href="http://greycite.knowledgeblog.org/?uri=http%3A%2F%2Fbioinformatics.knowledgeblog.org%2F2011%2F06%2F20%2Fanalysing-microarray-data-in-bioconductor%2F">GreyCite</a></li>
<li><a href="http://www.webarchive.org.uk/wayback/archive/http%3A%2F%2Fbioinformatics.knowledgeblog.org%2F2011%2F06%2F20%2Fanalysing-microarray-data-in-bioconductor%2F">www.webarchive.org.uk</a></li>
<li><a href="http://wayback.archive.org/web/http%3A%2F%2Fbioinformatics.knowledgeblog.org%2F2011%2F06%2F20%2Fanalysing-microarray-data-in-bioconductor%2F">www.archive.org</a></li>
<li><a href="http://webcitation.org/query.php?url=http%3A%2F%2Fbioinformatics.knowledgeblog.org%2F2011%2F06%2F20%2Fanalysing-microarray-data-in-bioconductor%2F">webcitation.org</a></li>
</ul>
<li id="linkcat-7084" class="widget widget_links"><h2 class="widgettitle">Knowledgeblogs</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://health.knowledgeblog.org">Health and Public Health</a></li>
<li><a href="http://knowledgeblog.org">Knowledgeblog</a></li>
<li><a href="http://ontogenesis.knowledgeblog.org">Ontogenesis</a></li>
<li><a href="http://process.knowledgeblog.org">Process</a></li>
<li><a href="http://taverna.knowledgeblog.org">Taverna</a></li>

	</ul>
</li>

<li id="linkcat-7085" class="widget widget_links"><h2 class="widgettitle">Social</h2>

	<ul class='xoxo blogroll'>
<li><a href="http://twitter.com/kblogorg">Knowledgeblog on Twitter</a></li>
<li><a href="http://www.youtube.com/knowledgeblog">Knowledgeblog on YouTube</a></li>

	</ul>
</li>

<li id="meta-3" class="widget widget_meta"><h2 class="widgettitle">Meta</h2>
			<ul>
						<li><a href="http://bioinformatics.knowledgeblog.org/wp-login.php">Log in</a></li>
			<li><a href="http://bioinformatics.knowledgeblog.org/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://bioinformatics.knowledgeblog.org/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</li>
	</ul>
</div>
<div id="sidebarB" class="sidebar">
	<ul>
					<li><h2>Pages:</h2>
				<ul>
				<li class="page_item page-item-2"><a href="http://bioinformatics.knowledgeblog.org/">About</a></li>
<li class="page_item page-item-452"><a href="http://bioinformatics.knowledgeblog.org/table-of-contents/">Table of Contents</a></li>
				</ul>
			</li>
			<li><h2>Categories:</h2>
				<ul>
					<li class="cat-item cat-item-139"><a href="http://bioinformatics.knowledgeblog.org/category/events/" title="View all posts filed under Events">Events</a>
</li>
	<li class="cat-item cat-item-5733"><a href="http://bioinformatics.knowledgeblog.org/category/reviews/" title="View all posts filed under Reviews">Reviews</a>
</li>
	<li class="cat-item cat-item-7113"><a href="http://bioinformatics.knowledgeblog.org/category/software-comparisons/" title="View all posts filed under Software Comparisons">Software Comparisons</a>
</li>
	<li class="cat-item cat-item-7100"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/" title="View all posts filed under Tutorials">Tutorials</a>
<ul class='children'>
	<li class="cat-item cat-item-7135"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/bioinformatics-apis/" title="View all posts filed under Bioinformatics APIs">Bioinformatics APIs</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/data-integration/" title="View all posts filed under Data integration">Data integration</a>
</li>
	<li class="cat-item cat-item-7144"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/grid-and-cloud-computing/" title="View all posts filed under Grid and Cloud Computing">Grid and Cloud Computing</a>
</li>
	<li class="cat-item cat-item-7119"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/metabolic-modelling/" title="View all posts filed under Metabolic modelling">Metabolic modelling</a>
</li>
	<li class="cat-item cat-item-7122"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/statistics/" title="View all posts filed under Statistics">Statistics</a>
</li>
	<li class="cat-item cat-item-7140"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/systems-biology/" title="View all posts filed under Systems Biology">Systems Biology</a>
</li>
	<li class="cat-item cat-item-7101"><a href="http://bioinformatics.knowledgeblog.org/category/tutorials/transcriptomics/" title="View all posts filed under Transcriptomics">Transcriptomics</a>
</li>
</ul>
</li>
				</ul>
			</li>
			</ul>
</div>
<div id="sidebarC" class="sidebar">
	<ul>
					<li><h2>Archives:</h2>
				<ul>
					<li><a href='http://bioinformatics.knowledgeblog.org/2011/07/'>July 2011</a></li>
	<li><a href='http://bioinformatics.knowledgeblog.org/2011/06/'>June 2011</a></li>
				</ul>
			</li>
			<li><h2>Meta:</h2>
				<ul>
										<li><a href="http://bioinformatics.knowledgeblog.org/wp-login.php">Log in</a></li>
					<li><a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional">Valid <abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a></li>
					<li><a href="http://bioinformatics.knowledgeblog.org/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
					<li><a href="http://bioinformatics.knowledgeblog.org/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
									</ul>
			</li>
			</ul>
</div>
	</div>

	<div id="footer">
		<p>
		Powered by <a href='http://wordpress.org/' title='Powered by WordPress, state-of-the-art semantic personal publishing platform.'><strong>WordPress</strong></a>.
		<a href="http://greatgonzo.net/projects/gonzodaily">GonzoDaily</a> theme by <a href="http://greatgonzo.net">Gonzo</a>.
		</p>
		<p>
		<a href="http://bioinformatics.knowledgeblog.org/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a>, <a href="http://bioinformatics.knowledgeblog.org/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a>
		<!-- <br />49 queries. 0.192 seconds. -->
		</p>
<!-- Kcite Plugin Installed: Disabled as there are no shortcodes-->
<!-- MathJax Latex Plugin installed: Disabled as no shortcodes on this page --><script type="text/javascript" src="http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/js/shCore.js?ver=3.0.83"></script>
<script type="text/javascript" src="http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/js/shBrushBash.js?ver=3.0.83"></script>
<script type="text/javascript" src="http://bioinformatics.knowledgeblog.org/wp-content/plugins/syntax-highlighter/3.0.83/js/shBrushPlain.js?ver=3.0.83"></script>
<script type="text/javascript">//<![CDATA[
SyntaxHighlighter.all();
//]]></script>
<!--stats_footer_test--><script src="http://stats.wordpress.com/e-201427.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'23872222',v:'ext',post:'12'});
var load_cmc = function(){linktracker_init(23872222,12,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script>

	</div>
	
</body>
</html>