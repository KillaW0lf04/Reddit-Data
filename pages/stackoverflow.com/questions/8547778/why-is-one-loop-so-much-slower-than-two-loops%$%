<!DOCTYPE html>
<html>
<head>
    
    <title>c++ - Why is one loop so much slower than two loops? - Stack Overflow</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/stackoverflow/img/favicon.ico?v=038622610830">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png?v=fd7230a85918">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon@2.png?v=fde65a5a78c6"/>
    <meta name="og:title" content="Why is one loop so much slower than two loops?" />
    <meta name="og:description" content="Suppose a1, b1, c1, and d1 point to heap memory and my numerical code has the following core loop.

const int n=100000

for(int j=0;j&amp;lt;n;j++){
    a1[j] += b1[j];
    c1[j] += d1[j];
}


This loo..." />
    <meta name="og:url" content="http://stackoverflow.com/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops"/>
    <link rel="canonical" href="http://stackoverflow.com/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops" />

    
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=d142d951ee55"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/stackoverflow/all.css?v=dc5a5d7ef830">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Why is one loop so much slower than two loops?&#39;" href="/feeds/question/8547778">
    <script>
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:10,shownCommentCount:5,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:8547778});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('1', '8547778');
            
                    });
    </script>


    <script>
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1404248455,"networkMetaHostname":"meta.stackexchange.com","styleCode":true,"enableUserHovercards":true,"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","enableNewTagCreationWarning":true,"nonAsciiTags":true,"enableSocialMediaInSharePopup":true},"user":{"fkey":"8c6b727b7d57e168eb0f1d8a05eba522","isAnonymous":true}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"12ef2711e474","js/moderator.en.js":"e2c6bab58c56","js/full-anon.en.js":"a66b4586d8f3","js/full.en.js":"d43401f72f80","js/wmd.en.js":"d25c057c3f48","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"5f0b5c72eaa8","js/help.en.js":"43b6b771d4d9","js/tageditor.en.js":"afabf8d8de91","js/tageditornew.en.js":"140e973e4037","js/inline-tag-editing.en.js":"21223186b436","js/revisions.en.js":"989c474e85a9","js/review.en.js":"c261687765b3","js/tagsuggestions.en.js":"bb4721d888d2","js/post-validation.en.js":"62fe2d3d1730","js/explore-qlist.en.js":"8b8b631bd679","js/events.en.js":"7263182fd2c2"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
    </script>
    
        <script>
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page new-topbar">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
<div class="topbar">
    <div class="topbar-wrapper">
        
        <div class="js-topbar-dialog-corral">

<div class="topbar-dialog siteSwitcher-dialog dno">
    <div class="header">
        <h3><a href="//stackoverflow.com">current community</a></h3>
    </div>
    <div class="modal-content current-site-container">
        <ul class="current-site">
                <li>
                        <div class="related-links">
            <a href="http://chat.stackoverflow.com"     data-gps-track="site_switcher.click({ item_type:6 })"
>chat</a>
                    <a href="http://blog.stackoverflow.com"     data-gps-track="site_switcher.click({ item_type:7 })"
>blog</a>
            </div>




    <a href="//stackoverflow.com"
       class="current-site-link site-link js-gps-track"
       data-id="1"
       data-gps-track="
        site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                </li>
                <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    



    <a href="http://meta.stackoverflow.com"
       class="site-link js-gps-track"
       data-id="552"
       data-gps-track="
            site.switch({ target_site:552, item_type:3 }),
        site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                </li>
                            <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    <a class="site-link"
                       href="//careers.stackoverflow.com"
                            data-gps-track="site_switcher.click({ item_type:9 })"
>
                        <div class="site-icon favicon favicon-careers" title="Stack Overflow Careers"></div>
                        Careers 2.0
                    </a>
                </li>
        </ul>
    </div>
    
    <div class="header" id="your-communities-header">
        <h3>
your communities        </h3>
            
    </div>
    <div class="modal-content" id="your-communities-section">
            
            <div class="call-to-login">
                        <a href="https://stackoverflow.com/users/signup?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f8547778%2fwhy-is-one-loop-so-much-slower-than-two-loops" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:10 })"
>Sign up</a>
                    or
                    <a href="https://stackoverflow.com/users/login?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f8547778%2fwhy-is-one-loop-so-much-slower-than-two-loops" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:11 })"
>log in</a>

                    to customize your list.
            </div>
    </div>
    
    <div class="header">
        <h3><a href="//stackexchange.com/sites">more stack exchange communities</a></h3>
    </div>
    <div class="modal-content">
            <div class="child-content"></div>
    </div>
</div>
        </div>

        <div class="network-items">
            
            <a href="//stackexchange.com" 
               class="topbar-icon icon-site-switcher yes-hover js-site-switcher-button js-gps-track"
               data-gps-track="site_switcher.show"
               title="A list of all 128 Stack Exchange sites">
                <span class="hidden-text">Stack Exchange</span>
            </a>
            
        </div>

        <div class="topbar-links">
            
                <div class="links-container">
                    <span class="topbar-menu-links">
                            <a href="https://stackoverflow.com/users/signup?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f8547778%2fwhy-is-one-loop-so-much-slower-than-two-loops" class="login-link">sign up</a>
                            <a href="https://stackoverflow.com/users/login?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f8547778%2fwhy-is-one-loop-so-much-slower-than-two-loops" class="login-link">log in</a>
                            <a href="/tour">tour</a>

                            <a href="#" class="icon-help js-help-button" title="Help Center and other resources">
        help
        <span class="triangle"></span>
    </a>
    <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                                    <li>
                        <a href="/tour"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })"
>
                            Tour
                            <span class="item-summary">
                                Start here for a quick overview of the site
                            </span>
                        </a>
                    </li>
                <li>
                    <a href="/help"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })"
>
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                    <li>
                        <a href="//meta.stackoverflow.com"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })"
>
                            Meta
                            <span class="item-summary">
                                Discuss the workings and policies of this site
                            </span>
                        </a>
                    </li>
            </ul>
        </div>
    </div>

                            <a href="//careers.stackoverflow.com">careers 2.0</a>
                    </span>
                </div>

			<div class="search-container">
                <form id="search" action="/search" method="get" autocomplete="off">
                    <input name="q" type="text" placeholder="search" value="" tabindex="1" autocomplete="off" maxlength="240" />
                </form>
			</div>
            	
        </div>      
    </div> 
</div>
<script>
    StackExchange.ready(function () { StackExchange.topbar.init(); });
</script>
    <div class="container">
        <div id="header" class=headeranon>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                        <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                        <li><a id="nav-tags" href="/tags">Tags</a></li>
                        <li><a id="nav-users" href="/users">Users</a></li>
                        <li><a id="nav-badges" href="/help/badges">Badges</a></li>
                        <li><a id="nav-unanswered" href="/unanswered">Unanswered</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
			<!--googleoff: all-->

<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/tour" id="tell-me-more" class="button">Take the 2-minute tour</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Stack Overflow is a question and answer site for professional and enthusiast programmers. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("question-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops" class="question-hyperlink">Why is one loop so much slower than two loops?</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="8547778"  id="question">

    <script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk1840673846",4).setZone(43) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk1840673846">
            </div>    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8547778">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post high-scored-post">1010</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b>484</b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>Suppose <code>a1</code>, <code>b1</code>, <code>c1</code>, and <code>d1</code> point to heap memory and my numerical code has the following core loop.</p>

<pre><code>const int n=100000

for(int j=0;j&lt;n;j++){
    a1[j] += b1[j];
    c1[j] += d1[j];
}
</code></pre>

<p>This loop is executed 10,000 times via another outer <code>for</code> loop. To speed it up, I changed the code to:</p>

<pre><code>for(int j=0;j&lt;n;j++){
    a1[j] += b1[j];
}
for(int j=0;j&lt;n;j++){
    c1[j] += d1[j];
}
</code></pre>

<p>Compiled on MS <a href="http://en.wikipedia.org/wiki/Visual_C++#32-bit_versions">Visual C++ 10.0</a> with full optimization and <a href="http://en.wikipedia.org/wiki/SSE2">SSE2</a> enabled for 32-bit on a <a href="http://en.wikipedia.org/wiki/Intel_Core_2">Intel Core 2</a> Duo (x64), the first example takes 5.5&nbsp;seconds and the double-loop example takes only 1.9&nbsp;seconds. My question is: (Please refer to the my rephrased question at the bottom)</p>

<p>PS: I am not sure, if this helps:</p>

<p>Disassembly for the first loop basically looks like this (this block is repeated about five times in the full program):</p>

<pre><code>movsd       xmm0,mmword ptr [edx+18h]
addsd       xmm0,mmword ptr [ecx+20h]
movsd       mmword ptr [ecx+20h],xmm0
movsd       xmm0,mmword ptr [esi+10h]
addsd       xmm0,mmword ptr [eax+30h]
movsd       mmword ptr [eax+30h],xmm0
movsd       xmm0,mmword ptr [edx+20h]
addsd       xmm0,mmword ptr [ecx+28h]
movsd       mmword ptr [ecx+28h],xmm0
movsd       xmm0,mmword ptr [esi+18h]
addsd       xmm0,mmword ptr [eax+38h]
</code></pre>

<p>Each loop of the double loop example produces this code (the following block is repeated about three times):</p>

<pre><code>addsd       xmm0,mmword ptr [eax+28h]
movsd       mmword ptr [eax+28h],xmm0
movsd       xmm0,mmword ptr [ecx+20h]
addsd       xmm0,mmword ptr [eax+30h]
movsd       mmword ptr [eax+30h],xmm0
movsd       xmm0,mmword ptr [ecx+28h]
addsd       xmm0,mmword ptr [eax+38h]
movsd       mmword ptr [eax+38h],xmm0
movsd       xmm0,mmword ptr [ecx+30h]
addsd       xmm0,mmword ptr [eax+40h]
movsd       mmword ptr [eax+40h],xmm0
</code></pre>

<p><strong>EDIT:</strong> The question turned out to be of no relevance, as the behavior severely depends on the sizes of the arrays (n) and the CPU cache. So if there is further interest, I rephrase the question:</p>

<p><strong>Could you provide some solid insight into the details that lead to the different cache behaviors as illustrated by the five regions on the following graph?</strong></p>

<p><strong>It might also be interesting to point out the differences between CPU/cache architectures, by providing a similar graph for these CPUs.</strong></p>

<p>PPS: The <strong>full code</strong> is at <a href="http://pastebin.com/ivzkuTzG">http://pastebin.com/ivzkuTzG</a>. It uses TBB Tick_Count for higher resolution timing, which can be disabled by not defining the
TBB_TIMING Macro.</p>

<p>(It shows FLOP/s for different values of <code>n</code>.)</p>

<p><img src="http://i.stack.imgur.com/keuWU.gif" alt="enter image description here"></p>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/c" class="post-tag" title="show questions tagged &#39;c&#39;" rel="tag">c</a> <a href="/questions/tagged/performance" class="post-tag" title="show questions tagged &#39;performance&#39;" rel="tag">performance</a> <a href="/questions/tagged/compiler-optimization" class="post-tag" title="show questions tagged &#39;compiler-optimization&#39;" rel="tag">compiler-optimization</a> <a href="/questions/tagged/vectorization" class="post-tag" title="show questions tagged &#39;vectorization&#39;" rel="tag">vectorization</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/q/8547778" title="short permalink to this question" class="short-link" id="link-post-8547778">share</a><span class="lsep">|</span><a href="/posts/8547778/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/8547778/revisions" title="show all edits to this post">edited <span title="2011-12-27 17:40:27Z" class="relativetime">Dec 27 '11 at 17:40</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
    <td class="post-signature owner">
        <div class="user-info user-hover">
    <div class="user-action-time">
        asked <span title="2011-12-17 20:40:52Z" class="relativetime">Dec 17 '11 at 20:40</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/578832/johannes-gerer"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/d9fba057e51ffee5988a14572e6692e1?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/578832/johannes-gerer">Johannes Gerer</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">5,487</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="11 silver badges"><span class="badge2"></span><span class="badgecount">11</span></span><span title="22 bronze badges"><span class="badge3"></span><span class="badgecount">22</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
                
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8547778" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="5" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10590517" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Could be the operating system which slows while search the physical memory each time you access it and has something like cache in case of secondary access to the same memblock.</span>
                &ndash;&nbsp;
                    <a href="/users/1000930/alextheo"
                       title="1964 reputation"
                       class="comment-user">AlexTheo</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:47:14Z" class="relativetime-clean">Dec 17 '11 at 20:47</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590583" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Are you compiling with optimizations? That looks like a lot of asm code for O2...</span>
                &ndash;&nbsp;
                    <a href="/users/673730/luchian-grigore"
                       title="132749 reputation"
                       class="comment-user">Luchian Grigore</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:53:45Z" class="relativetime-clean">Dec 17 '11 at 20:53</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590734" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I asked what appears to be a <a href="http://stackoverflow.com/questions/1126529/what-is-the-cost-of-an-l1-cache-miss">similar question</a> some time ago.  It or the answers might have information of interest.</span>
                &ndash;&nbsp;
                    <a href="/users/23478/mark-wilkins"
                       title="29028 reputation"
                       class="comment-user">Mark Wilkins</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:10:23Z" class="relativetime-clean">Dec 17 '11 at 21:10</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10591461" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="hot">20</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Just to be picky, these two code snippets are not equivalent due to potentially overlapping pointers.  C99 has the <code>restrict</code> keyword for such situations.  I don&#39;t know if MSVC has something similar.  Of course, if this were the issue then the SSE code would not be correct.</span>
                &ndash;&nbsp;
                    <a href="/users/510306/user510306"
                       title="160 reputation"
                       class="comment-user">user510306</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 22:28:01Z" class="relativetime-clean">Dec 17 '11 at 22:28</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10610810" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">This may have something to do with memory aliasing. With one loop, <code>d1&#91;j&#93;</code> may aliase with <code>a1&#91;j&#93;</code>, so the compiler may retract from doing some memory optimisations. While that doesn&#39;t happen if you separate the writings to memory in two loops.</span>
                &ndash;&nbsp;
                    <a href="/users/260313/rturrado"
                       title="1150 reputation"
                       class="comment-user">rturrado</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-19 11:50:01Z" class="relativetime-clean">Dec 19 '11 at 11:50</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8547778" data-rep=50 data-anon=true
			   class="comments-link " 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments." 
				>show <b>5</b> more comments</a>
    </td>
</tr>        </table>
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								10 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/8547778/why-is-one-loop-so-much-slower-than-two-loops?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="8547993"></a>
<div id="answer-8547993" class="answer accepted-answer" data-answerid="8547993" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8547993">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">878</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>Upon further analysis of this, I believe this is (at least partially) caused by data alignment of the four pointers. This will cause some level of cache bank/way conflicts.</p>

<p>If I've guessed correctly on how you are allocating your arrays, they <strong><em>are likely to be aligned to the page line</em></strong>.</p>

<p>This means that all your accesses in each loop will fall on the same cache way. However, Intel processors have had 8-way L1 cache associativity for a while. But in reality, the performance isn't completely uniform. Accessing 4-ways is still slower than say 2-ways.</p>

<p><strong>EDIT : It does in fact look like you are allocating all the arrays separately.</strong>
Usually when such large allocations are requested, the allocator will request fresh pages from the OS. Therefore, there is a high chance that large allocations will appear at the same offset from a page-boundary.</p>

<p><strong>Here's the test code:</strong></p>

<pre><code>int main(){
    const int n = 100000;

#ifdef ALLOCATE_SEPERATE
    double *a1 = (double*)malloc(n * sizeof(double));
    double *b1 = (double*)malloc(n * sizeof(double));
    double *c1 = (double*)malloc(n * sizeof(double));
    double *d1 = (double*)malloc(n * sizeof(double));
#else
    double *a1 = (double*)malloc(n * sizeof(double) * 4);
    double *b1 = a1 + n;
    double *c1 = b1 + n;
    double *d1 = c1 + n;
#endif

    //  Zero the data to prevent any chance of denormals.
    memset(a1,0,n * sizeof(double));
    memset(b1,0,n * sizeof(double));
    memset(c1,0,n * sizeof(double));
    memset(d1,0,n * sizeof(double));

    //  Print the addresses
    cout &lt;&lt; a1 &lt;&lt; endl;
    cout &lt;&lt; b1 &lt;&lt; endl;
    cout &lt;&lt; c1 &lt;&lt; endl;
    cout &lt;&lt; d1 &lt;&lt; endl;

    clock_t start = clock();

    int c = 0;
    while (c++ &lt; 10000){

#if ONE_LOOP
        for(int j=0;j&lt;n;j++){
            a1[j] += b1[j];
            c1[j] += d1[j];
        }
#else
        for(int j=0;j&lt;n;j++){
            a1[j] += b1[j];
        }
        for(int j=0;j&lt;n;j++){
            c1[j] += d1[j];
        }
#endif

    }

    clock_t end = clock();
    cout &lt;&lt; "seconds = " &lt;&lt; (double)(end - start) / CLOCKS_PER_SEC &lt;&lt; endl;

    system("pause");
    return 0;
}
</code></pre>

<hr>

<p><strong>Benchmark Results:</strong></p>

<h1>EDIT: Results on an <em>actual</em> Core 2 architecture machine:</h1>

<p><strong>2 x Intel Xeon X5482 Harpertown @ 3.2 GHz:</strong></p>

<pre><code>#define ALLOCATE_SEPERATE
#define ONE_LOOP
00600020
006D0020
007A0020
00870020
seconds = 6.206

#define ALLOCATE_SEPERATE
//#define ONE_LOOP
005E0020
006B0020
00780020
00850020
seconds = 2.116

//#define ALLOCATE_SEPERATE
#define ONE_LOOP
00570020
00633520
006F6A20
007B9F20
seconds = 1.894

//#define ALLOCATE_SEPERATE
//#define ONE_LOOP
008C0020
00983520
00A46A20
00B09F20
seconds = 1.993
</code></pre>

<p>Observations:</p>

<ul>
<li><p><strong>6.206 seconds</strong> with one loop and <strong>2.116 seconds</strong> with two loops. This reproduces the OP's results exactly.</p></li>
<li><p><strong>In the first two tests, the arrays are allocated separately.</strong> You'll notice that they all have the same alignment relative to the page.</p></li>
<li><p><strong>In the second two tests, the arrays are packed together to break that alignment.</strong> Here you'll notice both loops are faster. Furthermore, the second (double) loop is now the slower one as you would normally expect.</p></li>
</ul>

<p>As @Stephen Cannon points out in the comments, there is very likely possibility that this alignment causes <strong><em>false aliasing</em></strong> in the load/store units or the cache. I Googled around for this and found that Intel actually has a hardware counter for <strong><em>partial address aliasing</em></strong> stalls:</p>

<p><a href="http://software.intel.com/sites/products/documentation/doclib/stdxe/2013/~amplifierxe/pmw_dp/events/partial_address_alias.html">http://software.intel.com/sites/products/documentation/doclib/stdxe/2013/~amplifierxe/pmw_dp/events/partial_address_alias.html</a></p>

<hr>

<h1>5 Regions - Explanations</h1>

<p><strong>Region 1:</strong></p>

<p>This one is easy. The dataset is so small that the performance is dominated by overhead like looping and branching.</p>

<p><strong>Region 2:</strong></p>

<p><strike>Here, as the data sizes increases, the amount of relative overhead goes down and the performance "saturates". Here two loops is slower because it has twice as much loop and branching overhead.</strike></p>

<p>I'm not sure exactly what's going on here... Alignment could still play an effect as Agner Fog mentions <a href="http://www.agner.org/optimize/blog/read.php?i=142">cache bank conflicts</a>. (That link is about Sandy Bridge, but the idea should still be applicable to Core 2.)</p>

<p><strong>Region 3:</strong></p>

<p>At this point, the data no longer fits in L1 cache. So performance is capped by the L1 &lt;-> L2 cache bandwidth.</p>

<p><strong>Region 4:</strong></p>

<p>The performance drop in the single-loop is what we are observing. And as mentioned, this is due to the alignment which (most likely) causes <strong><em>false aliasing</em></strong> stalls in the processor load/store units.</p>

<p>However, in order for false aliasing to occur, there must be a large enough stride between the datasets. This is why you don't see this in region 3.</p>

<p><strong>Region 5:</strong></p>

<p>At this point, nothing fits in cache. So you're bound by memory bandwidth.</p>

<hr>

<p><img src="http://i.stack.imgur.com/ElCGL.png" alt="2 x Intel X5482 Harpertown @ 3.2 GHz">
<img src="http://i.stack.imgur.com/QMpwj.png" alt="Intel Core i7 870 @ 2.8 GHz">
<img src="http://i.stack.imgur.com/NpyhG.png" alt="Intel Core i7 2600K @ 4.4 GHz"></p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8547993" title="short permalink to this answer" class="short-link" id="link-post-8547993">share</a><span class="lsep">|</span><a href="/posts/8547993/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/8547993/revisions" title="show all edits to this post">edited <span title="2014-04-05 19:42:18Z" class="relativetime">Apr 5 at 19:42</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/608639/jww"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/aPIhh.jpg?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/608639/jww">jww</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">8,652</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="37 silver badges"><span class="badge2"></span><span class="badgecount">37</span></span><span title="91 bronze badges"><span class="badge3"></span><span class="badgecount">91</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2011-12-17 21:17:37Z" class="relativetime">Dec 17 '11 at 21:17</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/922184/mysticial"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/Wv6qh.jpg?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/922184/mysticial">Mysticial</a><br>
        <span class="reputation-score" title="reputation score 163390" dir="ltr">163k</span><span title="27 gold badges"><span class="badge1"></span><span class="badgecount">27</span></span><span title="182 silver badges"><span class="badge2"></span><span class="badgecount">182</span></span><span title="221 bronze badges"><span class="badge3"></span><span class="badgecount">221</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8547993" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="27" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10590830" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="supernova">89</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">+1: I think this is the answer.  Contrary to what all the other answers say, it&#39;s not about the single loop variant inherently having more cache misses, it&#39;s about the particular alignment of the arrays causing the cache misses.</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:20:28Z" class="relativetime-clean">Dec 17 '11 at 21:20</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10592744" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="warm">11</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">This; a <i>false aliasing</i> stall is the most likely explanation.</span>
                &ndash;&nbsp;
                    <a href="/users/142434/stephen-canon"
                       title="57316 reputation"
                       class="comment-user">Stephen Canon</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 01:04:53Z" class="relativetime-clean">Dec 18 '11 at 1:04</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10593693" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Mysticial slightly off-topic but what did you use to generate those pretty graphs? Is it from VS profiler?</span>
                &ndash;&nbsp;
                    <a href="/users/234175/greatwolf"
                       title="9441 reputation"
                       class="comment-user">greatwolf</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 03:44:45Z" class="relativetime-clean">Dec 18 '11 at 3:44</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10593695" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">4</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@VictorT. I used the code the OP linked to. It generates a .css file which I can open in Excel and make a graph from it.</span>
                &ndash;&nbsp;
                    <a href="/users/922184/mysticial"
                       title="163390 reputation"
                       class="comment-user">Mysticial</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 03:45:34Z" class="relativetime-clean">Dec 18 '11 at 3:45</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10594415" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Mysticial: I don&#39;t understand what <i>false aliasing</i> means. Could you explain this? Or give me a link (if you&#39;ve any) so that I will read it myself.</span>
                &ndash;&nbsp;
                    <a href="/users/415784/nawaz"
                       title="147451 reputation"
                       class="comment-user">Nawaz</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 06:09:44Z" class="relativetime-clean">Dec 18 '11 at 6:09</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8547993" data-rep=50 data-anon=true
			   class="comments-link " 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>show <b>27</b> more comments</a>
    </td>
</tr>    </table>
</div>
<script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk1727389295",4).setZone(44) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk1727389295">
            </div>
  
<a name="8549223"></a>
<div id="answer-8549223" class="answer" data-answerid="8549223" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8549223">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">96</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>OK, the right answer definitely has to do something with the CPU cache. But to use the cache argument can be quite difficult, especially without data.</p>

<p>There are many answers, that led to a lot of discussion, but let's face it: Cache issues can be very complex and are not one dimensional. They depend heavily on the size of the data, so my question was unfiar: It turned out to be at a very interesting point in the cache graph.</p>

<p>@Mysticial's answer convinced a lot of people (including me), probably because it was the only one that seemed to rely on facts, but it was only one "data point" of the truth.</p>

<p>That's why I combined his test (using a continuous vs. seperate allocation) and @James' Answer's advice.</p>

<p>The graphs below shows, that most of the answers and especially the majority of comments to the question and answers can be considered complelety wrong or true depending on the exact scenario and parameters used.</p>

<p>Note that my initial question was at <strong>n = 100.000</strong>. This point (by accident) exhibits special behavior: </p>

<ol>
<li><p>It possesses the greatest discrepancy between the one and two loop'ed version (almost a factor of three)</p></li>
<li><p>It is the only point, where one-loop (namely with continuous allocation) beats the two-loop version. (This made Mysticial's answer possible, at all.)</p></li>
</ol>

<p>The result using initialized data:</p>

<p><img src="http://i.stack.imgur.com/orxF8.png" alt="Enter image description here"></p>

<p>The result using uninitialized data (this is what Mysticial tested):</p>

<p><img src="http://i.stack.imgur.com/mZPh9.png" alt="Enter image description here"></p>

<p>And this is a hard-to-explain one: Initilized data, that is allocated once and reused for every following testcase of different vector size:</p>

<p><img src="http://i.stack.imgur.com/aiDfv.png" alt="Enter image description here"></p>

<h2>Proposal</h2>

<p>Every low-level performance related question on Stack&nbsp;Overflow should be required to provide MFLOPS information for the whole range of cache relevant data sizes! It's a waste of everybody's time to think of answers and especially discuss them with others without this information.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8549223" title="short permalink to this answer" class="short-link" id="link-post-8549223">share</a><span class="lsep">|</span><a href="/posts/8549223/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/8549223/revisions" title="show all edits to this post">edited <span title="2013-02-16 09:44:05Z" class="relativetime">Feb 16 '13 at 9:44</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature owner">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2011-12-18 01:29:55Z" class="relativetime">Dec 18 '11 at 1:29</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/578832/johannes-gerer"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/d9fba057e51ffee5988a14572e6692e1?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/578832/johannes-gerer">Johannes Gerer</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">5,487</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="11 silver badges"><span class="badge2"></span><span class="badgecount">11</span></span><span title="22 bronze badges"><span class="badge3"></span><span class="badgecount">22</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8549223" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10593045" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="warm">10</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">+1 Nice analysis. I didn&#39;t intend to leave the data uninitialized in the first place. It just happened that the allocator zeroed them anyway. So the initialized data is what matters. I just edited my answer with results on an <i>actual</i> Core 2 architecture machine and they are a lot closer to what you are observing. Another thing is that I tested a range of sizes <code>n</code> and it shows the same performance gap for <code>n = 80000, n = 100000, n = 200000</code>, etc...</span>
                &ndash;&nbsp;
                    <a href="/users/922184/mysticial"
                       title="163390 reputation"
                       class="comment-user">Mysticial</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 01:48:21Z" class="relativetime-clean">Dec 18 '11 at 1:48</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8549223" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>

  
<a name="8547813"></a>
<div id="answer-8547813" class="answer" data-answerid="8547813" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8547813">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">25</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>The second loop involves a lot less cache activity, so it's easier for the processor to keep up with the memory demands.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8547813" title="short permalink to this answer" class="short-link" id="link-post-8547813">share</a><span class="lsep">|</span><a href="/posts/8547813/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2011-12-17 20:47:55Z" class="relativetime">Dec 17 '11 at 20:47</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/298661/puppy"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/3445f56229632874a44596385ed6d40c?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/298661/puppy">Puppy</a><br>
        <span class="reputation-score" title="reputation score 89872" dir="ltr">89.9k</span><span title="7 gold badges"><span class="badge1"></span><span class="badgecount">7</span></span><span title="107 silver badges"><span class="badge2"></span><span class="badgecount">107</span></span><span title="236 bronze badges"><span class="badge3"></span><span class="badgecount">236</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8547813" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="10" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10590540" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You&#39;re saying that the second variant incurs fewer cache misses?  Why?</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:49:08Z" class="relativetime-clean">Dec 17 '11 at 20:49</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590555" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Oli: In the first variant, the processor needs to access four memory lines at a time- <code>a&#91;i&#93;</code>, <code>b&#91;i&#93;</code>, <code>c&#91;i&#93;</code> and <code>d&#91;i&#93;</code> In the second variant, it needs just two. This makes it much more viable to refill those lines whilst adding.</span>
                &ndash;&nbsp;
                    <a href="/users/298661/puppy"
                       title="89872 reputation"
                       class="comment-user">Puppy</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:50:30Z" class="relativetime-clean">Dec 17 '11 at 20:50</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590568" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">But so long as the arrays don&#39;t collide in cache, each variant requires the exact same number of reads and writes from/to main memory.  So the conclusion is (I think) that these two arrays happen to be colliding all the time.</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:52:22Z" class="relativetime-clean">Dec 17 '11 at 20:52</span></span>
                    <span class="edited-yes" title="this comment was edited 3 times"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590587" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Oli: But all the lines need reading at once, in the first variant. In the second, the processor can delay reading the second two arrays.</span>
                &ndash;&nbsp;
                    <a href="/users/298661/puppy"
                       title="89872 reputation"
                       class="comment-user">Puppy</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:54:15Z" class="relativetime-clean">Dec 17 '11 at 20:54</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590597" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I don&#39;t follow.  Per instruction (i.e. per instance of <code>x += y</code>), there are two reads and one write.  This is true for either variant.  The cache&lt;-&gt;CPU bandwidth requirement is therefore the same.  So long as there are no conflicts, the cache&lt;-&gt;RAM bandwidth requirement is also the same..</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 20:55:39Z" class="relativetime-clean">Dec 17 '11 at 20:55</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8547813" data-rep=50 data-anon=true
			   class="comments-link " 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>show <b>10</b> more comments</a>
    </td>
</tr>    </table>
</div>

  
<a name="8547819"></a>
<div id="answer-8547819" class="answer" data-answerid="8547819" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8547819">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">11</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>It's not because of a different code, but because of caching: RAM is slower than the CPU registers and a cache memory is inside the CPU to avoid to write the RAM every time a variable is changing. But the cache is not big as the RAM is, hence, it maps only a fraction of it.</p>

<p>The first code modifies distant memory addresses alternating them at each loop, thus requiring continuously to invalidate the cache. </p>

<p>The second code don't alternate: it just flow on adjacent addresses twice. This makes all the job to be completed in the cache, invalidating it only after the second loop starts.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8547819" title="short permalink to this answer" class="short-link" id="link-post-8547819">share</a><span class="lsep">|</span><a href="/posts/8547819/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2011-12-17 20:49:03Z" class="relativetime">Dec 17 '11 at 20:49</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/924727/emilio-garavaglia"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/bd2dcbbfd05a7c49cd74c7cb93e26488?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/924727/emilio-garavaglia">Emilio Garavaglia</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">9,149</span><span title="11 silver badges"><span class="badge2"></span><span class="badgecount">11</span></span><span title="31 bronze badges"><span class="badge3"></span><span class="badgecount">31</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8547819" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="2" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10590851" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Why would this cause the cache to continuously be invalidated?</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:22:52Z" class="relativetime-clean">Dec 17 '11 at 21:22</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590924" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@OliCharlesworth: Think to the cache as an hard copy of a contiguous range of memory addresses. If you pretend to access an address not part of them, you have to re-load the cache. And if something in the cache had been modified, it has to be written back in RAM, or it will be lost.  In the sample code, 4 vector of 100&#39;000 integers (400kBytes) are most likely more than the capacity of the L1 cache (128 or 256K).</span>
                &ndash;&nbsp;
                    <a href="/users/924727/emilio-garavaglia"
                       title="9149 reputation"
                       class="comment-user">Emilio Garavaglia</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:30:44Z" class="relativetime-clean">Dec 17 '11 at 21:30</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590987" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">3</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">The size of the cache has no impact in this scenario.  Each array element is only used once, and after that it doesn&#39;t matter if it&#39;s evicted.  Cache size only matters if you have temporal locality (i.e. you&#39;re going to re-use the same elements in the future).</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:36:51Z" class="relativetime-clean">Dec 17 '11 at 21:36</span></span>
                    <span class="edited-yes" title="this comment was edited 1 time"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10595293" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@OliCharlesworth: If I have to load a new value in a cache, and there is already a value in it that has been modifyed, I have first to write it down, and this makes me wait for the write to happen.</span>
                &ndash;&nbsp;
                    <a href="/users/924727/emilio-garavaglia"
                       title="9149 reputation"
                       class="comment-user">Emilio Garavaglia</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 08:43:42Z" class="relativetime-clean">Dec 18 '11 at 8:43</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10596243" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">But in both variants of the OP&#39;s code, each value gets modified precisely once.  You do so the same number of write-backs in each variant.</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 11:11:54Z" class="relativetime-clean">Dec 18 '11 at 11:11</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8547819" data-rep=50 data-anon=true
			   class="comments-link " 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>show <b>2</b> more comments</a>
    </td>
</tr>    </table>
</div>

  
<a name="8549240"></a>
<div id="answer-8549240" class="answer" data-answerid="8549240" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8549240">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">11</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>Imagine you are working on a machine where <code>n</code> was just the right value for it only to be possible to hold two of your arrays in memory at one time, but the total memory available, via disk caching, was still sufficient to hold all four.</p>

<p>Assuming a simple LIFO caching policy, this code:</p>

<pre><code>for(int j=0;j&lt;n;j++){
    a1[j] += b1[j];
}
for(int j=0;j&lt;n;j++){
    c1[j] += d1[j];
}
</code></pre>

<p>would first cause <code>a1</code> and <code>b1</code> to be loaded into RAM and then be worked on entirely in RAM. When the second loop starts, <code>c1</code> and <code>d1</code> would then be loaded from disk into RAM and operated on.</p>

<p>the other loop</p>

<pre><code>for(int j=0;j&lt;n;j++){
    a1[j] += b1[j];
    c1[j] += d1[j];
}
</code></pre>

<p>will page out two arrays and page in the other two <strong>every time around the loop</strong>. This would obviously be <strong>much</strong> slower.</p>

<p>You are probably not seeing disk caching in your tests but you are probably seeing the side effects of some other form of caching.</p>

<hr>

<p>There seems to be a little confusion/misunderstanding here so I will try to elaborate a little using an example.</p>

<p>Say <code>n = 2</code> and we are working with bytes. In my scenario we thus have <strong>just 4 bytes of cache</strong> and the rest of our memory is significantly slower (say 100 times longer access).</p>

<p>Assuming a fairly dumb caching policy of <em>if the byte is not in the cache, put it there and get the following byte too while we are at it</em> you will get a scenario something like this:</p>

<ul>
<li><p>With</p>

<pre><code>for(int j=0;j&lt;n;j++){
 a1[j] += b1[j];
}
for(int j=0;j&lt;n;j++){
 c1[j] += d1[j];
}
</code></pre></li>
<li><p>cache <code>a1[0]</code> and <code>a1[1]</code> then <code>b1[0]</code> and <code>b1[1]</code> and set <code>a1[0] = a1[0] + b1[0]</code> in cache - there are now four bytes in cache, <code>a1[0], a1[1]</code> and <code>b1[0], b1[1]</code>. Cost = 100 + 100.</p></li>
<li>set <code>a1[1] = a1[1] + b1[1]</code> in cache. Cost = 1 + 1.</li>
<li>Repeat for <code>c1</code> and `d1.</li>
<li><p>Total cost = <code>(100 + 100 + 1 + 1) * 2 = 404</code></p></li>
<li><p>With</p>

<pre><code>for(int j=0;j&lt;n;j++){
 a1[j] += b1[j];
 c1[j] += d1[j];
}
</code></pre></li>
<li><p>cache <code>a1[0]</code> and <code>a1[1]</code> then <code>b1[0]</code> and <code>b1[1]</code> and set <code>a1[0] = a1[0] + b1[0]</code> in cache - there are now four bytes in cache, <code>a1[0], a1[1]</code> and <code>b1[0], b1[1]</code>. Cost = 100 + 100.</p></li>
<li>eject <code>a1[0], a1[1], b1[0], b1[1]</code> from cache and cache <code>c1[0]</code> and <code>c1[1]</code> then <code>d1[0]</code> and <code>d1[1]</code> and set <code>c1[0] = c1[0] + d1[0]</code> in cache. Cost = 100 + 100.</li>
<li>I suspect you are beginning to see where I am going.</li>
<li>Total cost = <code>(100 + 100 + 100 + 100) * 2 = 800</code></li>
</ul>

<p>This is a classic cache thrash scenario.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8549240" title="short permalink to this answer" class="short-link" id="link-post-8549240">share</a><span class="lsep">|</span><a href="/posts/8549240/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/8549240/revisions" title="show all edits to this post">edited <span title="2013-11-27 11:40:12Z" class="relativetime">Nov 27 '13 at 11:40</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2011-12-18 01:36:31Z" class="relativetime">Dec 18 '11 at 1:36</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/823393/oldcurmudgeon"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/6a37a096cfb6f7b8e40e4950dc1a9658?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/823393/oldcurmudgeon">OldCurmudgeon</a><br>
        <span class="reputation-score" title="reputation score 15823" dir="ltr">15.8k</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="20 silver badges"><span class="badge2"></span><span class="badgecount">20</span></span><span title="56 bronze badges"><span class="badge3"></span><span class="badgecount">56</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8549240" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="3" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10602216" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">4</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">This is incorrect.  A reference to a particular element of an array does not cause the entire array to be paged in from disk (or from non-cached memory); only the relevant page or cache line is paged in.</span>
                &ndash;&nbsp;
                    <a href="/users/102916/brooks-moses"
                       title="6195 reputation"
                       class="comment-user">Brooks Moses</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-18 21:38:39Z" class="relativetime-clean">Dec 18 '11 at 21:38</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10621766" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@Brooks Moses - If you walk through the whole array, as is happening here, then it will.</span>
                &ndash;&nbsp;
                    <a href="/users/823393/oldcurmudgeon"
                       title="15823 reputation"
                       class="comment-user">OldCurmudgeon</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-19 21:34:16Z" class="relativetime-clean">Dec 19 '11 at 21:34</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10625129" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Well, yes, but that&#39;s what happens over the whole operation, not what happens each time around the loop.  You claimed that the second form &quot;will page out two arrays and page in the other two every time around the loop,&quot; and that&#39;s what I&#39;m objecting to.  Regardless of the size of the overall arrays, in the middle of this loop your RAM will be holding a page from each of the four arrays, and nothing will get paged out until well after the loop has finished with it.</span>
                &ndash;&nbsp;
                    <a href="/users/102916/brooks-moses"
                       title="6195 reputation"
                       class="comment-user">Brooks Moses</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-20 02:05:48Z" class="relativetime-clean">Dec 20 '11 at 2:05</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10630881" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">In the particular case where <i>n was just the right value for it only to be possible to hold two of your arrays in memory at one time</i> then accessing all elements of <b>four</b> arrays in one loop must surely end up thrashing.</span>
                &ndash;&nbsp;
                    <a href="/users/823393/oldcurmudgeon"
                       title="15823 reputation"
                       class="comment-user">OldCurmudgeon</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-20 10:35:39Z" class="relativetime-clean">Dec 20 '11 at 10:35</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10666661" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Why are you staying that loop 2 pages in the entirety of <code>a1</code> and <code>b1</code> for the first assignment, rather than just the first page of each of them?  (Are you assuming 5-byte pages, so a page is half of your RAM?  That&#39;s not just scaling, that&#39;s completely unlike a real processor.)</span>
                &ndash;&nbsp;
                    <a href="/users/102916/brooks-moses"
                       title="6195 reputation"
                       class="comment-user">Brooks Moses</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-21 23:37:56Z" class="relativetime-clean">Dec 21 '11 at 23:37</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8549240" data-rep=50 data-anon=true
			   class="comments-link " 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>show <b>3</b> more comments</a>
    </td>
</tr>    </table>
</div>

  
<a name="8547837"></a>
<div id="answer-8547837" class="answer" data-answerid="8547837" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="8547837">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>It's because the CPU doesn't have so many cache misses (where it has to wait for the array data to come from the RAM chips). It would be interesting for you to adjust the size of the arrays continually so that you exceed the sizes of the <a href="http://en.wikipedia.org/wiki/CPU_cache#Multi-level_caches" rel="nofollow">level 1 cache</a> (L1), and then the <a href="http://en.wikipedia.org/wiki/CPU_cache#Multi-level_caches" rel="nofollow">level 2 cache</a> (L2), of your CPU and plot the time taken for your code to execute against the sizes of the arrays. The graph shouldn't be a straight line like you'd expect.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/8547837" title="short permalink to this answer" class="short-link" id="link-post-8547837">share</a><span class="lsep">|</span><a href="/posts/8547837/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/8547837/revisions" title="show all edits to this post">edited <span title="2013-02-16 09:38:15Z" class="relativetime">Feb 16 '13 at 9:38</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2011-12-17 20:52:48Z" class="relativetime">Dec 17 '11 at 20:52</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/439751/james"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/c4b40ae065359026d01fa30223812d83?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/439751/james">James</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">5,441</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="7 silver badges"><span class="badge2"></span><span class="badgecount">7</span></span><span title="22 bronze badges"><span class="badge3"></span><span class="badgecount">22</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-8547837" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-10590643" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I don&#39;t believe there&#39;s any interaction between the cache size and the array size.  Each array element is only used once, and can then be safely evicted.  There may well be an interaction between the cache <i>line</i> size and the array size, though, if it causes the four arrays to conflict.</span>
                &ndash;&nbsp;
                    <a href="/users/129570/oli-charlesworth"
                       title="147251 reputation"
                       class="comment-user">Oli Charlesworth</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:01:05Z" class="relativetime-clean">Dec 17 '11 at 21:01</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-10590774" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You&#39;re right, it&#39;s the wrong example to demonstrate this effect</span>
                &ndash;&nbsp;
                    <a href="/users/439751/james"
                       title="5441 reputation"
                       class="comment-user">James</a>
                <span class="comment-date" dir="ltr"><span title="2011-12-17 21:15:12Z" class="relativetime-clean">Dec 17 '11 at 21:15</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-8547837" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>

  
<a name="14087533"></a>
<div id="answer-14087533" class="answer" data-answerid="14087533" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="14087533">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p><strong>I cannot replicate the results discussed here.</strong></p>

<p>I don't know if poor benchmark code is to blame, or what, but the two methods are within 10% of each other on my machine using the following code, and one loop is usually just slightly faster than two - as you'd expect.</p>

<p>Array sizes ranged from 2^16 to 2^24, using eight loops. I was careful to initialize the source arrays so the <code>+=</code> assignment wasn't asking the <a href="http://en.wikipedia.org/wiki/Floating-point_unit" rel="nofollow">FPU</a> to add memory garbage interpreted as a double.</p>

<p>I played around with various schemes, such as putting the assignment of <code>b[j]</code>, <code>d[j]</code> to <code>InitToZero[j]</code> inside the loops, and also with using <code>+= b[j] = 1</code> and <code>+= d[j] = 1</code>, and I got fairly consistent results.</p>

<p>As you might expect, initializing <code>b</code> and <code>d</code> inside the loop using <code>InitToZero[j]</code> gave the combined approach an advantage, as they were done back-to-back before the assignments to <code>a</code> and <code>c</code>, but still within 10%. Go figure.</p>

<p>Hardware is <a href="http://en.wikipedia.org/wiki/Dell_XPS#XPS_8500" rel="nofollow">Dell XPS 8500</a> with generation 3 <a href="http://en.wikipedia.org/wiki/Intel_Core#Core_i7" rel="nofollow">Core i7</a> @ 3.4&nbsp;GHz and 8&nbsp;GB memory. For 2^16 to 2^24, using eight loops, the cumulative time was 44.987 and 40.965 respectively. Visual C++ 2010, fully optimized.</p>

<p>PS: I changed the loops to count down to zero, and the combined method was marginally faster. Scratching my head. Note the new array sizing and loop counts.</p>

<pre><code>// MemBufferMystery.cpp : Defines the entry point for the console application.
//
#include "stdafx.h"
#include &lt;iostream&gt;
#include &lt;cmath&gt;
#include &lt;string&gt;
#include &lt;time.h&gt;

#define  dbl    double
#define  MAX_ARRAY_SZ    262145    //16777216    // AKA (2^24)
#define  STEP_SZ           1024    //   65536    // AKA (2^16)

int _tmain(int argc, _TCHAR* argv[]) {
    long i, j, ArraySz = 0,  LoopKnt = 1024;
    time_t start, Cumulative_Combined = 0, Cumulative_Separate = 0;
    dbl *a = NULL, *b = NULL, *c = NULL, *d = NULL, *InitToOnes = NULL;

    a = (dbl *)calloc( MAX_ARRAY_SZ, sizeof(dbl));
    b = (dbl *)calloc( MAX_ARRAY_SZ, sizeof(dbl));
    c = (dbl *)calloc( MAX_ARRAY_SZ, sizeof(dbl));
    d = (dbl *)calloc( MAX_ARRAY_SZ, sizeof(dbl));
    InitToOnes = (dbl *)calloc( MAX_ARRAY_SZ, sizeof(dbl));
    // Initialize array to 1.0 second.
    for(j = 0; j&lt; MAX_ARRAY_SZ; j++) {
        InitToOnes[j] = 1.0;
    }

    // Increase size of arrays and time
    for(ArraySz = STEP_SZ; ArraySz&lt;MAX_ARRAY_SZ; ArraySz += STEP_SZ) {
        a = (dbl *)realloc(a, ArraySz * sizeof(dbl));
        b = (dbl *)realloc(b, ArraySz * sizeof(dbl));
        c = (dbl *)realloc(c, ArraySz * sizeof(dbl));
        d = (dbl *)realloc(d, ArraySz * sizeof(dbl));
        // Outside the timing loop, initialize
        // b and d arrays to 1.0 sec for consistent += performance.
        memcpy((void *)b, (void *)InitToOnes, ArraySz * sizeof(dbl));
        memcpy((void *)d, (void *)InitToOnes, ArraySz * sizeof(dbl));

        start = clock();
        for(i = LoopKnt; i; i--) {
            for(j = ArraySz; j; j--) {
                a[j] += b[j];
                c[j] += d[j];
            }
        }
        Cumulative_Combined += (clock()-start);
        printf("\n %6i miliseconds for combined array sizes %i and %i loops",
                (int)(clock()-start), ArraySz, LoopKnt);
        start = clock();
        for(i = LoopKnt; i; i--) {
            for(j = ArraySz; j; j--) {
                a[j] += b[j];
            }
            for(j = ArraySz; j; j--) {
                c[j] += d[j];
            }
        }
        Cumulative_Separate += (clock()-start);
        printf("\n %6i miliseconds for separate array sizes %i and %i loops \n",
                (int)(clock()-start), ArraySz, LoopKnt);
    }
    printf("\n Cumulative combined array processing took %10.3f seconds",
            (dbl)(Cumulative_Combined/(dbl)CLOCKS_PER_SEC));
    printf("\n Cumulative seperate array processing took %10.3f seconds",
        (dbl)(Cumulative_Separate/(dbl)CLOCKS_PER_SEC));
    getchar();

    free(a); free(b); free(c); free(d); free(InitToOnes);
    return 0;
}
</code></pre>

<p>I'm not sure why it was decided that MFLOPS was a relevant metric. I though the idea was to focus on memory accesses, so I tried to minimize the amount of floating point computation time. I left in the <code>+=</code>, but I am not sure why.</p>

<p>A straight assignment with no computation would be a cleaner test of memory access time and would create a test that is uniform irrespective of the loop count. Maybe I missed something in the conversation, but it is worth thinking twice about. If the plus is left out of the assignment, the cumulative time is almost identical at 31 seconds each.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/14087533" title="short permalink to this answer" class="short-link" id="link-post-14087533">share</a><span class="lsep">|</span><a href="/posts/14087533/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/14087533/revisions" title="show all edits to this post">edited <span title="2013-02-16 09:57:34Z" class="relativetime">Feb 16 '13 at 9:57</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-12-30 01:34:43Z" class="relativetime">Dec 30 '12 at 1:34</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1899861/rocketroy"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/0bee6fb5bfbdb4a9764d8487a2851605?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1899861/rocketroy">RocketRoy</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">422</span><span title="3 silver badges"><span class="badge2"></span><span class="badgecount">3</span></span><span title="9 bronze badges"><span class="badge3"></span><span class="badgecount">9</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-14087533" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-19516074" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">The misalignment penalty that you mention here is when an individual load/store that is misaligned (including the unaligned SSE load/stores). But that is not the case here since the performance is sensitive to the relative alignments of the different arrays. There are no misalignments at the instruction level. Every single load/store is properly aligned.</span>
                &ndash;&nbsp;
                    <a href="/users/922184/mysticial"
                       title="163390 reputation"
                       class="comment-user">Mysticial</a>
                <span class="comment-date" dir="ltr"><span title="2012-12-31 19:15:45Z" class="relativetime-clean">Dec 31 '12 at 19:15</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-14087533" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>

  
<a name="12008639"></a>
<div id="answer-12008639" class="answer" data-answerid="12008639" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="12008639">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">2</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>The first loop alternates writing in each variable. The second and third ones only make small jumps of element size.</p>

<p>Try writing two parallel lines of 20 crosses with a pen and paper separated by 20&nbsp;cm. Try once finishing one and then the other line and try another time by writting a cross in each line alternately.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/12008639" title="short permalink to this answer" class="short-link" id="link-post-12008639">share</a><span class="lsep">|</span><a href="/posts/12008639/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/12008639/revisions" title="show all edits to this post">edited <span title="2013-02-16 09:47:53Z" class="relativetime">Feb 16 '13 at 9:47</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-08-17 15:23:58Z" class="relativetime">Aug 17 '12 at 15:23</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1607083/guillaume-kiz"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/3735081df3d7c74b561aad0ca7ae26aa?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1607083/guillaume-kiz">Guillaume Kiz</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">41</span><span title="2 bronze badges"><span class="badge3"></span><span class="badgecount">2</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-12008639" class="comments  dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-12008639" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>

  
<a name="9629099"></a>
<div id="answer-9629099" class="answer" data-answerid="9629099" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="9629099">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>This will be true when you are executing this on a multi-core PC (or at least a CPU with <a href="http://en.wikipedia.org/wiki/Hyper-threading" rel="nofollow">hyper-threading</a> support). When you create two separate loops, the CPU can easily split the computation across multiple CPUs and execute them in parallel, thereby increasing the performance.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/9629099" title="short permalink to this answer" class="short-link" id="link-post-9629099">share</a><span class="lsep">|</span><a href="/posts/9629099/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="/posts/9629099/revisions" title="show all edits to this post">edited <span title="2013-02-16 09:46:43Z" class="relativetime">Feb 16 '13 at 9:46</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="/users/63550/peter-mortensen"><div class="gravatar-wrapper-32"><img src="http://i.stack.imgur.com/RIZKi.png?s=32&g=1" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/63550/peter-mortensen">Peter Mortensen</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">7,406</span><span title="8 gold badges"><span class="badge1"></span><span class="badgecount">8</span></span><span title="51 silver badges"><span class="badge2"></span><span class="badgecount">51</span></span><span title="82 bronze badges"><span class="badge3"></span><span class="badgecount">82</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-03-09 04:51:43Z" class="relativetime">Mar 9 '12 at 4:51</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/389161/taranfx"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/c77a349e89f6e9c0f109e528f90ca6f1?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/389161/taranfx">Taranfx</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">2,620</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="35 silver badges"><span class="badge2"></span><span class="badgecount">35</span></span><span title="63 bronze badges"><span class="badge3"></span><span class="badgecount">63</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-9629099" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-12235928" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">4</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">As the program in question is single threaded I doubt, that there is any concurrent computation happening.</span>
                &ndash;&nbsp;
                    <a href="/users/578832/johannes-gerer"
                       title="5487 reputation"
                       class="comment-user owner">Johannes Gerer</a>
                <span class="comment-date" dir="ltr"><span title="2012-03-09 18:05:57Z" class="relativetime-clean">Mar 9 '12 at 18:05</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-25627851" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">...little or none. I watched the CPU, and the thread count when I did my benchmarks, as indicated, this code is not multi-threaded.</span>
                &ndash;&nbsp;
                    <a href="/users/1899861/rocketroy"
                       title="422 reputation"
                       class="comment-user">RocketRoy</a>
                <span class="comment-date" dir="ltr"><span title="2013-07-12 03:51:47Z" class="relativetime-clean">Jul 12 '13 at 3:51</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-9629099" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>

  
<a name="16488079"></a>
<div id="answer-16488079" class="answer" data-answerid="16488079" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="16488079">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>Language doesn't have a concept of speed which allows you to make such comparisons. A programming language specification <em>might</em> say "It should take at most/at least/exactly n units of time to complete x operation", but it won't give a definition of "units of time". That's an attribute introduced by implementations.</p>

<p>In your case, your implementation is Microsoft Visual C++ 10.0, but that's hardly relevant to the GNU C++ compiler. It might be that one loop performing the same task as two loops is slower in your implementation, but that's not a requirement of other implementations. For the same reason, talking about speed with regards to alignment and CPU cache isn't appropriate. Everyone has a different processor, and presumably you aren't developing programs that'll only <em>ever</em> run on the same machine.</p>

<p><strong>Section 1.9 Program Execution, paragraph 1</strong></p>

<blockquote>
  <p>The semantic descriptions in this International Standard define a
  parameterized nondeterministic abstract machine. This International
  Standard places no requirement on the structure of conforming
  implementations. In particular, they need not copy or emulate the
  structure of the abstract machine. Rather, conforming implementations
  are required to emulate (only) the observable behavior of the abstract
  machine as explained below.</p>
</blockquote>

<p><strong>Section 1.9 Program Execution, paragraph 8</strong></p>

<blockquote>
  <p>The least requirements on a conforming implementation are:</p>
  
  <p>— Access to volatile objects are evaluated strictly according to the
  rules of the abstract machine.</p>
  
  <p>— At program termination, all data written into files shall be
  identical to one of the possible results that execution of the program
  according to the abstract semantics would have produced.</p>
  
  <p>— The input and output dynamics of interactive devices shall take
  place in such a fashion that prompting output is actually delivered
  before a program waits for input. What constitutes an interactive
  device is implementation-defined.</p>
  
  <p>These collectively are referred to as the observable behavior of the
  program. [ Note: More stringent correspondences between abstract and
  actual semantics may be defined by each implementation. —end note ]</p>
</blockquote>

<p>Suppose you use a different compiler, which happens to notice that it doesn't need to generate code for allocation of <code>a1</code>, <code>b1</code>, <code>c1</code> or <code>d1</code> or loops to change values of those objects because they don't have an affect on the observable behaviour of the program. Consider what might happen in this circumstance, if <code>t1-t0 == 1</code>. An intelligent compiler might optimise <code>plain</code> to this, just to spite you:</p>

<pre><code>double plain(int n,int m,int cont,int loops)
{
    return 2.0*double(n)*double(m) / 0.0;
}
</code></pre>

<p>Perhaps of more vital importance is the question: How do I know when I might be wasting time contemplating premature optimisations? Stop guessing. Make your employer happy by developing a working program that solves an actual, useful problem, first. If he/she says it's too slow, profile the program and use the results of the profiling to determine where the most significant optimisation lies.</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/16488079" title="short permalink to this answer" class="short-link" id="link-post-16488079">share</a><span class="lsep">|</span><a href="/posts/16488079/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2013-05-10 17:51:05Z" class="relativetime">May 10 '13 at 17:51</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/1989425/undefined-behaviour"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/38489e41542a608dafb33cb481c368f3?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/1989425/undefined-behaviour">undefined behaviour</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">4,494</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="4 silver badges"><span class="badge2"></span><span class="badgecount">4</span></span><span title="25 bronze badges"><span class="badge3"></span><span class="badgecount">25</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
        
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-16488079" class="comments " data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-23780858" class="comment ">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">2</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">these might be valid points, but overall this is just too negative. You should not stop people from asking &quot;why&quot; questions. Just do not read or answer them, if you are unhappy</span>
                &ndash;&nbsp;
                    <a href="/users/578832/johannes-gerer"
                       title="5487 reputation"
                       class="comment-user owner">Johannes Gerer</a>
                <span class="comment-date" dir="ltr"><span title="2013-05-14 22:30:24Z" class="relativetime-clean">May 14 '13 at 22:30</span></span>
                                                                            </div>
                    </td>
    </tr>
    <tr id="comment-23784697" class="comment ">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">@JohannesGerer What are you talking about? I&#39;m not stopping anyone from asking &quot;why&quot; questions. I addressed the question, and then led the person in a better direction. How is that negative? I would suggest that attribution of emotional tone to text is mostly erroneous. I&#39;m definitely not upset, and this answer is definitely not negative.</span>
                &ndash;&nbsp;
                    <a href="/users/1989425/undefined-behaviour"
                       title="4494 reputation"
                       class="comment-user">undefined behaviour</a>
                <span class="comment-date" dir="ltr"><span title="2013-05-15 02:57:03Z" class="relativetime-clean">May 15 '13 at 2:57</span></span>
                                                                            </div>
                    </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-16488079" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>
				<div class="question-status">
        <h2>                    <b>protected</b> by <a href="/users/922184/mysticial">Mysticial</a> <span title="2012-08-17 16:29:17Z" class="relativetime">Aug 17 '12 at 16:29</span>
</h2>
        <p>
Thank you for your interest in this question. 
Because it has attracted low-quality answers, posting an answer now requires 10 <a href="/help/whats-reputation">reputation</a> on this site.
<br /><br />
Would you like to answer one of these <a href="/unanswered?fromProtectedNotice=true">unanswered questions</a> instead?
</p>
    </div>


						<h2 class="bottom-notice" data-loc="1">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/c" class="post-tag" title="show questions tagged &#39;c&#39;" rel="tag">c</a> <a href="/questions/tagged/performance" class="post-tag" title="show questions tagged &#39;performance&#39;" rel="tag">performance</a> <a href="/questions/tagged/compiler-optimization" class="post-tag" title="show questions tagged &#39;compiler-optimization&#39;" rel="tag">compiler-optimization</a> <a href="/questions/tagged/vectorization" class="post-tag" title="show questions tagged &#39;vectorization&#39;" rel="tag">vectorization</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
						    <div class="module question-stats">
			        <table id="qinfo">
			            <tr>
			                <td>
			                    <p class="label-key">asked</p>
			                </td>
			                <td style="padding-left: 10px">
			                    <p class="label-key" title="2011-12-17 20:40:52Z"><b>2 years ago</b></p>
			                </td>
			            </tr>
			            <tr>
			                <td>
			                    <p class="label-key">viewed</p>
			                </td>

			                <td style="padding-left: 10px">
			                    <p class="label-key">
			                        <b>135055 times</b>
			                    </p>
			                </td>
			            </tr>
			                <tr>
			                    <td>
			                        <p class="label-key">active</p>
			                    </td>
			                    <td style="padding-left: 10px">
			                        <p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2014-04-05 19:42:18Z">2 months ago</a></b></p>
			                    </td>
			                </tr>
			        </table>
			    </div>
						
			<script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk728565864",17).setZone(45) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk728565864">
            </div>  
    <div id="hireme">
        <script>
window.careers_adurl="//careers.stackoverflow.com/gethired/js",window.careers_cssurl="//cdn-careers.sstatic.net/careers/gethired/sidebar.min.css?v=88f3fd5e2263",window.careers_leaderboardcssurl="{leaderboardcssurl}",window.careers_companycssurl="//cdn-careers.sstatic.net/careers/gethired/company",window.careers_adselector="div#hireme",StackExchange.ready(function(){$.ajax({url:"//cdn-careers.sstatic.net/careers/gethired/loader.min.js?v=93d05efce50b",dataType:"script",cache:!0})});        </script>
    </div>
			<div style="margin-bottom: 10px;">
        

<style type="text/css">
#newsletter-ad {
    width: 190px;
    height: 250px;
    overflow: hidden;
    background: url('//cdn.sstatic.net/stackoverflow/img/newsletter-ad.png');
    padding: 0 15px 0 15px;
}
#newsletter-ad-header {
    margin-top: 60px;
}
#newsletter-ad ul {
    margin: 1em 0 1em 1.5em;
}
#newsletter-ad ul li {
    margin-bottom: 5px;
}
#newsletter-signup-container {
    text-align: center;
}
#newsletter-preview-container {
    margin-top: 10px;
    text-align: center;
}
#newsletter-email-input {
    width: 200px;
}
</style>

<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
</script>

<div id="newsletter-ad">
    <p id="newsletter-ad-header">Get the <b>weekly newsletter!</b></p>
    <ul>
        <li>Top questions and answers</li>
        <li>Important announcements</li>
        <li>Unanswered questions</li>
    </ul>
    <div id="newsletter-signup-container"><input id="newsletter-signup" type="button" value="Sign up for the newsletter" /></div>
    <p id="newsletter-preview-container">see an <a href="http://stackexchange.com/newsletters/newsletter?site=stackoverflow.com" id="newsletter-preview">example newsletter</a></p>
    <div class="dno">
        
<p class="privacy-policy-agreement">
By subscribing, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />
    </div>
</div>

    </div>  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/13866962" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">1</div>
	</a>
	<a href="/questions/13866962/what-is-the-overhead-in-splitting-a-for-loop-into-multiple-for-loops-if-the-tot" class="question-hyperlink">What is the overhead in splitting a for-loop into multiple for-loops, if the total work inside is the same?</a>
</div><div class="spacer">
	<a href="/q/17288201" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">-2</div>
	</a>
	<a href="/questions/17288201/which-algorithm-brings-the-best-performance" class="question-hyperlink">Which algorithm brings the best performance?</a>
</div><div class="spacer">
	<a href="/q/19991953" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">0</div>
	</a>
	<a href="/questions/19991953/2-for-loops-twice-faster-than-1-loop" class="question-hyperlink">2 &ldquo;for&rdquo; loops twice faster than 1 loop</a>
</div><div class="spacer">
	<a href="/q/7905760" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">40</div>
	</a>
	<a href="/questions/7905760/matrix-multiplication-small-difference-in-matrix-size-large-difference-in-timi" class="question-hyperlink">Matrix multiplication: Small difference in matrix size, large difference in timings</a>
</div><div class="spacer">
	<a href="/q/1126529" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">35</div>
	</a>
	<a href="/questions/1126529/what-is-the-cost-of-an-l1-cache-miss" class="question-hyperlink">What is the Cost of an L1 Cache Miss?</a>
</div><div class="spacer">
	<a href="/q/10439094" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">35</div>
	</a>
	<a href="/questions/10439094/why-am-i-observing-multiple-inheritance-to-be-faster-than-single" class="question-hyperlink">Why am I observing multiple inheritance to be faster than single?</a>
</div><div class="spacer">
	<a href="/q/12675092" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">24</div>
	</a>
	<a href="/questions/12675092/writing-a-program-to-get-l1-cache-line-size" class="question-hyperlink">Writing a program to get (L1) cache line size</a>
</div><div class="spacer">
	<a href="/q/15604411" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">9</div>
	</a>
	<a href="/questions/15604411/memory-allocation-deallocation" class="question-hyperlink">Memory Allocation/Deallocation?</a>
</div><div class="spacer">
	<a href="/q/3122915" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">14</div>
	</a>
	<a href="/questions/3122915/the-prefetch-instruction" class="question-hyperlink">The prefetch instruction</a>
</div><div class="spacer">
	<a href="/q/9515482" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">6</div>
	</a>
	<a href="/questions/9515482/performance-advantages-of-powers-of-2-sized-data" class="question-hyperlink">Performance advantages of powers-of-2 sized data?</a>
</div>					<div class="spacer more">
				<a href="http://stackoverflow.com/questions/linked/8547778">see more linked questions…</a>
			</div>
	</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer">
<a href="/q/8919834" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">40
    </div>
</a><a href="/questions/8919834/c-vs-java-why-does-the-icc-generate-slower-code-than-vc" class="question-hyperlink">C++ vs Java? Why does the ICC generate slower code than VC? </a>
</div>
<div class="spacer">
<a href="/q/9371238" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">518
    </div>
</a><a href="/questions/9371238/why-is-reading-lines-from-stdin-much-slower-in-c-than-python" class="question-hyperlink">Why is reading lines from stdin much slower in C++ than Python?</a>
</div>
<div class="spacer">
<a href="/q/9601427" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">99
    </div>
</a><a href="/questions/9601427/is-inline-assembly-language-slower-than-native-c-code" class="question-hyperlink">Is inline assembly language slower than native C++ code?</a>
</div>
<div class="spacer">
<a href="/q/10095465" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">8
    </div>
</a><a href="/questions/10095465/how-can-i-get-an-intrinsic-for-the-exp-function-in-x64-code" class="question-hyperlink">How can I get an intrinsic for the exp() function in x64 code?</a>
</div>
<div class="spacer">
<a href="/q/11227809" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted extra-large">8115
    </div>
</a><a href="/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array" class="question-hyperlink">Why is processing a sorted array faster than an unsorted array?</a>
</div>
<div class="spacer">
<a href="/q/11413855" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">106
    </div>
</a><a href="/questions/11413855/why-is-transposing-a-matrix-of-512x512-much-slower-than-transposing-a-matrix-of" class="question-hyperlink">Why is transposing a matrix of 512x512 much slower than transposing a matrix of 513x513?</a>
</div>
<div class="spacer">
<a href="/q/12919184" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">38
    </div>
</a><a href="/questions/12919184/why-doesnt-a-compiler-optimize-floating-point-2-into-an-exponent-increment" class="question-hyperlink">Why doesn&#39;t a compiler optimize floating-point *2 into an exponent increment?</a>
</div>
<div class="spacer">
<a href="/q/21947452" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted large">907
    </div>
</a><a href="/questions/21947452/why-is-printing-b-dramatically-slower-than-printing" class="question-hyperlink">Why is printing &ldquo;B&rdquo; dramatically slower than printing &ldquo;#&rdquo;?</a>
</div>
<div class="spacer">
<a href="/q/23172567" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="/questions/23172567/code-accessing-continuous-l1-cache-memory-slower-than-code-accessing-3x-non-cont" class="question-hyperlink">Code accessing continuous L1 cache memory slower than code accessing 3x non-continuous L1 memory</a>
</div>
<div class="spacer">
<a href="/q/23507597" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">5
    </div>
</a><a href="/questions/23507597/vector-of-64-bit-double-faster-to-dot-product-than-a-vector-of-32-bit-unsigned-i" class="question-hyperlink">Vector of 64-bit double faster to dot-product than a vector of 32-bit unsigned int?</a>
</div>

                    </div>
				</div>
            
<div id="hot-network-questions" class="module">
    <h4>
        <a href="//stackexchange.com/questions?tab=hot" 
           class="js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li >
                <div class="favicon favicon-mathematica" title="Mathematica Stack Exchange"></div><a href="http://mathematica.stackexchange.com/questions/51919/how-to-find-all-symbols-in-an-expression-and-perform-an-operation-on-them" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:387 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to find all symbols in an expression and perform an operation on them?
                </a>

            </li>
            <li >
                <div class="favicon favicon-travel" title="Travel Stack Exchange"></div><a href="http://travel.stackexchange.com/questions/31267/can-i-carry-homeopathic-medicines-and-uncooked-rice-to-germany" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:273 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Can I carry Homeopathic medicines and uncooked rice to Germany?
                </a>

            </li>
            <li >
                <div class="favicon favicon-cooking" title="Seasoned Advice"></div><a href="http://cooking.stackexchange.com/questions/45226/what-is-the-difference-between-a-prawn-and-a-shrimp" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:49 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the difference between a prawn and a shrimp?
                </a>

            </li>
            <li >
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="http://codegolf.stackexchange.com/questions/32782/survival-game-alienwar" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Survival Game - AlienWar
                </a>

            </li>
            <li >
                <div class="favicon favicon-tridion" title="Tridion Stack Exchange"></div><a href="http://tridion.stackexchange.com/questions/6030/can-we-take-backup-of-tridion-user" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:485 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Can we take backup of tridion user?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-philosophy" title="Philosophy Stack Exchange"></div><a href="http://philosophy.stackexchange.com/questions/14352/why-does-the-universe-obey-scientific-laws" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:265 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why does the universe obey scientific laws?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-scifi" title="Science Fiction &amp; Fantasy Stack Exchange"></div><a href="http://scifi.stackexchange.com/questions/60488/old-scifi-movie-glowing-lights-in-chests-to-indicate-attraction" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:186 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Old SciFi movie - glowing lights in chests to indicate attraction
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/853602/what-should-i-use-latex-or-microsoft-word-professional" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What should I use Latex or Microsoft Word Professional?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-askubuntu" title="Ask Ubuntu"></div><a href="http://askubuntu.com/questions/490385/read-a-part-of-massive-online-csv-file-using-its-url-from-command-line" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:89 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Read a part of massive online CSV file using its URL from command line
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-security" title="Information Security Stack Exchange"></div><a href="http://security.stackexchange.com/questions/62185/why-do-atms-accept-any-pin" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:162 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why do ATMs accept any PIN?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-movies" title="Movies &amp; TV Stack Exchange"></div><a href="http://movies.stackexchange.com/questions/21795/why-is-spider-man-left-out-of-the-avengers" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:367 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why is Spider-Man left out of The Avengers?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="http://electronics.stackexchange.com/questions/117303/why-do-we-need-so-many-transistors" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why do we need so many transistors?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-security" title="Information Security Stack Exchange"></div><a href="http://security.stackexchange.com/questions/62124/phones-broadcast-the-ssids-of-all-networks-they-have-ever-connected-to-how-can" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:162 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Phones broadcast the SSIDs of all networks they have ever connected to. How can these be obtained by an attacker?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/853085/is-n-1-often-a-prime" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is n! + 1 often a prime?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-serverfault" title="Server Fault"></div><a href="http://serverfault.com/questions/609295/gbit-uplink-vs-regular-switch-port" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:2 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Gbit uplink vs Regular switch port
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-craftcms" title="Craft CMS Stack Exchange"></div><a href="http://craftcms.stackexchange.com/questions/650/should-i-use-tags-for-cities" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:563 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Should I use tags for cities?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="http://electronics.stackexchange.com/questions/117338/smd-removal-process" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    SMD Removal Process
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-gamedev" title="Game Development Stack Exchange"></div><a href="http://gamedev.stackexchange.com/questions/79594/how-can-i-determine-the-extreme-color-values-in-a-texture" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:53 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How can I determine the extreme color values in a texture?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-japanese" title="Japanese Language Stack Exchange"></div><a href="http://japanese.stackexchange.com/questions/17617/what-is-the-etymology-of-the-word-katsu" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:257 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the etymology of the word Katsu?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-buddhism" title="Buddhism Stack Exchange"></div><a href="http://buddhism.stackexchange.com/questions/1777/can-personal-experience-generate-buddhistic-insight-outside-of-meditation" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:565 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Can personal experience generate buddhistic insight outside of meditation?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-academia" title="Academia Stack Exchange"></div><a href="http://academia.stackexchange.com/questions/24239/is-it-appropriate-to-ask-colleagues-opinions-when-reviewing-a-paper" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:415 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is it appropriate to ask colleagues opinions when reviewing a paper?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-skeptics" title="Skeptics Stack Exchange"></div><a href="http://skeptics.stackexchange.com/questions/22180/do-european-countries-maintain-air-force-on-high-alert" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:212 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Do European countries maintain Air Force on high alert?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-superuser" title="Super User"></div><a href="http://superuser.com/questions/775034/ethernet-cable-too-long" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:3 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Ethernet cable too long?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/853409/how-would-you-count-a-base-36-system" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How would you count a base &gt; 36 system?
                </a>

            </li>
    </ul>

        <a href="#" 
           class="show-more js-show-more js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:3, location:11 })">
            more hot questions
        </a>
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text">
        <a href="/feeds/question/8547778" title="feed of this question and its answers">
            <span class="feed-icon"></span>question feed
        </a>
    </div>
</div>	<script>
StackExchange.ready(function(){$.get('/posts/8547778/ivc/1393');});
</script>
<noscript>
    <div><img src="/posts/8547778/ivc/1393" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">default</div></div>



        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/tour">tour</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://blog.stackoverflow.com?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/work-here">work here</a>
                    <a href="http://stackexchange.com/mediakit">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Development</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://graphicdesign.stackexchange.com" title="professional graphic designers and non-designers trying to do their own graphic design">Graphic Design</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                        <li><a href="http://money.stackexchange.com" title="people who want to be financially literate">Personal Finance &amp; Money</a></li>
                        <li><a href="http://academia.stackexchange.com" title="academics and those enrolled in higher education">Academia</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (10)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackexchange.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Exchange</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2014 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> 
                with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="svnrev">
                rev 2014.6.30.1688
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Stack Overflow works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>
<script>var p = "http", d = "static"; if (document.location.protocol == "https:") { p += "s"; d = "engine"; } var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = p + "://" + d + ".adzerk.net/ados.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
<script>
    var ados = ados || {};
    ados.run = ados.run || [];
    ados.run.push(function () { ados_setKeywords('c%2b%2b,c,performance,compiler-optimization,vectorization');; ados_load(); });         
</script>

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-5620270-1');        
        
        ga('set', 'dimension2', '|c++|c|performance|compiler-optimization|vectorization|');         
        ga('send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
            qc.async=true;
            qc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
            s.parentNode.insertBefore(qc, s);
            var sc=document.createElement('script');
            sc.async=true;
            sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
            s.parentNode.insertBefore(sc, s);
        })();
        _comscore.push({ c1: "2", c2: "17440561" });
        _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>        
    
    </body>
</html>