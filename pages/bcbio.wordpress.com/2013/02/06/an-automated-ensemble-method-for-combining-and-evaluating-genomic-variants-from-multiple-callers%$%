<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>An automated ensemble method for combining and evaluating genomic variants from multiple callers | Blue Collar Bioinformatics</title>
<link rel="pingback" href="http://bcbio.wordpress.com/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Blue Collar Bioinformatics &raquo; Feed" href="http://bcbio.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Blue Collar Bioinformatics &raquo; Comments Feed" href="http://bcbio.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Blue Collar Bioinformatics &raquo; An automated ensemble method for combining and evaluating genomic variants from multiple&nbsp;callers Comments Feed" href="http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-0' href='http://s1.wp.com/_static/??-eJx9kOEOgjAMhF/IWYlK+GN8ljHKGHTrwroQ3l4wMRIx/Os19/UuhSkqw0EwCPisImXrQgJyAyboUaI2g3qrs0npBBt7TWy/AFuLDWdRLRPxBJNrLMoO2mSMSFqwUZGT/KgjzIXWBSczSId+KRlzDT3nMWhy6TDQ8IjL3kctq8Nj4zTSciQcYj6WH2odu+Uj+4J/y0CSmXD1Pv2juF2K67Wsqnv/ArtYi/I=' type='text/css' media='all' />
<!--[if IE 6]>
<link rel='stylesheet' id='journalist-ie6-css'  href='http://s1.wp.com/wp-content/themes/pub/journalist/ie6.css?m=1270837707g&#038;ver=4.0-alpha' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='all-css-2' href='http://s1.wp.com/_static/??-eJx9j8EKwjAQRH/IuI3m4EX8lrRZtyubbEm29PcNPYgi9DYP5g0MMBQ1nrS0TzhPrZ1gW1wHw2KQV7fIStw7hOpEp2is5QfcUyLXI7XiKEo9EvTWF/5JNmPGBnMAEh2jHK1unAit7ZOkmirGtD945LsPQ/D+chuurzfOwlWt' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-2' href='http://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1387483371g' type='text/css' media='print' />
<script type='text/javascript'>
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type='text/javascript' src='http://s1.wp.com/_static/??-eJyFj90OwiAMhV9IZFs08cb4LNvoSBEoUpDo08sSNTpNdtW/7/S0sgQxkk/gkzQsHQ1oQWSG2OvaE+gn2hreyMqhH21WwDNoLhni7RlWAeFQxz7B1qF/wR+ugTg5YK6Wf6bfVuivCGUVM5BCP55FBMb7z9bBkhbBZo2eZc01KMpJTGQtFVlQaUhLjctvRQRbn1FivntRVdXJHdtd0+wPbdd05gFmiIRF'></script>
<link rel='stylesheet' id='all-css-0' href='http://s2.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621g' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='http://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://bcbio.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://bcbio.wordpress.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Genomics X Prize public phase update: variant classification and de novo&nbsp;calling' href='http://bcbio.wordpress.com/2012/09/17/genomics-x-prize-public-phase-update-variant-classification-and-de-novo-calling/' />
<link rel='next' title='The influence of reduced resolution quality scores on alignment and variant&nbsp;calling' href='http://bcbio.wordpress.com/2013/02/13/the-influence-of-reduced-resolution-quality-scores-on-alignment-and-variant-calling/' />
<meta name="generator" content="WordPress.com" />
<link rel='canonical' href='http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/' />
<link rel='shortlink' href='http://wp.me/poxS1-5s' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=http%3A%2F%2Fbcbio.wordpress.com%2F2013%2F02%2F06%2Fan-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=http%3A%2F%2Fbcbio.wordpress.com%2F2013%2F02%2F06%2Fan-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="An automated ensemble method for combining and evaluating genomic variants from multiple callers" />
<meta property="og:url" content="http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/" />
<meta property="og:description" content="Overview A key goal of the Archon Genomics X Prize infrastructure is development of a set of highly accurate reference genome variants. I&#039;ve described our work preparing these reference genomes, an..." />
<meta property="article:published_time" content="2013-02-06T12:25:00+00:00" />
<meta property="article:modified_time" content="2013-03-16T22:11:12+00:00" />
<meta property="article:author" content="http://bcbio.wordpress.com/author/bcbio/" />
<meta property="og:site_name" content="Blue Collar Bioinformatics" />
<meta property="og:image" content="http://bcbio.files.wordpress.com/2013/01/wpid-na12878-ngv3-lab1360-a-callers.png" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:image" content="http://bcbio.files.wordpress.com/2013/01/wpid-na12878-ngv3-lab1360-a-callers.png?w=240" />
<meta name="twitter:card" content="summary" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311975824g" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311975824g" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="http://s0.wp.com/i/webclip.png?m=1391188133g" />
<link rel='openid.server' href='http://bcbio.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='http://bcbio.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="http://bcbio.wordpress.com/osd.xml" title="Blue Collar Bioinformatics" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com" />
<meta name="application-name" content="Blue Collar Bioinformatics" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-task" content="name=Subscribe;action-uri=http://bcbio.wordpress.com/feed/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="title" content="An automated ensemble method for combining and evaluating genomic variants from multiple&nbsp;callers | Blue Collar Bioinformatics on WordPress.com" />
<meta name="description" content="Overview A key goal of the Archon Genomics X Prize infrastructure is development of a set of highly accurate reference genome variants. I&#039;ve described our work preparing these reference genomes, and specifically defined the challenges behind merging genomic variant calls from multiple technologies and calling methods. Comparing calls from two different calling methods, for example&hellip;" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="single single-post postid-338 single-format-standard mp6 highlander-enabled highlander-light">
<div id="container" class="group">

<h1><a href="http://bcbio.wordpress.com/">Blue Collar Bioinformatics</a></h1>

<div id="content" class="group">
<div class="post-338 post type-post status-publish format-standard hentry category-xprize tag-bioinformatics tag-clinical tag-clojure tag-ngs tag-python tag-variant tag-xprize">
	<h2 id="post-338">An automated ensemble method for combining and evaluating genomic variants from multiple&nbsp;callers</h2>
			<p class="comments"><a href="http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/#comments">with 7 comments</a></p>
	
	<div class="main">
		<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Overview</h2>
<div class="outline-text-2" id="text-1">
<p> A key goal of the <a href="http://genomics.xprize.org/">Archon Genomics X Prize</a> infrastructure is development of a set of highly accurate reference genome variants. I&#8217;ve described our work <a href="http://bcbio.wordpress.com/2012/09/17/genomics-x-prize-public-phase-update-variant-classification-and-de-novo-calling/">preparing these reference genomes</a>, and specifically defined the challenges behind merging genomic variant calls from multiple technologies and calling methods. Comparing calls from two different calling methods, for example <a href="http://www.broadinstitute.org/gatk/">GATK</a> and <a href="http://samtools.sourceforge.net/mpileup.shtml">samtools mpileup</a>, produces a large number of differing variants which need reconciliation. Taking the overlapping subset from multiple callers is too conservative and will miss real variations, while including all calls is too liberal and introduces false positives. </p>
<p> Here I&#8217;ll describe a fully automated approach for preparing an accurate set of combined variant calls. <a href="https://en.wikipedia.org/wiki/Ensemble_learning">Ensemble machine learning methods</a> are a powerful way to incorporate inputs from multiple models. We use a heuristic and <a href="https://en.wikipedia.org/wiki/Support_vector_machine">support vector machine (SVM)</a> algorithm to consolidate variants, producing a final set of calls with better sensitivity and specificity than current best practice methods. The approach is open source, fully automated and generalizable to both  human diploid sequencing as well as X Prize haploid reference fosmids. </p>
<p> We use a pair of replicates from <a href="http://www.edgebio.com/">EdgeBio&#8217;s</a> clinical exome sequencing pipeline to prepare ensemble variant calls in the  <a href="http://ccr.coriell.org/Sections/Search/Sample_Detail.aspx?Ref=GM12878">widely studied HapMap NA12878 genome</a>. Compared to variants from a single calling method, the ensemble method produced more concordant  variants when comparing the replicates, with fewer discordants. The finalized ensemble calls also provide a useful method to compare strengths and weaknesses of individual calling methods. The implementation is freely available and I&#8217;ll discuss how to get it running on your  data so you can use, critique and extend the methods. This work is a collaboration between <a href="http://compbio.sph.harvard.edu/chb/">Harvard School of Public Health</a>, <a href="http://www.edgebio.com/">EdgeBio</a> and <a href="http://genomeinabottle.org/">NIST</a>. </p>
</p></div>
</p></div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">Comparison materials and algorithm</h2>
<div class="outline-text-2" id="text-2">
<p> A difficult aspect of evaluating variant calling methods is establishing a reference set of calls. For X Prize we use three established methods, each of which comes with tradeoffs. Metrics like  <a href="http://genome.sph.umich.edu/wiki/SNP_Call_Set_Properties">transition/transversion ratios or dbSNP overlap</a> provide a global picture of calling but are not fine grained enough to distinguish improvements over best practices. Sanger validation restricts you to a manageable subset of calls. Comparisons against public resources like <a href="http://www.1000genomes.org/">1000 genomes</a> bias results towards technologies and callers used in preparing those variant callsets. </p>
<p> Here we employ a fourth method by comparing replicates from EdgeBio&#8217;s clinical exome sequencing pipeline. These are NA12878 samples independently prepared using <a href="http://www.nimblegen.com/products/seqcap/ez/v3/index.html">Nimblegen&#8217;s version 3.0 kit</a> and sequenced on an <a href="http://www.illumina.com/systems/hiseq_2500_1500.ilmn">Illumina HiSeq</a>. By comparing the replicates in regions with 4 or more reads in both samples, we identify the ability of variant calling algorithms to call identical variations with differing coverage and error profiles. </p>
<p> We aligned reads with <a href="http://www.novocraft.com/main/index.php">novoalign</a> and performed deduplication, base recalibration and realignment using <a href="http://gatkforums.broadinstitute.org/discussion/1186/best-practice-variant-detection-with-the-gatk-v4-for-release-2-0">GATK best practices</a>. With these prepared reads, we called variants with five approaches: </p>
<ul>
<li><a href="http://www.broadinstitute.org/gatk/gatkdocs/org_broadinstitute_sting_gatk_walkers_genotyper_UnifiedGenotyper.html">GATK UnifiedGenotyper</a> &ndash; Bayesian approach to call SNPs and indels,   treating each position independently. </li>
<li><a href="http://www.broadinstitute.org/gatk/gatkdocs/org_broadinstitute_sting_gatk_walkers_haplotypecaller_HaplotypeCaller.html">GATK HaplotypeCaller</a> &ndash; Performs local de-novo assembly to call SNPs   and indels on individual haplotypes. </li>
<li><a href="https://github.com/ekg/freebayes">FreeBayes</a> &ndash; Bayesian calling approach that handles simultaneous   SNPs and indel calling via assessment of regional haplotypes. </li>
<li><a href="http://samtools.sourceforge.net/mpileup.shtml">samtools mpileup</a> &ndash; Uses an approach similar to GATK&#8217;s   UnifiedGenotyper for SNP and indel calling. </li>
<li><a href="http://varscan.sourceforge.net/">VarScan</a> &ndash; Calls variants using a heuristic/statistic approach   eliminating common sources of bias. </li>
</ul>
<p> We took a combined heuristic and machine learning approach to consolidate these five sets of variant calls into a final ensemble callset. The first step is to prepare the union of all variant calls from the input callers, identifying calling methods that support each variant. Secondly, we annotate each variant with metrics including strand bias, allele balance, regional sequence entropy, position of calls within reads, regional base quality and overall genotype likelihoods. We then filter this prepared set of all possible variants to produce a final set of trusted calls. </p>
<p> The first filtering step is to heuristically identify trusted variants based on the number of callers supporting them. This configurable parameter allow you to make an initial conservative cutoff for including variants in the final calls: I trust variants supported by N or more callers. </p>
<p> For the remaining calls that fall below the trusted support cutoff, we distinguish true and false positives using a support vector machine (SVM). The annotated metrics described above are the input parameters and we prepare true and false positives for the classifier using a multi-step process: </p>
<ul>
<li>Use variants found in all callers as the true positive set, and   variants found in a single caller as false positives. Use these   training variants to identify an initial set of below-cutoff   variants to include and exclude.  </li>
<li>With this initial set of below-cutoff true/false variants, re-train    multiple classifiers stratified based on variant characteristics:   variant type (indels vs SNPs), zygosity (heterozygous vs   homozygous) and regional sequence complexity.  </li>
<li>Use these final classifiers to identify included and excluded variants   falling below the trusted calling support cutoff. </li>
</ul>
<p> The final set of calls includes the trusted variants and those that pass the SVM filtering. An input configuration file for variant preparation and assessment allows adjustment of the trusted threshold as well as defining which metrics to use for building the SVM classifiers. </p>
</p></div>
</p></div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Ensemble calling improvements</h2>
<div class="outline-text-2" id="text-3">
<p> We assess calling sensitivity and specificity by comparing concordant and discordant variant calls between the replicates. To provide a consistent method to measure both SNP and indel correctness, we use the <a href="https://en.wikipedia.org/wiki/Positive_predictive_value">positive predictive value</a> as the percentage of concordant calls between duplicates (concordant variants / (concordant variants + discordant variants)). This is different than the overall concordance rate, which also includes non-variant regions where both replicates do not call a variation. As a result these percentages will be lower if  you expect the 99% values that result when including reference calls. The advantage of this metric is that it&#8217;s easily interpreted as the percentage of concordant called variants. It also allows individual comparisons of SNPs and indels, since the overall number of indels are low compared to the total bases considered.  <a href="http://gatkforums.broadinstitute.org/discussion/48/using-varianteval">GATK&#8217;s VariantEval documentation</a> has a nice discussion of alternative metrics to genotype concordance. </p>
<p> As a baseline we used calls from GATK&#8217;s UnifiedGenotyper to represent a current best practice approach. GATK calls 117079 SNPs, 86.6% of which are concordant. It also calls 14966 indels, with 64.6% concordant. Here are the full concordant and discordant numbers, broken down by variant type and replicate: </p>
<table border="1" cellspacing="0" cellpadding="6" rules="all" style="width:250px;">
<caption></caption>
<col class="left" />
<col class="right" />
<tbody>
<tr>
<td class="left">concordant: total</td>
<td class="right">111159</td>
</tr>
<tr>
<td class="left">concordant: SNPs</td>
<td class="right">101495</td>
</tr>
<tr>
<td class="left">concordant: indels</td>
<td class="right">9664</td>
</tr>
<tr>
<td class="left">rep1 discordant: total</td>
<td class="right">9857</td>
</tr>
<tr>
<td class="left">rep1 discordant: SNPs</td>
<td class="right">7514</td>
</tr>
<tr>
<td class="left">rep1 discordant: indels</td>
<td class="right">2343</td>
</tr>
<tr>
<td class="left">rep2 discordant: total</td>
<td class="right">11029</td>
</tr>
<tr>
<td class="left">rep2 discordant: SNPs</td>
<td class="right">8070</td>
</tr>
<tr>
<td class="left">rep2 discordant: indels</td>
<td class="right">2959</td>
</tr>
<tr>
<td class="left">het/hom discordant</td>
<td class="right">4181</td>
</tr>
</tbody>
</table>
<p> Our ensemble method produces improvements in both total concordant variants detected and the ratio of concordant to discordants. For SNPs, the ensemble calls add 5345 additional variants to a total of 122424, with an increase in concordance to 87.4%. For indels the major improvement is in removal of discordants: We identify 14184 indels with 67.2% concordant. Here is the equivalent table for the ensemble method: </p>
<table border="1" cellspacing="0" cellpadding="6" rules="all" style="width:250px;">
<caption></caption>
<col class="left" />
<col class="right" />
<tbody>
<tr>
<td class="left">concordant: total</td>
<td class="right">116608</td>
</tr>
<tr>
<td class="left">concordant: SNPs</td>
<td class="right">107063</td>
</tr>
<tr>
<td class="left">concordant: indels</td>
<td class="right">9545</td>
</tr>
<tr>
<td class="left">rep1 discordant: total</td>
<td class="right">9555</td>
</tr>
<tr>
<td class="left">rep1 discordant: SNPs</td>
<td class="right">7581</td>
</tr>
<tr>
<td class="left">rep1 discordant: indels</td>
<td class="right">1974</td>
</tr>
<tr>
<td class="left">rep2 discordant: total</td>
<td class="right">10445</td>
</tr>
<tr>
<td class="left">rep2 discordant: SNPs</td>
<td class="right">7780</td>
</tr>
<tr>
<td class="left">rep2 discordant: indels</td>
<td class="right">2665</td>
</tr>
<tr>
<td class="left">het/hom discordant</td>
<td class="right">3975</td>
</tr>
</tbody>
</table>
<p> For scientists who have worked to increase sensitivity and specificity of individual variant callers, it&#8217;s exciting to be able to improve both simultaneously. As mentioned above, you can also tune the method to increase specificity or sensitivity by adjusting the support needed for including trusted variants. </p>
<p> The final ensemble callsets from both replicates are available as VCF files from <a href="http://www.genomespace.org/">GenomeSpace</a> in the <code>xprize/NA12878-exome-v_03</code> folder: </p>
<ul>
<li>NA12878 exome ensemble calls, replicate 1 &ndash; <a href="https://dm.genomespace.org/datamanager/file/Home/chapmanb/xprize/NA12878-exome-v0_3/NA12878-NGv3-LAB1360-A-ensemble.vcf">Variants (VCF)</a>,   <a href="https://dm.genomespace.org/datamanager/file/Home/chapmanb/xprize/NA12878-exome-v0_3/NA12878-NGv3-LAB1360-A-regions.bed">Callable regions (BED)</a> </li>
<li>NA12878 exome ensemble calls, replicate 2 &ndash; <a href="https://dm.genomespace.org/datamanager/file/Home/chapmanb/xprize/NA12878-exome-v0_3/NA12878-NGv3-LAB1363-A-ensemble.vcf">Variants (VCF)</a>,   <a href="https://dm.genomespace.org/datamanager/file/Home/chapmanb/xprize/NA12878-exome-v0_3/NA12878-NGv3-LAB1363-A-regions.bed">Callable regions (BED)</a> </li>
</ul></div>
</p></div>
<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Comparison of calling methods</h2>
<div class="outline-text-2" id="text-4">
<p> Calling the same samples with multiple callers allows direct comparisons between calling methods. The advantage of producing an accurate final set of ensemble calls is that this provides a baseline to evaluate the strengths and weaknesses of different calling methods. The figure below compares concordant, missing variants and additional variants called by each of the 5 methods in comparison with the consolidated ensemble calls: </p>
<p> <img src="http://bcbio.files.wordpress.com/2013/01/wpid-na12878-ngv3-lab1360-a-callers.png?w=600" alt="Concordance/discordance for calling methods" width="600" /> </p>
<ul>
<li>GATK UnifiedGenotyper provides the best SNP calling, followed   closely by samtools mpileup.  </li>
<li>For indel calling, the GATK HaplotypeCaller produces the most   concordant calls followed by UnifiedGenotyper and FreeBayes.   UnifiedGenotyper does good as well, but is conservative and has the   fewest additional indels. FreeBayes and GATK HaplotypeCaller both   provide resolution of individual haplotypes which helps in regions   with heterozygous indels or closely spaced SNPs and indels.  </li>
<li>If you want to use a single variant caller, GATK UnifiedGenotyper   does the best overall job.   </li>
<li>If you wanted to choose free open-source tools for calling, I would   recommend samtools for SNP calling and FreeBayes for indel calling. </li>
</ul>
<p> Variant calling methods with recommendations for both calling and filtering provide the best out of the box performance. An advantage of GATK and samtools is they provide calling, variant quality metrics, and filtering. On the other side, FreeBayes is a good example of a powerful tool that takes some time to learn to filter optimally. One potential source of bias in producing the individual calls is that I personally have more experience with GATK tools so may have room to improve with the other callers. </p>
</p></div>
</p></div>
<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">Availability and usage</h2>
<div class="outline-text-2" id="text-5">
<p> Combining multiple calling approaches improves both sensitivity and specificity of the final set of variants. The downside is the need to run and coordinate calls from all of the different callers. To mitigate this, we developed an automated pipeline that ties together multiple open-source tools using two custom components: </p>
<ul>
<li><a href="https://github.com/chapmanb/bcbio-nextgen">bcbio-nextgen</a> &ndash; A Python framework to run a full sequencing   analysis pipeline from input fastq files to consolidated ensemble   variant calls. It supports multiple aligners and variant callers,   and enables distributed work over multiple cores on a large machine   or multiple machines in a cluster environment.  </li>
<li><a href="https://github.com/chapmanb/bcbio.variation">bcbio.variation</a> &ndash; A Clojure toolkit build on top of GATK&#8217;s variant   API that provides ensemble call preparation as well as more general   functionality for normalizing and comparing variants produced by   multiple callers. </li>
</ul>
<p> bcbio-nextgen has a script, built on functionality in the <a href="http://cloudbiolinux.org">CloudBioLinux</a> project, that automates installation of associated variant callers and data dependencies: </p>
<pre class="example">wget https://raw.github.com/chapmanb/bcbio-nextgen/master/scripts/bcbio_nextgen_install.py
python bcbio_nextgen_install.py install_directory data_directory
</pre>
<p>
<p> With the dependencies installed, you describe the input files and analysis with a <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> formatted input file. The  <a href="https://github.com/chapmanb/bcbio-nextgen/blob/master/config/examples/NA12878-ensemble.yaml">NA12878 ensemble configuration file</a> used for this analysis provides a useful starting point. Run the analysis, distributed on multiple cores, with: </p>
<pre class="example">bcbio_nextgen.py bcbio_system.yaml ensemble_sample.yaml -n 8
</pre>
<p>
<p> The <a href="https://bcbio-nextgen.readthedocs.org/en/latest/">bcbio-nextgen documentation</a> provides additional details about configuration inputs and distributed processing. The framework generally handles the automation and processing involved with high throughput sequencing analysis. </p>
<p><a href="http://www.edgebio.com/">EdgeBio</a> kindly made the NA12878 datasets used in this analysis publicly available:</p>
<ul>
<li><a href="https://dm.genomespace.org/datamanager/v1.0/file/Home/EdgeBio/CLIA_Examples/NA12878-NGv3-LAB1360-A">NA12878-NGv3-LAB1360-A (replicate 1)</a>
<li><a href="https://dm.genomespace.org/datamanager/v1.0/file/Home/EdgeBio/CLIA_Examples/NA12878-NGv3-LAB1363-A">NA12878-NGv3-LAB1363-A (replicate 2)</a>
</ul>
</p>
<p> I welcome feedback on the approach, data or tools and am actively working to extend this and make it easier to use. As re-sequencing becomes increasingly important for human health applications it is critical that we develop open, shared best-practice workflows to handle the data processing. This allows us to focus back on the fun and difficult work of understanding the biology. </p>
</p></div>
</p></div>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled"><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-5850073-338-53b3e84e4f1be' data-src='//widgets.wp.com/likes/#blog_id=5850073&amp;post_id=338&amp;origin=bcbio.wordpress.com&amp;obj_id=5850073-338-53b3e84e4f1be' data-name='like-post-frame-5850073-338-53b3e84e4f1be'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>			</div>

	<div class="meta group">
		<div class="signature">
			<p>Written by Brad Chapman <span class="edit"></span></p>
			<p>February 6, 2013 at 7:25 am</p>
		</div>
		<div class="tags">
			<p>Posted in <a href="http://bcbio.wordpress.com/category/xprize/" rel="category tag">xprize</a></p>
			<p>Tagged with <a href="http://bcbio.wordpress.com/tag/bioinformatics/" rel="tag">bioinformatics</a>, <a href="http://bcbio.wordpress.com/tag/clinical/" rel="tag">clinical</a>, <a href="http://bcbio.wordpress.com/tag/clojure/" rel="tag">clojure</a>, <a href="http://bcbio.wordpress.com/tag/ngs/" rel="tag">ngs</a>, <a href="http://bcbio.wordpress.com/tag/python/" rel="tag">python</a>, <a href="http://bcbio.wordpress.com/tag/variant/" rel="tag">variant</a>, <a href="http://bcbio.wordpress.com/tag/xprize/" rel="tag">xprize</a></p>		</div>
	</div>
</div>
<div class="navigation group">
	<div class="alignleft">&laquo; <a href="http://bcbio.wordpress.com/2012/09/17/genomics-x-prize-public-phase-update-variant-classification-and-de-novo-calling/" rel="prev">Genomics X Prize public phase update: variant classification and de novo&nbsp;calling</a></div>
	<div class="alignright"><a href="http://bcbio.wordpress.com/2013/02/13/the-influence-of-reduced-resolution-quality-scores-on-alignment-and-variant-calling/" rel="next">The influence of reduced resolution quality scores on alignment and variant&nbsp;calling</a> &raquo;</div>
</div>


<a name="comments" id="comments"></a>

<h3 class="reply">7 Responses</h3>
<p class="comment_meta">Subscribe to comments with <a href="http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/feed/">RSS</a>.</p>

<ol class="commentlist">
<li id="comment-752" class="comment even thread-even depth-1  highlander-comment highlander-comment">
	<div id="div-comment-752">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>Thank you for the excellent post. It was especially alarming to notice how badly VarScan performs. This is because I have used it quite extensively for multi-sample (tumor + normal) variant and indel calling. However, I assume that there might be some differences between single and multi sample variant calling pipelines. Basically, having two samples to compare, makes the at least a little easier. It would be very interesting to read your thoughts about multi sample calling, since this is the task I&#8217;m spending most of my time currently.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn"><a href='http://users.ics.aalto.fi/tvatanen/' rel='external nofollow' class='url'>Tommi Vatanen</a></strong></p>
	<p><small>
		February 8, 2013 at <a href="#comment-752">7:14 am</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=752#respond' onclick='return addComment.moveForm("div-comment-752", "752", "respond", "338")'>Reply</a>	</div>
	</div>
<ul class="children">
<li id="comment-766" class="comment byuser comment-author-bcbio bypostauthor odd alt depth-2  byuser comment-author-bcbio bypostauthor highlander-comment highlander-comment">
	<div id="div-comment-766">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>Tommi;<br />
Thanks for the feedback and for bringing up the point about multiple sample and tumor/normal calling. Many callers optimize for these cases so I&#8217;d hesitate to generalize the results without doing the corresponding experiment. This is something I&#8217;m planning to investigate more since I have projects with multiple sample family calling on-going. More specifically on VarScan, that is the tool I have the least experience with so would welcome ideas to improve my calling and filtering approaches for these single sample cases.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn"><a href='http://bcbio.wordpress.com' rel='external nofollow' class='url'>Brad Chapman</a></strong></p>
	<p><small>
		February 8, 2013 at <a href="#comment-766">7:32 pm</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=766#respond' onclick='return addComment.moveForm("div-comment-766", "766", "respond", "338")'>Reply</a>	</div>
	</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li id="comment-764" class="pingback even thread-odd thread-alt depth-1 pingback highlander-comment highlander-comment">
	<div id="div-comment-764">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>[...] See on Scoop.it &#8211; Bio-informaticsBlue Collar Bioinformatics &#8230;. February 6, 2013 at 7:25 am. Posted in xprize. Tagged with bioinformatics, clinical, clojure, ngs, python, variant, xprize. &laquo; Genomics X Prize public phase update: variant classification and de novo calling &#8230;See on bcbio.wordpress.com [...]</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn"><a href='http://biologyinformatics.wordpress.com/2013/02/08/an-automated-ensemble-method-for-combining-and-evaluating/' rel='external nofollow' class='url'>An automated ensemble method for combining and evaluating &#8230; | Bio-informatique</a></strong></p>
	<p><small>
		February 8, 2013 at <a href="#comment-764">5:15 pm</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=764#respond' onclick='return addComment.moveForm("div-comment-764", "764", "respond", "338")'>Reply</a>	</div>
	</div>
</li><!-- #comment-## -->
<li id="comment-765" class="comment odd alt thread-even depth-1  highlander-comment highlander-comment">
	<div id="div-comment-765">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>I really do appreciate these very interesting and detailed comparisons of the callers.  It&#8217;d be awesome if you want to retry this with the upcoming GATK 2.4 callers &#8212; we think we&#8217;ve fixed a number of issues with the HaplotypeCaller in particular that should improve quality quite a bit.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn">Mark DePristo</strong></p>
	<p><small>
		February 8, 2013 at <a href="#comment-765">5:20 pm</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=765#respond' onclick='return addComment.moveForm("div-comment-765", "765", "respond", "338")'>Reply</a>	</div>
	</div>
<ul class="children">
<li id="comment-767" class="comment byuser comment-author-bcbio bypostauthor even depth-2  byuser comment-author-bcbio bypostauthor highlander-comment highlander-comment">
	<div id="div-comment-767">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>Mark;<br />
Thanks much, I&#8217;m looking forward to the 2.4 release and will definitely be testing it out. One of the reasons I put so much effort into automation is that algorithms are continuously improving and I hope to keep building on this. Thanks for all the work you do on GATK.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn"><a href='http://bcbio.wordpress.com' rel='external nofollow' class='url'>Brad Chapman</a></strong></p>
	<p><small>
		February 8, 2013 at <a href="#comment-767">7:46 pm</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=767#respond' onclick='return addComment.moveForm("div-comment-767", "767", "respond", "338")'>Reply</a>	</div>
	</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li id="comment-1389" class="comment odd alt thread-odd thread-alt depth-1  highlander-comment highlander-comment">
	<div id="div-comment-1389">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>Very interesting article. I&#8217;m helping out someone in SNP/SV discovery using tomato genomes (self-taught) and have tried different mappers with samtools mpileup and contrasted them, and there is quite a difference in the SNPs/SV between using different mappers let alone different callers. Most likely due to the different sensitivity etc of the different mappers, I would be curious to see if different mappings could be combined as well but I expect it then becomes to big and unmanageable. I&#8217;ve moved on to GATK now I feel more confident and using a filtered SNP/INDEL mpileup file to do the GATK. I will try and test your pipeline out sometime, it looks like a potentially comprehensive approach, I would be tempted to include everything (all SNP/sv after filtering but group them by confidence level by the number of callers rather than lose information.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn">Rob</strong></p>
	<p><small>
		July 27, 2013 at <a href="#comment-1389">4:31 pm</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=1389#respond' onclick='return addComment.moveForm("div-comment-1389", "1389", "respond", "338")'>Reply</a>	</div>
	</div>
<ul class="children">
<li id="comment-1394" class="comment byuser comment-author-bcbio bypostauthor even depth-2  byuser comment-author-bcbio bypostauthor highlander-comment highlander-comment">
	<div id="div-comment-1394">
	<div class="comment_mod">
		</div>

	<div class="comment_text">
	<p>Rob;<br />
Thanks for the great feedback. It sounds like you are on the same track that led me to explore this. My suggestion to avoid getting mired in the complexity is to try and establish some sort of benchmark of calls you trust and use this to evaluate the aligners and callers. You should fine a set you trust more than others and then can reduce the problem to dealing with a few best-practice approaches. This would also be more ammenable to a set-union approach to incorporating calls from multiple callers since you&#8217;d have more confidence in individual calls. Thanks again.</p>
	</div>

	<div class="comment_author vcard">
		<p><strong class="fn"><a href='http://bcbio.wordpress.com' rel='external nofollow' class='url'>Brad Chapman</a></strong></p>
	<p><small>
		July 31, 2013 at <a href="#comment-1394">11:55 am</a>			</small></p>
	</div>
	<div class="clear"></div>

	<div class="reply">
		<a class='comment-reply-link' href='/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/?replytocom=1394#respond' onclick='return addComment.moveForm("div-comment-1394", "1394", "respond", "338")'>Reply</a>	</div>
	</div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
<div class="navigation">
	<div class="alignleft"></div>
	<div class="alignright"></div>
</div>
<br />

	


								<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://bcbio.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																										


												<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="f5fd5ed351" /><input type="hidden" name="_wp_http_referer" value="/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=http%3A%2F%2Fbcbio.wordpress.com" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name</label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value="" /></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://s2.wp.com/wp-content/mu-plugins/highlander-comments/images/wplogo.png?m=1391188133g" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="" alt="Google+ photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

	
</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of follow-up comments via email.</label></p></div>

<style type="text/css">
#respond .comment-form-avatar { display: none !important; }
#respond .comment-form-fields { margin-left: 0 !important; }
</style>

												<p class="form-submit">
							<input name="submit" type="submit" id="comment-submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='338' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="21f63ea4bf" /></p>
<input type="hidden" name="genseq" value="1404299342" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="70"/></p>					</form>
							</div><!-- #respond -->
			<div style="clear: both"></div>


</div>

<div id="sidebar">
			<div class="textwidget"><a href="http://feeds2.feedburner.com/bcbio" rel="alternate"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" style="border-width:0;" alt=""></a>&nbsp;<a href="http://feeds2.feedburner.com/bcbio" rel="alternate">Subscribe</a></div>
		<h3> </h3>		<ul>
			<li class="page_item page-item-2"><a href="http://bcbio.wordpress.com/about/">About</a></li>
		</ul>
		<form role="search" method="get" id="searchform" class="searchform" action="http://bcbio.wordpress.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form>				<h3>Recent Posts</h3>		<ul>
					<li>
				<a href="http://bcbio.wordpress.com/2014/05/12/wgs-trio-variant-evaluation/">Whole genome trio variant calling evaluation: low complexity regions, GATK VQSR and high depth&nbsp;filters</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2014/03/06/improving-reproducibility-and-installation-of-genomic-analysis-pipelines-with-docker/">Improving reproducibility and installation of genomic analysis pipelines with&nbsp;Docker</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2013/10/21/updated-comparison-of-variant-detection-methods-ensemble-freebayes-and-minimal-bam-preparation-pipelines/">Updated comparison of variant detection methods: Ensemble, FreeBayes and minimal BAM preparation&nbsp;pipelines</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2013/07/18/summary-from-bioinformatics-open-science-codefest-2013-tools-infrastructure-standards-and-visualization/">Summary from Bioinformatics Open Science Codefest 2013: Tools, infrastructure, standards and&nbsp;visualization</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2013/05/22/scaling-variant-detection-pipelines-for-whole-genome-sequencing-analysis/">Scaling variant detection pipelines for whole genome sequencing&nbsp;analysis</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2013/05/06/framework-for-evaluating-variant-detection-methods-comparison-of-aligners-and-callers/">Framework for evaluating variant detection methods: comparison of aligners and&nbsp;callers</a>
						</li>
					<li>
				<a href="http://bcbio.wordpress.com/2013/04/08/bioinformatics-open-source-interoperability-hackathon-at-the-broad-institute/">Bioinformatics open source interoperability Hackathon at the Broad&nbsp;Institute</a>
						</li>
				</ul>
		<h3> </h3>			<div class="textwidget"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0;" src="http://i.creativecommons.org/l/by/3.0/us/80x15.png" /></a><br />This <span>work</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 United States License</a>.</div>
		

</div>

</div>

<div id="footer">
	<p><a href="http://wordpress.com/?ref=footer_website">Create a free website or blog at WordPress.com</a>. <a href="http://theme.wordpress.com/themes/journalist/" title="Learn more about this theme">The Journalist v1.9 Theme</a>.</p>
</div>
	<div style="display:none">
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"http:\/\/bcbio.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/bcbio.wordpress.com\/wp-login.php?action=logout&_wpnonce=24b55f5e81","homeURL":"http:\/\/bcbio.wordpress.com\/","postID":"338","gravDefault":"blank","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='http://s1.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1403644162j'></script>

	<div id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id='bsub-text'>Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow &ldquo;Blue Collar Bioinformatics&rdquo;</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

						<p class="bit-follow-count">Join 134 other followers</p>
			<p><input type="email" name="email" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter email address" : this.value;'  id="loggedout-follow-field"/></p>

			<input type="hidden" name="action" value="subscribe"/>
			<input type="hidden" name="blog_id" value="5850073"/>
			<input type="hidden" name="source" value="http://bcbio.wordpress.com/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/"/>
			<input type="hidden" name="sub-type" value="loggedout-follow"/>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="f8e51014b4" /><input type="hidden" name="_wp_http_referer" value="/2013/02/06/an-automated-ensemble-method-for-combining-and-evaluating-genomic-variants-from-multiple-callers/" />
			<p id='bsub-subscribe-button'><input type="submit" value="Sign me up" /></p>
			</form>
					<div id='bsub-credit'><a href="http://wordpress.com/signup/?ref=lof">Powered by WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->
		<iframe src='http://widgets.wp.com/likes/master.html?ver=20140528#ver=20140528&amp;mp6=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type="text/javascript">
		//<![CDATA[
			var jetpackLikesWidgetQueue = [];
			var jetpackLikesWidgetBatch = [];
			var jetpackLikesMasterReady = false;

			function JetpackLikespostMessage( message, target ) {
				if ( "string" === typeof message ){
					try{
						message = JSON.parse( message );
					}
					catch(e) {
						return;
					}
				}

				pm( {
					target: target,
					type: 'likesMessage',
					data: message,
					origin: '*'
				} );
			}

			function JetpackLikesBatchHandler() {
				var requests = [];
				jQuery( 'div.jetpack-likes-widget-unloaded' ).each( function( i ) {
					if ( jetpackLikesWidgetBatch.indexOf( this.id ) > -1 )
						return;
					jetpackLikesWidgetBatch.push( this.id );
					var regex = /like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/;
					var match = regex.exec( this.id );
					if ( ! match || match.length != 5 )
						return;

					var info = {
						blog_id: match[2],
						width:   this.width
					};

					if ( 'post' == match[1] ) {
						info.post_id = match[3];
					} else if ( 'comment' == match[1] ) {
						info.comment_id = match[3];
					}

					info.obj_id = match[4];

					requests.push( info );
				});

				if ( requests.length > 0 ) {
					JetpackLikespostMessage( { event: 'initialBatch', requests: requests }, window.frames['likes-master'] );
				}
			}

			function JetpackLikesMessageListener( event ) {
				if ( "undefined" == typeof event.event )
					return;

				if ( 'masterReady' == event.event ) {
					jQuery( document ).ready( function() {
						jetpackLikesMasterReady = true;

						var stylesData = {
								event: 'injectStyles'
						};

						if ( jQuery( 'iframe.admin-bar-likes-widget' ).length > 0 ) {
							JetpackLikespostMessage( { event: 'adminBarEnabled' }, window.frames[ 'likes-master' ] );

							stylesData.adminBarStyles = {
								background: jQuery( '#wpadminbar .quicklinks li#wp-admin-bar-wpl-like > a' ).css( 'background' ),
								isRtl: ( 'rtl' == jQuery( '#wpadminbar' ).css( 'direction' ) )
							};
						}

						if ( !window.addEventListener )
							jQuery( '#wp-admin-bar-admin-bar-likes-widget' ).hide();

						stylesData.textStyles = {
							color: jQuery( '.sd-text-color').css( 'color' ),
							fontFamily: jQuery( '.sd-text-color' ).css( 'font-family' ),
							fontSize: jQuery( '.sd-text-color' ).css( 'font-size' ),
							direction: jQuery( '.sd-text-color' ).css( 'direction' ),
							fontWeight: jQuery( '.sd-text-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-text-color' ).css( 'font-style' ),
							textDecoration: jQuery( '.sd-text-color' ).css('text-decoration')
						};

						stylesData.linkStyles = {
							color: jQuery( '.sd-link-color' ).css('color'),
							fontFamily: jQuery( '.sd-link-color' ).css('font-family'),
							fontSize: jQuery( '.sd-link-color' ).css('font-size'),
							textDecoration: jQuery( '.sd-link-color' ).css('text-decoration'),
							fontWeight: jQuery( '.sd-link-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-link-color' ).css( 'font-style' )
						};

						JetpackLikespostMessage( stylesData, window.frames[ 'likes-master' ] );

						JetpackLikesBatchHandler();

						jQuery( document ).on( 'inview', 'div.jetpack-likes-widget-unloaded', function() {
							jetpackLikesWidgetQueue.push( this.id );
						});
					});
				}

				if ( 'showLikeWidget' == event.event ) {
					jQuery( '#' + event.id + ' .post-likes-widget-placeholder'  ).fadeOut( 'fast', function() {
						jQuery( '#' + event.id + ' .post-likes-widget' ).fadeIn( 'fast', function() {
							JetpackLikespostMessage( { event: 'likeWidgetDisplayed', blog_id: event.blog_id, post_id: event.post_id, obj_id: event.obj_id }, window.frames['likes-master'] );
						});
					});
				}

				if ( 'clickReblogFlair' == event.event ) {
					wpcom_reblog.toggle_reblog_box_flair( event.obj_id );
				}

				if ( 'showOtherGravatars' == event.event ) {
					var $container = jQuery( '#likes-other-gravatars' );
					var $list = $container.find( 'ul' );

					$container.hide();
					$list.html( '' );

					$container.find( '.likes-text span' ).text( event.total );

					jQuery.each( event.likers, function( i, liker ) {
						$list.append( '<li class="' + liker.css_class + '"><a href="' + liker.profile_URL + '" class="wpl-liker" rel="nofollow" target="_parent"><img src="' + liker.avatar_URL + '" alt="' + liker.name + '" width="30" height="30" style="padding-right: 3px;" /></a></li>');
					} );

					var offset = jQuery( "[name='" + event.parent + "']" ).offset();

					$container.css( 'left', offset.left + event.position.left - 10 + 'px' );
					$container.css( 'top', offset.top + event.position.top - 33 + 'px' );

					var rowLength = Math.floor( event.width / 37 );
					var height = ( Math.ceil( event.likers.length / rowLength ) * 37 ) + 13;
					if ( height > 204 ) {
						height = 204;
					}

					$container.css( 'height', height + 'px' );
					$container.css( 'width', rowLength * 37 - 7 + 'px' );

					$list.css( 'width', rowLength * 37 + 'px' );

					$container.fadeIn( 'slow' );

					var scrollbarWidth = $list[0].offsetWidth - $list[0].clientWidth;
					if ( scrollbarWidth > 0 ) {
						$container.width( $container.width() + scrollbarWidth );
						$list.width( $list.width() + scrollbarWidth );
					}
				}
			}

			pm.bind( 'likesMessage', function(e) { JetpackLikesMessageListener(e); } );

			jQuery( document ).click( function( e ) {
				var $container = jQuery( '#likes-other-gravatars' );

				if ( $container.has( e.target ).length === 0 ) {
					$container.fadeOut( 'slow' );
				}
			});

			function JetpackLikesWidgetQueueHandler() {
				var wrapperID;
				if ( ! jetpackLikesMasterReady ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				if ( jetpackLikesWidgetQueue.length > 0 ) {
					// We may have a widget that needs creating now
					var found = false;
					while( jetpackLikesWidgetQueue.length > 0 ) {
						// Grab the first member of the queue that isn't already loading.
						wrapperID = jetpackLikesWidgetQueue.splice( 0, 1 )[0];
						if ( jQuery( '#' + wrapperID ).hasClass( 'jetpack-likes-widget-unloaded' ) ) {
							found = true;
							break;
						}
					}
					if ( ! found ) {
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				} else if ( jQuery( 'div.jetpack-likes-widget-unloaded' ).length > 0 ) {
					// Grab any unloaded widgets for a batch request
					JetpackLikesBatchHandler();

					// Get the next unloaded widget
					wrapperID = jQuery( 'div.jetpack-likes-widget-unloaded' ).first()[0].id;
					if ( ! wrapperID ) {
						// Everything is currently loaded
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				}

				if ( 'undefined' === typeof wrapperID ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				var $wrapper = jQuery( '#' + wrapperID );
				$wrapper.find( 'iframe' ).remove();

				if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='22px' width='68px' frameBorder='0' scrolling='no' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				} else {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='55px' width='100%' frameBorder='0' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				}

				$wrapper.removeClass( 'jetpack-likes-widget-unloaded' ).addClass( 'jetpack-likes-widget-loading' );

				$wrapper.find( 'iframe' ).load( function( e ) {
					var $iframe = jQuery( e.target );
					$wrapper.removeClass( 'jetpack-likes-widget-loading' ).addClass( 'jetpack-likes-widget-loaded' );

					JetpackLikespostMessage( { event: 'loadLikeWidget', name: $iframe.attr( 'name' ), width: $iframe.width() }, window.frames[ 'likes-master' ] );

					if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
						$wrapper.find( 'iframe' ).Jetpack( 'resizeable' );
					}
				});
				setTimeout( JetpackLikesWidgetQueueHandler, 250 );
			}
			JetpackLikesWidgetQueueHandler();
		//]]>
		</script>
<script type='text/javascript' src='http://s1.wp.com/_static/??/wp-content/js/devicepx.js,/wp-includes/js/comment-reply.min.js,/wp-content/mu-plugins/akismet-3.0/_inc/form.js?m=1399919068j'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "bcbio.wordpress.com";
	</script>
	<script type="text/javascript" src="http://s.skimresources.com/js/725X1342.skimlinks.js"></script><script src="http://s.stats.wordpress.com/w.js?21" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'5850073','v':'wpcom','tz':'-4','user_id':'0','post':'338','subd':'bcbio'});
ex_go({'crypt':'UE40eW5QN0p8M2Y/RE1lYixwbDJzRzZYckplWEU4TnJmM2VdWTQsMi9FOG1PVVlfdEphOGJVbWRMY08yfEVJL09lOFIxSFpIQVtdcTlDZz8/R2FPalsrUFM3WENDaU1CNzl3QitObXhPTGxIRElxfDJRaz9BNGhZNVpnNytWQj9iWjI3Xzl4fjNWW3N0W0RoLW8wUitrbERUcXZlc200UlFPdUprZHwrMSx4UDQ4K0tOUSUtRHErVS5PQjNXZ3VqckM0Z1Q3bFYvMHcmX3cwQkFwc10sV3hYQU9oL2ZULSxXMHZIS1haNlZubjl1aHBobGtjZTNnJS5hLEY2LUdLQV9hY2VVOTNbZHFZSi92eTYmczlbV3VocS9PUEsvN0ozelFMaEhrX2srZG1LUVdsUE4='});
addLoadEvent(function(){linktracker_init('5850073',338);});
	</script>
<noscript><img src="http://stats.wordpress.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//stats.wordpress.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>