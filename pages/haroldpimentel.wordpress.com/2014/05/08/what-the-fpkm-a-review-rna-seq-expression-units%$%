<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width" />
	<title>What the FPKM? A review of RNA-Seq expression units | The farrago</title>
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="http://haroldpimentel.wordpress.com/xmlrpc.php" />
	<!--[if lt IE 9]>
	<script src="http://s2.wp.com/wp-content/themes/pub/blaskan/js/html5.js?m=1339795805g" type="text/javascript"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="The farrago &raquo; Feed" href="http://haroldpimentel.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The farrago &raquo; Comments Feed" href="http://haroldpimentel.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="The farrago &raquo; What the FPKM? A review of RNA-Seq expression&nbsp;units Comments Feed" href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel='stylesheet' id='all-css-0' href='http://s1.wp.com/_static/??-eJx9UdFSxCAM/CExV+04vjh+C6UppQ2EgXQ6/Xtpq543d/LEbmY32QRYozIcBIOAX1SkxbqQIXtHuMXEExq5Zc8m5yd4bCM3Y4YJJWozq4PdyTtiezWwtdjzImpgIl5hdb3F6gzDCUvdRy27wmPvNBL6IqvZfHz7ce1wLAHvs8lY+mSIS1di6jzrAFk2wlPoILC4os2/oDbRIitio8VxuCFqIO1SzZpwv1KBForqD62ZXBhccLI92KJmi5zlTAR51Gmf+f3WlwuYzltc4X/3HFuwxJ2mWsfz5/OxsGXuE+r+6PjpP5r20jbNy/vldfoC+ccDhw==' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var objectL10n = {"blaskan_navigation_title":"- Navigation -"};
/* ]]> */
</script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJyFjt0OwiAMRl9IZFs08cb4LGzrsAwKUpDo08sSTfxLdtWmPV9PZQli8JSAkjQsne/RgsgMUek6E0iT3xreyMohDTaPwAtoLhni7VlWAeFQR5Vg65Be8Js1eE4OmKvyz/ZThXRFKKuYgRTUMIsIjPefq731WgSbNRLL2msYfU5i8tb6IguOGtJ3Jp2h/ihD7mtc8axosfIQMSzsyR3bXdPsD23XdOYBMGqAHw=='></script>
<link rel='stylesheet' id='all-css-0' href='http://s2.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621g' type='text/css' media='all' />
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='http://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://haroldpimentel.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://haroldpimentel.wordpress.com/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress.com" />
<link rel='canonical' href='http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/' />
<link rel='shortlink' href='http://wp.me/p3PwCC-A' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=http%3A%2F%2Fharoldpimentel.wordpress.com%2F2014%2F05%2F08%2Fwhat-the-fpkm-a-review-rna-seq-expression-units%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=http%3A%2F%2Fharoldpimentel.wordpress.com%2F2014%2F05%2F08%2Fwhat-the-fpkm-a-review-rna-seq-expression-units%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="What the FPKM? A review of RNA-Seq expression units" />
<meta property="og:url" content="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/" />
<meta property="og:description" content="This post covers the units used in RNA-Seq that are, unfortunately, often misused and misunderstood. I&#039;ll try to clear up a bit of the confusion here. The first thing one should remember is that wi..." />
<meta property="article:published_time" content="2014-05-08T18:55:06+00:00" />
<meta property="article:modified_time" content="2014-05-08T21:38:18+00:00" />
<meta property="article:author" content="http://haroldpimentel.wordpress.com/author/haroldpimentel/" />
<meta property="og:site_name" content="The farrago" />
<meta property="og:image" content="http://wordpress.com/i/blank.jpg?m=1383295312g" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:card" content="summary" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311975824g" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311975824g" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon-precomposed" href="http://s0.wp.com/i/webclip.png?m=1391188133g" />
<link rel='openid.server' href='http://haroldpimentel.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='http://haroldpimentel.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="http://haroldpimentel.wordpress.com/osd.xml" title="The farrago" />
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com" />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none !important;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="The farrago" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="A place for my thoughts on comp bio, statistics, cycling, and [a-zA-Z ]*" /><meta name="msapplication-task" content="name=Subscribe;action-uri=http://haroldpimentel.wordpress.com/feed/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico" /><meta name="title" content="What the FPKM? A review of RNA-Seq expression&nbsp;units | The farrago on WordPress.com" />
<meta name="description" content="This post covers the units used in RNA-Seq that are, unfortunately, often misused and misunderstood. I&#039;ll try to clear up a bit of the confusion here. The first thing one should remember is that without between sample normalization (a topic for a later post), NONE of these units are comparable across experiments. This is a&hellip;" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="single single-post postid-36 single-format-standard mp6 simple-menu sidebar content-wide-sidebar content-wide highlander-enabled highlander-light">
<div id="site">
	<div id="wrapper">
		<header id="header" role="banner">
			<h1 id="site-name"><a href="http://haroldpimentel.wordpress.com/" title="The farrago" rel="home">The farrago</a></h1><div id="header-message">A place for my thoughts on comp bio, statistics, cycling, and [a-zA-Z ]*</div><nav id="nav" role="navigation"><div class="menu"><ul><li class="page_item page-item-1"><a href="http://haroldpimentel.wordpress.com/about/">About</a></li></ul></div>
</nav>		</header>
		<!-- / #header -->

	<section id="content" role="main">
		

		<article id="post-36" class="post-36 post type-post status-publish format-standard hentry category-computational-biology category-statistics-2">
		<header>
			
							<time datetime="2014-05-08T18:55:06+00:00" pubdate>May 8, 2014</time>
			
							<h1>What the FPKM? A review of RNA-Seq expression&nbsp;units</h1>
					</header>

		<div class="content">
			<p>This post covers the units used in RNA-Seq that are, unfortunately, often misused and misunderstood. I&#8217;ll try to clear up a bit of the confusion here.</p>
<p>The first thing one should remember is that without between sample normalization (a topic for a later post), <strong>NONE of these units are comparable across experiments. This is a result of RNA-Seq being a relative measurement, not an absolute one.</strong></p>
<h2>Preliminaries</h2>
<p>Throughout this post &#8220;read&#8221; refers to both single-end or paired-end reads. The concept of counting is the same with either type of read, as each read represents a fragment that was sequenced.</p>
<p>When saying &#8220;feature&#8221;, I&#8217;m referring to an expression feature, by which I mean a genomic region containing a sequence that can normally appear in an RNA-Seq experiment (e.g. gene, isoform, exon).</p>
<p>Finally, I use the random variable <img src='http://s0.wp.com/latex.php?latex=X_i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='X_i' title='X_i' class='latex' /> to denote the counts you observe from a feature of interest <img src='http://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='i' title='i' class='latex' />. Unfortunately, with alternative splicing you do not directly observe <img src='http://s0.wp.com/latex.php?latex=X_i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='X_i' title='X_i' class='latex' />, so often <img src='http://s0.wp.com/latex.php?latex=%5Cmathbb+E%5BX_i%5D&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;mathbb E[X_i]' title='&#92;mathbb E[X_i]' class='latex' /> is used, which is estimated using the EM algorithm by a method like <a href='http://bio.math.berkeley.edu/express/'>eXpress</a>, <a href='http://deweylab.biostat.wisc.edu/rsem/'>RSEM</a>, <a href='http://www.cs.cmu.edu/~ckingsf/software/sailfish/'>Sailfish</a>, <a href='http://cufflinks.cbcb.umd.edu/'>Cufflinks</a>, or one of many other tools. </p>
<hr />
<h2>Counts</h2>
<p>&#8220;Counts&#8221; usually refers to the number of reads that align to a particular feature. I&#8217;ll refer to counts by the random variable <img src='http://s0.wp.com/latex.php?latex=X_i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='X_i' title='X_i' class='latex' />. These numbers are heavily dependent on two things: (1) the amount of fragments you sequenced (this is related to relative abundances) and (2) the length of the feature, or more appropriately, the effective length. Effective length refers to the number of possible start sites a feature could have generated a fragment of that particular length. In practice, the effective length is usually computed as:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Cwidetilde%7Bl%7D_i+%3D+l_i+-+%5Cmu_%7BFLD%7D+%2B+1&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;widetilde{l}_i = l_i - &#92;mu_{FLD} + 1' title='&#92;widetilde{l}_i = l_i - &#92;mu_{FLD} + 1' class='latex' />,
</p>
<p>where <img src='http://s0.wp.com/latex.php?latex=%5Cmu_%7BFLD%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;mu_{FLD}' title='&#92;mu_{FLD}' class='latex' /> is the mean of the fragment length distribution which was learned from the aligned read. If the abundance estimation method you&#8217;re using incorporates sequence bias modeling (such as eXpress or Cufflinks), the bias is often incorporated into the effective length by making the feature shorter or longer depending on the effect of the bias.</p>
<p><strong>Since counts are NOT scaled by the length of the feature, all units in this category are not comparable within a sample without adjusting for the feature length.</strong> This means you can&#8217;t sum the counts over a set of features to get the expression of that set (e.g. you can&#8217;t sum isoform counts to get gene counts).</p>
<p>Counts are often used by differential expression methods since they are naturally represented by a counting model, such as a negative binomial (NB2).</p>
<h3>Effective counts</h3>
<p>When eXpress came out, they began reporting &#8220;effective counts.&#8221; This is basically the same thing as standard counts, with the difference being that they are adjusted for the amount of bias in the experiment. To compute effective counts:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BeffCounts%7D_i+%3D+X_i+%5Ccdot+%5Cdfrac%7Bl_i%7D%7B%5Cwidetilde%7Bl%7D_i%7D&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{effCounts}_i = X_i &#92;cdot &#92;dfrac{l_i}{&#92;widetilde{l}_i}' title='&#92;text{effCounts}_i = X_i &#92;cdot &#92;dfrac{l_i}{&#92;widetilde{l}_i}' class='latex' />.
</p>
<p>The intuition here is that if the effective length is much shorter than the actual length, then in an experiment with no bias you would expect to see more counts. Thus, the effective counts are scaling the observed counts up.</p>
<h3>Counts per million</h3>
<p>Counts per million (CPM) mapped reads are counts scaled by the number of fragments you sequenced (<img src='http://s0.wp.com/latex.php?latex=N&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='N' title='N' class='latex' />) times one million. This unit is related to the FPKM without length normalization and a factor of <img src='http://s0.wp.com/latex.php?latex=10%5E3&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='10^3' title='10^3' class='latex' />:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BCPM%7D_i+%3D+%5Cdfrac%7BX_i%7D%7B%5Cdfrac%7BN%7D%7B10%5E6%7D%7D+%3D+%5Cdfrac%7BX_i%7D%7BN%7D%5Ccdot+10%5E6+&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{CPM}_i = &#92;dfrac{X_i}{&#92;dfrac{N}{10^6}} = &#92;dfrac{X_i}{N}&#92;cdot 10^6 ' title='&#92;text{CPM}_i = &#92;dfrac{X_i}{&#92;dfrac{N}{10^6}} = &#92;dfrac{X_i}{N}&#92;cdot 10^6 ' class='latex' />
</p>
<p>I&#8217;m not sure where this unit first appeared, but I&#8217;ve seen it used with <a href='http://www.bioconductor.org/packages/release/bioc/html/edgeR.html'>edgeR</a> and talked about briefly in the <a href='http://genomebiology.com/2014/15/2/R29'>limma voom paper</a>. </p>
<hr />
<h2>Within sample normalization</h2>
<p>As noted in the counts section, the number of fragments you see from a feature depends on its length. Therefore, in order to compare features of different length you should normalize counts by the length of the feature. Doing so allows the summation of expression across features to get the expression of a group of features (think a set of transcripts which make up a gene).</p>
<p>Again, the methods in this section allow for comparison of features with different length WITHIN a sample but not BETWEEN samples. </p>
<h3>TPM</h3>
<p>Transcripts per million (TPM) is a measurement of the proportion of transcripts in your pool of RNA. </p>
<p>Since we are interested in taking the length into consideration, a natural measurement is the rate, counts per base (<img src='http://s0.wp.com/latex.php?latex=X_i+%2F+%5Cwidetilde%7Bl%7D_i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='X_i / &#92;widetilde{l}_i' title='X_i / &#92;widetilde{l}_i' class='latex' />). As you might immediately notice, this number is also dependent on the total number of fragments sequenced. To adjust for this, simply divide by the sum of all rates and this gives the proportion of transcripts <img src='http://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='i' title='i' class='latex' /> in your sample. After you compute that, you simply scale by one million because the proportion is often very small and a pain to deal with. In math:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BTPM%7D_i+%3D+%5Cdfrac%7BX_i%7D%7B%5Cwidetilde%7Bl%7D_i%7D+%5Ccdot+%5Cleft%28+%5Cdfrac%7B1%7D%7B%5Csum_j+%5Cdfrac%7BX_j%7D%7B%5Cwidetilde%7Bl%7D_j%7D%7D+%5Cright%29+%5Ccdot+10%5E6&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{TPM}_i = &#92;dfrac{X_i}{&#92;widetilde{l}_i} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j}} &#92;right) &#92;cdot 10^6' title='&#92;text{TPM}_i = &#92;dfrac{X_i}{&#92;widetilde{l}_i} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j}} &#92;right) &#92;cdot 10^6' class='latex' />.
</p>
<p>TPM has a very nice interpretation when you&#8217;re looking at transcript abundances. As the name suggests, the interpretation is that if you were to sequence one million full length transcripts, TPM is the number of transcripts you would have seen of type <img src='http://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='i' title='i' class='latex' />, given the abundances of the other transcripts in your sample. The last &#8220;given&#8221; part is important. The denominator is going to be different between experiments, and thus is also sample dependent which is why you cannot directly compare TPM between samples. While this is true, TPM is probably the most stable unit across experiments, though you still shouldn&#8217;t compare it across experiments.</p>
<p>I&#8217;m fairly certain TPM is attributed to Bo Li <em>et. al.</em> in the <a href='http://bioinformatics.oxfordjournals.org/content/26/4/493.long'>original RSEM paper</a>.</p>
<h3>RPKM/FPKM</h3>
<p>Reads per kilobase of exon per million reads mapped (RPKM), or the more generic FPKM (substitute reads with fragments) are essentially the same thing. Contrary to some misconceptions, FPKM is not 2 * RPKM if you have paired-end reads. FPKM == RPKM if you have single-end reads, and saying RPKM when you have paired-end reads is just weird, so don&#8217;t do it <span class='wp-smiley emoji emoji-smile' title=':)'>:)</span>.</p>
<p>A few years ago when the <a href='http://www.nature.com/nmeth/journal/v5/n7/abs/nmeth.1226.html'>Mortazavi <em>et. al.</em> paper</a> came out and introduced RPKM, I remember many people referring to the method which they used to compute expression (termed the &#8220;rescue method&#8221;) as RPKM. This also happened with the Cufflinks method. People would say things like, &#8220;We used the RPKM method to compute expression&#8221; when they meant to say they used the rescue method or Cufflinks method. I&#8217;m happy to report that I haven&#8217;t heard this as much recently, but I still hear it every now and then. Therefore, let&#8217;s clear one thing up: FPKM is NOT a method, it is simply a unit of expression.</p>
<p>FPKM takes the same rate we discussed in the TPM section and instead of dividing it by the sum of rates, divides it by the total number of reads sequenced (<img src='http://s0.wp.com/latex.php?latex=N&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='N' title='N' class='latex' />) and multiplies by a big number (<img src='http://s0.wp.com/latex.php?latex=10%5E9&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='10^9' title='10^9' class='latex' />). In math:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BFPKM%7D_i+%3D+%5Cdfrac%7BX_i%7D%7B+%5Cleft%28%5Cdfrac%7B%5Cwidetilde%7Bl%7D_i%7D%7B10%5E3%7D%5Cright%29+%5Cleft%28+%5Cdfrac%7BN%7D%7B10%5E6%7D+%5Cright%29%7D+%3D+%5Cdfrac%7BX_i%7D%7B%5Cwidetilde%7Bl%7D_i+N%7D+%5Ccdot+10%5E9++&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{FPKM}_i = &#92;dfrac{X_i}{ &#92;left(&#92;dfrac{&#92;widetilde{l}_i}{10^3}&#92;right) &#92;left( &#92;dfrac{N}{10^6} &#92;right)} = &#92;dfrac{X_i}{&#92;widetilde{l}_i N} &#92;cdot 10^9  ' title='&#92;text{FPKM}_i = &#92;dfrac{X_i}{ &#92;left(&#92;dfrac{&#92;widetilde{l}_i}{10^3}&#92;right) &#92;left( &#92;dfrac{N}{10^6} &#92;right)} = &#92;dfrac{X_i}{&#92;widetilde{l}_i N} &#92;cdot 10^9  ' class='latex' />.
</p>
<p>The interpretation of FPKM is as follows: if you were to sequence this pool of RNA again, you expect to see <img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BFPKM%7D_i&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{FPKM}_i' title='&#92;text{FPKM}_i' class='latex' /> fragments for each thousand bases in the feature for every  <img src='http://s0.wp.com/latex.php?latex=N%2F10%5E6&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='N/10^6' title='N/10^6' class='latex' /> fragments you&#8217;ve sequenced. It&#8217;s basically just the rate of fragments per base multiplied by a big number (proportional to the number of fragments you sequenced) to make it more convenient.</p>
<h3>Relationship between TPM and FPKM</h3>
<p>The relationship between TPM and FPKM is derived by Lior Pachter in a <a href='http://arxiv.org/abs/1104.3889'>review of transcript quantification methods</a> (<img src='http://s0.wp.com/latex.php?latex=%5Ctext%7BTPM%7D_i+%3D+%5Chat%7B%5Crho%7D_i+%5Ccdot+10%5E6&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;text{TPM}_i = &#92;hat{&#92;rho}_i &#92;cdot 10^6' title='&#92;text{TPM}_i = &#92;hat{&#92;rho}_i &#92;cdot 10^6' class='latex' />) in equations 10 &#8211; 13. I&#8217;ll recite it here:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D++%5Ctext%7BTPM%7D_i+%26%3D+%5Cdfrac%7BX_i%7D%7B%5Cwidetilde%7Bl%7D_i%7D+%5Ccdot+%5Cleft%28+%5Cdfrac%7B1%7D%7B%5Csum_j+%5Cdfrac%7BX_j%7D%7B%5Cwidetilde%7Bl%7D_j%7D%7D+%5Cright%29+%5Ccdot+10%5E6+%5C%5C++%26%5Cpropto+%5Cdfrac%7BX_i%7D%7B%5Cwidetilde%7Bl%7D_i+%5Ccdot+N%7D+%5Ccdot+%5Cleft%28+%5Cdfrac%7B1%7D%7B%5Csum_j+%5Cdfrac%7BX_j%7D%7B%5Cwidetilde%7Bl%7D_j+%5Ccdot+N%7D+%7D+%5Cright%29+%5C%5C++%26%5Cpropto+%5Cdfrac%7BX_i%7D%7B%5Cwidetilde%7Bl%7D_i+%5Ccdot+N%7D+%5Ccdot+10%5E9+++%5Cend%7Baligned%7D++&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;begin{aligned}  &#92;text{TPM}_i &amp;= &#92;dfrac{X_i}{&#92;widetilde{l}_i} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j}} &#92;right) &#92;cdot 10^6 &#92;&#92;  &amp;&#92;propto &#92;dfrac{X_i}{&#92;widetilde{l}_i &#92;cdot N} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j &#92;cdot N} } &#92;right) &#92;&#92;  &amp;&#92;propto &#92;dfrac{X_i}{&#92;widetilde{l}_i &#92;cdot N} &#92;cdot 10^9   &#92;end{aligned}  ' title='&#92;begin{aligned}  &#92;text{TPM}_i &amp;= &#92;dfrac{X_i}{&#92;widetilde{l}_i} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j}} &#92;right) &#92;cdot 10^6 &#92;&#92;  &amp;&#92;propto &#92;dfrac{X_i}{&#92;widetilde{l}_i &#92;cdot N} &#92;cdot &#92;left( &#92;dfrac{1}{&#92;sum_j &#92;dfrac{X_j}{&#92;widetilde{l}_j &#92;cdot N} } &#92;right) &#92;&#92;  &amp;&#92;propto &#92;dfrac{X_i}{&#92;widetilde{l}_i &#92;cdot N} &#92;cdot 10^9   &#92;end{aligned}  ' class='latex' />.
</p>
<p>If you have FPKM, you can easily compute TPM:</p>
<p align='center'>
<img src='http://s0.wp.com/latex.php?latex=%5Cbegin%7Baligned%7D++%5Ctext%7BTPM%7D_i+%26%3D+%5Cleft%28+%5Cdfrac%7B%5Ctext%7BFPKM%7D_i%7D%7B%5Csum_j+%5Ctext%7BFPKM%7D_j+%7D+%5Cright%29+%5Ccdot+10%5E6++%5Cend%7Baligned%7D++&amp;bg=ffffff&amp;fg=000000&amp;s=0' alt='&#92;begin{aligned}  &#92;text{TPM}_i &amp;= &#92;left( &#92;dfrac{&#92;text{FPKM}_i}{&#92;sum_j &#92;text{FPKM}_j } &#92;right) &#92;cdot 10^6  &#92;end{aligned}  ' title='&#92;begin{aligned}  &#92;text{TPM}_i &amp;= &#92;left( &#92;dfrac{&#92;text{FPKM}_i}{&#92;sum_j &#92;text{FPKM}_j } &#92;right) &#92;cdot 10^6  &#92;end{aligned}  ' class='latex' />.
</p>
<p>Wagner et. al. discuss some of the benefits of TPM over FPKM <a href='http://lynchlab.uchicago.edu/publications/Wagner,%20Kin,%20and%20Lynch%20(2012).pdf'>here</a> and advocate the use of TPM.</p>
<hr />
<p>I hope this clears up some confusion or helps you see the relationship between these units. In the near future I plan to write about how to use sequencing depth normalization with these different units so you can compare several samples to each other.</p>
<hr />
<h2>R code</h2>
<p>I&#8217;ve included some R code below for computing effective counts, TPM, and FPKM. I&#8217;m sure a few of those logs aren&#8217;t necessary, but I don&#8217;t think they&#8217;ll hurt <span class='wp-smiley emoji emoji-smile' title=':)'>:)</span>.</p>
<pre class="brush: r; title: ; notranslate" title="">
countToTpm &lt;- function(counts, effLen)
{
    rate &lt;- log(counts) - log(effLen)
    denom &lt;- log(sum(exp(rate)))
    exp(rate - denom + log(1e6))
}

countToFpkm &lt;- function(counts, effLen)
{
    N &lt;- sum(counts)
    exp( log(counts) + log(1e9) - log(effLen) - log(N) )
}

fpkmToTpm &lt;- function(fpkm)
{
    exp(log(fpkm) - log(sum(fpkm)) + log(1e6))
}

countToEffCounts &lt;- function(counts, len, effLen)
{
    counts * (len / effLen)
}

################################################################################
# An example
################################################################################
cnts &lt;- c(4250, 3300, 200, 1750, 50, 0)
lens &lt;- c(900, 1020, 2000, 770, 3000, 1777)
countDf &lt;- data.frame(count = cnts, length = lens)

# assume a mean(FLD) = 203.7
countDf$effLength &lt;- countDf$length - 203.7 + 1
countDf$tpm &lt;- with(countDf, countToTpm(count, effLength))
countDf$fpkm &lt;- with(countDf, countToFpkm(count, effLength))
with(countDf, all.equal(tpm, fpkmToTpm(fpkm)))
countDf$effCounts &lt;- with(countDf, countToEffCounts(count, length, effLength))
</pre>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" class="share-twitter sd-button share-icon" href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?share=twitter" title="Click to share on Twitter" id="sharing-twitter-36"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" class="share-facebook sd-button share-icon" href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?share=facebook" title="Share on Facebook" id="sharing-facebook-36"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" class="share-google-plus-1 sd-button share-icon" href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?share=google-plus-1" title="Click to share on Google+" id="sharing-google-36"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-56609138-36-53b3e857b859c' data-src='//widgets.wp.com/likes/#blog_id=56609138&amp;post_id=36&amp;origin=haroldpimentel.wordpress.com&amp;obj_id=56609138-36-53b3e857b859c' data-name='like-post-frame-56609138-36-53b3e857b859c'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div></div>			
					</div>
		<!-- / .content -->

		<footer>
							<span class="author"><span class="author-label">Written by</span> <a href="http://haroldpimentel.wordpress.com/author/haroldpimentel/" title="Posts by haroldpimentel" rel="author">haroldpimentel</a></span>
													<span class="categories">
					<span class="categories-label">Posted in</span> <a href="http://haroldpimentel.wordpress.com/category/computational-biology/" rel="category tag">Computational biology</a>, <a href="http://haroldpimentel.wordpress.com/category/statistics-2/" rel="category tag">Statistics</a>				</span>
						
					</footer>
	</article>
	<!-- / #post-36 -->
	<section id="comments">
	
			<h1 id="comments-title">8 comments</h1>

		
		<ol id="commentlist">		<li class="comment even thread-even depth-1 highlander-comment" id="comment-1">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://2.gravatar.com/avatar/8add580c8c62fa9768247b0f3835c834?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-1">May 8, 2014 - 9:54 pm</a></time>

				<cite>Mr. Anon</cite>			</header>

			
			<p>Very Cool!</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=1#respond' onclick='return addComment.moveForm("comment-1", "1", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-3">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://2.gravatar.com/avatar/eb5414f51f8f6f326f0ebc9df970f99f?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-3">May 10, 2014 - 4:00 am</a></time>

				<cite><a href='http://gravatar.com/champinjapan' rel='external nofollow' class='url'>Juan</a></cite>			</header>

			
			<p>Nice post!<br />
What about the TMM? Is that also a within-sample normalization method?</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=3#respond' onclick='return addComment.moveForm("comment-3", "3", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		<ul class="children">
		<li class="comment byuser comment-author-haroldpimentel bypostauthor even depth-2 highlander-comment" id="comment-4">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://0.gravatar.com/avatar/6b94e7047c18c9c5e664707d46651161?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-4">May 10, 2014 - 7:12 am</a></time>

				<cite><a href='http://haroldpimentel.wordpress.com' rel='external nofollow' class='url'>haroldpimentel</a></cite>			</header>

			
			<p>Thanks for the comment. TMM is a between sample normalization, primarily used for comparing counts across numerous samples. I&#8217;ll talk about some of these methods in a post soon. </p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=4#respond' onclick='return addComment.moveForm("comment-4", "4", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 highlander-comment" id="comment-5">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://1.gravatar.com/avatar/450d3dae2ef455ab79c664dcec12bc7c?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-5">May 12, 2014 - 5:13 pm</a></time>

				<cite>Funan Shi</cite>			</header>

			
			<p>can you fix the link to the wagner paper? it&#8217;s down atm. </p>
<p>very helpful and the writing is crystal clear. thanks a bunch!</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=5#respond' onclick='return addComment.moveForm("comment-5", "5", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		<ul class="children">
		<li class="comment byuser comment-author-haroldpimentel bypostauthor even depth-2 highlander-comment" id="comment-6">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://0.gravatar.com/avatar/6b94e7047c18c9c5e664707d46651161?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-6">May 12, 2014 - 8:56 pm</a></time>

				<cite><a href='http://haroldpimentel.wordpress.com' rel='external nofollow' class='url'>haroldpimentel</a></cite>			</header>

			
			<p>Thanks for the comment. The link seems to be working on my end. Here is the the PubMed:</p>
<p><a href="http://www.ncbi.nlm.nih.gov/pubmed/22872506" rel="nofollow">http://www.ncbi.nlm.nih.gov/pubmed/22872506</a></p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=6#respond' onclick='return addComment.moveForm("comment-6", "6", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-7">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://1.gravatar.com/avatar/7d6da90093c77e5c9b8a741a7ddab317?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-7">May 13, 2014 - 8:22 am</a></time>

				<cite><a href='http://twitter.com/notsojunkdna' rel='external nofollow' class='url'>Nicolas Robine</a></cite>			</header>

			
			<p>Hi,<br />
Great post and explanation. One thing that could be useful to clarify (at least for me):<br />
TPM is normalized to the sum of the abundance of each transcripts, while FPKM is normalized to the number of reads sequenced.<br />
However, as you know, not all sequenced reads map the genome, and not all mapped reads are assigned to a transcript.<br />
I understand that the FPKM to TPM equation cancels out the normalization factor, but still, it&#8217;s never been clear for me if FPKM normalizes to &#8220;number of sequenced reads&#8221;, &#8220;number of mapped reads&#8221; or &#8220;number of assigned reads&#8221;. And from a practical stand point, I don&#8217;t see where Cufflinks gets the information on the number of sequenced reads if the input is a BAM file.</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=7#respond' onclick='return addComment.moveForm("comment-7", "7", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		<ul class="children">
		<li class="comment byuser comment-author-haroldpimentel bypostauthor even depth-2 highlander-comment" id="comment-8">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://0.gravatar.com/avatar/6b94e7047c18c9c5e664707d46651161?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-8">May 13, 2014 - 8:59 am</a></time>

				<cite><a href='http://haroldpimentel.wordpress.com' rel='external nofollow' class='url'>haroldpimentel</a></cite>			</header>

			
			<p>Thanks for the comment. Great question. I can&#8217;t speak for any of the engineers (Cufflinks, eXpress, etc.) as I&#8217;ve never worked on any of the abundance estimation software. I can say that intuitively I would normalize by the number of reads that are compatible with at least one transcript. </p>
<p>Although, at the end of the day if you&#8217;re comparing within a sample I don&#8217;t think it really matters, it will just change the scale of the number, but within a sample everything will be normalized by the same N. Between samples it is probably more important to just stay consistent (and make sure you adjust the N by one of many methods). Still, I don&#8217;t think it makes sense to use the absolute total as some of it could just be noise from the sample prep.</p>
<p>You are correct, though. I should definitely clarify. I guess it seems like everyone just says &#8220;the total number&#8221; when I think they mean &#8220;the total number of compatible reads.&#8221; I&#8217;ll ask around and update the post accordingly. The more I think about it though, I am more certain that N should be the total number of compatible reads.</p>
<p>If the input is a BAM file, you could in theory still store unmapped reads in the BAM file. (I think &#8216;samtools view -f 4 file.bam&#8217; will give you the unmapped reads, assuming they are in the file). A lot of the mappers I&#8217;ve seen usually don&#8217;t report these, I imagine just to save disk space.</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=8#respond' onclick='return addComment.moveForm("comment-8", "8", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1 highlander-comment" id="comment-9">
			<article>
				<header class="comment-header">
				  	<figure><img alt='' src='http://2.gravatar.com/avatar/e439a06e31671e4135a696bd4e135f2f?s=40&#038;d=identicon&#038;r=G' class='avatar avatar-40' height='40' width='40' /></figure>				<time><a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-9">May 13, 2014 - 3:42 pm</a></time>

				<cite>brian</cite>			</header>

			
			<p>Great post!  This is worthy of publication and indexing in Pubmed IMHO.</p>

			<div class="reply">
				<a class='comment-reply-link' href='/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/?replytocom=9#respond' onclick='return addComment.moveForm("comment-9", "9", "respond", "36")'>Reply</a>
							</div><!-- .reply -->
			  </article>
		</li><!-- #comment-## -->
</ol>

			
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://haroldpimentel.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																										


												<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="f5fd5ed351" /><input type="hidden" name="_wp_http_referer" value="/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/" />
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest" />

<div class="comment-form-field comment-textarea">
	<label for="comment">Enter your comment here...</label>
	<div id="comment-form-comment"><textarea id="comment" name="comment" title="Enter your comment here..."></textarea></div>
</div>

<div id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=http%3A%2F%2Fharoldpimentel.wordpress.com" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav" />
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value="" /></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text" value="" /></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://s2.wp.com/wp-content/mu-plugins/highlander-comments/images/wplogo.png?m=1391188133g" alt="WordPress.com Logo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" />
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" />
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" />
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" />
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" />
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" />
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="http://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google+ photo" width="25" class="no-grav" />
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="" />
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="" />
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

	
</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6"/> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of follow-up comments via email.</label></p></div>

												<p class="form-submit">
							<input name="submit" type="submit" id="comment-submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='36' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="2b80c27eca" /></p>
<input type="hidden" name="genseq" value="1404299351" />
<p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="114"/></p>					</form>
							</div><!-- #respond -->
			<div style="clear: both"></div>
</section>
<!-- / #comments -->
			<nav class="navigation" role="navigation">
			<div class="nav-previous"></div>
			<div class="nav-next"></div>
		</nav>
		<!-- / .navigation -->
	

	</section>
	<!-- / #content -->


	<aside id="primary" role="complementary">
		<section id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://haroldpimentel.wordpress.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></section>		<section id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/">What the FPKM? A review of RNA-Seq expression&nbsp;units</a>
						</li>
				</ul>
		</section><section id="recent-comments-2" class="widget widget_recent_comments"><h3 class="title">Recent Comments</h3>				<table class="recentcommentsavatar" cellspacing="0" cellpadding="0" border="0">
					<tr><td title="brian" class="recentcommentsavatartop" style="height:48px; width:48px;"><img alt='' src='http://2.gravatar.com/avatar/e439a06e31671e4135a696bd4e135f2f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstexttop" style="">brian on <a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-9">What the FPKM? A review of RNA&hellip;</a></td></tr><tr><td title="haroldpimentel" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://haroldpimentel.wordpress.com" rel="nofollow"><img alt='' src='http://0.gravatar.com/avatar/6b94e7047c18c9c5e664707d46651161?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></a></td><td class="recentcommentstextend" style=""><a href="http://haroldpimentel.wordpress.com" rel="nofollow">haroldpimentel</a> on <a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-8">What the FPKM? A review of RNA&hellip;</a></td></tr><tr><td title="Nicolas Robine" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://twitter.com/notsojunkdna" rel="nofollow"><img alt='' src='http://1.gravatar.com/avatar/7d6da90093c77e5c9b8a741a7ddab317?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></a></td><td class="recentcommentstextend" style=""><a href="http://twitter.com/notsojunkdna" rel="nofollow">Nicolas Robine</a> on <a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-7">What the FPKM? A review of RNA&hellip;</a></td></tr><tr><td title="haroldpimentel" class="recentcommentsavatarend" style="height:48px; width:48px;"><a href="http://haroldpimentel.wordpress.com" rel="nofollow"><img alt='' src='http://0.gravatar.com/avatar/6b94e7047c18c9c5e664707d46651161?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></a></td><td class="recentcommentstextend" style=""><a href="http://haroldpimentel.wordpress.com" rel="nofollow">haroldpimentel</a> on <a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-6">What the FPKM? A review of RNA&hellip;</a></td></tr><tr><td title="Funan Shi" class="recentcommentsavatarend" style="height:48px; width:48px;"><img alt='' src='http://1.gravatar.com/avatar/450d3dae2ef455ab79c664dcec12bc7c?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /></td><td class="recentcommentstextend" style="">Funan Shi on <a href="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/comment-page-1/#comment-5">What the FPKM? A review of RNA&hellip;</a></td></tr>				</table>
				</section><section id="archives-2" class="widget widget_archive"><h3 class="title">Archives</h3>		<ul>
	<li><a href='http://haroldpimentel.wordpress.com/2014/05/'>May 2014</a></li>
		</ul>
</section><section id="categories-2" class="widget widget_categories"><h3 class="title">Categories</h3>		<ul>
	<li class="cat-item cat-item-326701"><a href="http://haroldpimentel.wordpress.com/category/computational-biology/" >Computational biology</a>
</li>
	<li class="cat-item cat-item-480264"><a href="http://haroldpimentel.wordpress.com/category/statistics-2/" >Statistics</a>
</li>
		</ul>
</section><section id="meta-2" class="widget widget_meta"><h3 class="title">Meta</h3>			<ul>
			<li><a href="https://en.wordpress.com/signup/?ref=wplogin">Register</a></li>			<li><a href="https://haroldpimentel.wordpress.com/wp-login.php">Log in</a></li>
			<li><a href="http://haroldpimentel.wordpress.com/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://haroldpimentel.wordpress.com/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="http://wordpress.com/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.com</a></li>			</ul>
</section>	</aside>


		<footer id="footer">
						<nav id="footer-nav" role="navigation">
							</nav>
			<div class="colophon">
				<a href="http://wordpress.com/?ref=footer_website">Create a free website or blog at WordPress.com</a>. |
				<a href="http://theme.wordpress.com/themes/blaskan/" title="Learn more about this theme">The Blaskan Theme</a>.			</div>
		</footer>
		<!-- / #footer -->
	</div>
	<!-- / #wrapper -->
</div>
<!-- / #site -->

<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201427x'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781g'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {
			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-8add580c8c62fa9768247b0f3835c834">
	</div>
	<div class="grofile-hash-map-eb5414f51f8f6f326f0ebc9df970f99f">
	</div>
	<div class="grofile-hash-map-6b94e7047c18c9c5e664707d46651161">
	</div>
	<div class="grofile-hash-map-450d3dae2ef455ab79c664dcec12bc7c">
	</div>
	<div class="grofile-hash-map-7d6da90093c77e5c9b8a741a7ddab317">
	</div>
	<div class="grofile-hash-map-e439a06e31671e4135a696bd4e135f2f">
	</div>
	</div>
<script type='text/javascript'>
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"http:\/\/haroldpimentel.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/haroldpimentel.wordpress.com\/wp-login.php?action=logout&_wpnonce=24b55f5e81","homeURL":"http:\/\/haroldpimentel.wordpress.com\/","postID":"36","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"0"};
/* ]]> */
</script>
<script type='text/javascript' src='http://s1.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1403644162j'></script>

	<div id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id='bsub-text'>Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow &ldquo;The farrago&rdquo;</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

			
			<p><input type="email" name="email" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter email address" : this.value;'  id="loggedout-follow-field"/></p>

			<input type="hidden" name="action" value="subscribe"/>
			<input type="hidden" name="blog_id" value="56609138"/>
			<input type="hidden" name="source" value="http://haroldpimentel.wordpress.com/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/"/>
			<input type="hidden" name="sub-type" value="loggedout-follow"/>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="a5ce9880d0" /><input type="hidden" name="_wp_http_referer" value="/2014/05/08/what-the-fpkm-a-review-rna-seq-expression-units/" />
			<p id='bsub-subscribe-button'><input type="submit" value="Sign me up" /></p>
			</form>
					<div id='bsub-credit'><a href="http://wordpress.com/signup/?ref=lof">Powered by WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->

	<script type="text/javascript">
		WPCOM_sharing_counts = {"http:\/\/haroldpimentel.wordpress.com\/2014\/05\/08\/what-the-fpkm-a-review-rna-seq-expression-units\/":36}	</script>
		<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
				<iframe src='http://widgets.wp.com/likes/master.html?ver=20140528#ver=20140528&amp;mp6=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type="text/javascript">
		//<![CDATA[
			var jetpackLikesWidgetQueue = [];
			var jetpackLikesWidgetBatch = [];
			var jetpackLikesMasterReady = false;

			function JetpackLikespostMessage( message, target ) {
				if ( "string" === typeof message ){
					try{
						message = JSON.parse( message );
					}
					catch(e) {
						return;
					}
				}

				pm( {
					target: target,
					type: 'likesMessage',
					data: message,
					origin: '*'
				} );
			}

			function JetpackLikesBatchHandler() {
				var requests = [];
				jQuery( 'div.jetpack-likes-widget-unloaded' ).each( function( i ) {
					if ( jetpackLikesWidgetBatch.indexOf( this.id ) > -1 )
						return;
					jetpackLikesWidgetBatch.push( this.id );
					var regex = /like-(post|comment)-wrapper-(\d+)-(\d+)-(\w+)/;
					var match = regex.exec( this.id );
					if ( ! match || match.length != 5 )
						return;

					var info = {
						blog_id: match[2],
						width:   this.width
					};

					if ( 'post' == match[1] ) {
						info.post_id = match[3];
					} else if ( 'comment' == match[1] ) {
						info.comment_id = match[3];
					}

					info.obj_id = match[4];

					requests.push( info );
				});

				if ( requests.length > 0 ) {
					JetpackLikespostMessage( { event: 'initialBatch', requests: requests }, window.frames['likes-master'] );
				}
			}

			function JetpackLikesMessageListener( event ) {
				if ( "undefined" == typeof event.event )
					return;

				if ( 'masterReady' == event.event ) {
					jQuery( document ).ready( function() {
						jetpackLikesMasterReady = true;

						var stylesData = {
								event: 'injectStyles'
						};

						if ( jQuery( 'iframe.admin-bar-likes-widget' ).length > 0 ) {
							JetpackLikespostMessage( { event: 'adminBarEnabled' }, window.frames[ 'likes-master' ] );

							stylesData.adminBarStyles = {
								background: jQuery( '#wpadminbar .quicklinks li#wp-admin-bar-wpl-like > a' ).css( 'background' ),
								isRtl: ( 'rtl' == jQuery( '#wpadminbar' ).css( 'direction' ) )
							};
						}

						if ( !window.addEventListener )
							jQuery( '#wp-admin-bar-admin-bar-likes-widget' ).hide();

						stylesData.textStyles = {
							color: jQuery( '.sd-text-color').css( 'color' ),
							fontFamily: jQuery( '.sd-text-color' ).css( 'font-family' ),
							fontSize: jQuery( '.sd-text-color' ).css( 'font-size' ),
							direction: jQuery( '.sd-text-color' ).css( 'direction' ),
							fontWeight: jQuery( '.sd-text-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-text-color' ).css( 'font-style' ),
							textDecoration: jQuery( '.sd-text-color' ).css('text-decoration')
						};

						stylesData.linkStyles = {
							color: jQuery( '.sd-link-color' ).css('color'),
							fontFamily: jQuery( '.sd-link-color' ).css('font-family'),
							fontSize: jQuery( '.sd-link-color' ).css('font-size'),
							textDecoration: jQuery( '.sd-link-color' ).css('text-decoration'),
							fontWeight: jQuery( '.sd-link-color' ).css( 'font-weight' ),
							fontStyle: jQuery( '.sd-link-color' ).css( 'font-style' )
						};

						JetpackLikespostMessage( stylesData, window.frames[ 'likes-master' ] );

						JetpackLikesBatchHandler();

						jQuery( document ).on( 'inview', 'div.jetpack-likes-widget-unloaded', function() {
							jetpackLikesWidgetQueue.push( this.id );
						});
					});
				}

				if ( 'showLikeWidget' == event.event ) {
					jQuery( '#' + event.id + ' .post-likes-widget-placeholder'  ).fadeOut( 'fast', function() {
						jQuery( '#' + event.id + ' .post-likes-widget' ).fadeIn( 'fast', function() {
							JetpackLikespostMessage( { event: 'likeWidgetDisplayed', blog_id: event.blog_id, post_id: event.post_id, obj_id: event.obj_id }, window.frames['likes-master'] );
						});
					});
				}

				if ( 'clickReblogFlair' == event.event ) {
					wpcom_reblog.toggle_reblog_box_flair( event.obj_id );
				}

				if ( 'showOtherGravatars' == event.event ) {
					var $container = jQuery( '#likes-other-gravatars' );
					var $list = $container.find( 'ul' );

					$container.hide();
					$list.html( '' );

					$container.find( '.likes-text span' ).text( event.total );

					jQuery.each( event.likers, function( i, liker ) {
						$list.append( '<li class="' + liker.css_class + '"><a href="' + liker.profile_URL + '" class="wpl-liker" rel="nofollow" target="_parent"><img src="' + liker.avatar_URL + '" alt="' + liker.name + '" width="30" height="30" style="padding-right: 3px;" /></a></li>');
					} );

					var offset = jQuery( "[name='" + event.parent + "']" ).offset();

					$container.css( 'left', offset.left + event.position.left - 10 + 'px' );
					$container.css( 'top', offset.top + event.position.top - 33 + 'px' );

					var rowLength = Math.floor( event.width / 37 );
					var height = ( Math.ceil( event.likers.length / rowLength ) * 37 ) + 13;
					if ( height > 204 ) {
						height = 204;
					}

					$container.css( 'height', height + 'px' );
					$container.css( 'width', rowLength * 37 - 7 + 'px' );

					$list.css( 'width', rowLength * 37 + 'px' );

					$container.fadeIn( 'slow' );

					var scrollbarWidth = $list[0].offsetWidth - $list[0].clientWidth;
					if ( scrollbarWidth > 0 ) {
						$container.width( $container.width() + scrollbarWidth );
						$list.width( $list.width() + scrollbarWidth );
					}
				}
			}

			pm.bind( 'likesMessage', function(e) { JetpackLikesMessageListener(e); } );

			jQuery( document ).click( function( e ) {
				var $container = jQuery( '#likes-other-gravatars' );

				if ( $container.has( e.target ).length === 0 ) {
					$container.fadeOut( 'slow' );
				}
			});

			function JetpackLikesWidgetQueueHandler() {
				var wrapperID;
				if ( ! jetpackLikesMasterReady ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				if ( jetpackLikesWidgetQueue.length > 0 ) {
					// We may have a widget that needs creating now
					var found = false;
					while( jetpackLikesWidgetQueue.length > 0 ) {
						// Grab the first member of the queue that isn't already loading.
						wrapperID = jetpackLikesWidgetQueue.splice( 0, 1 )[0];
						if ( jQuery( '#' + wrapperID ).hasClass( 'jetpack-likes-widget-unloaded' ) ) {
							found = true;
							break;
						}
					}
					if ( ! found ) {
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				} else if ( jQuery( 'div.jetpack-likes-widget-unloaded' ).length > 0 ) {
					// Grab any unloaded widgets for a batch request
					JetpackLikesBatchHandler();

					// Get the next unloaded widget
					wrapperID = jQuery( 'div.jetpack-likes-widget-unloaded' ).first()[0].id;
					if ( ! wrapperID ) {
						// Everything is currently loaded
						setTimeout( JetpackLikesWidgetQueueHandler, 500 );
						return;
					}
				}

				if ( 'undefined' === typeof wrapperID ) {
					setTimeout( JetpackLikesWidgetQueueHandler, 500 );
					return;
				}

				var $wrapper = jQuery( '#' + wrapperID );
				$wrapper.find( 'iframe' ).remove();

				if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='22px' width='68px' frameBorder='0' scrolling='no' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				} else {
					$wrapper.find( '.post-likes-widget-placeholder' ).after( "<iframe class='post-likes-widget jetpack-likes-widget' name='" + $wrapper.data( 'name' ) + "' height='55px' width='100%' frameBorder='0' src='" + $wrapper.data( 'src' ) + "'></iframe>" );
				}

				$wrapper.removeClass( 'jetpack-likes-widget-unloaded' ).addClass( 'jetpack-likes-widget-loading' );

				$wrapper.find( 'iframe' ).load( function( e ) {
					var $iframe = jQuery( e.target );
					$wrapper.removeClass( 'jetpack-likes-widget-loading' ).addClass( 'jetpack-likes-widget-loaded' );

					JetpackLikespostMessage( { event: 'loadLikeWidget', name: $iframe.attr( 'name' ), width: $iframe.width() }, window.frames[ 'likes-master' ] );

					if ( $wrapper.hasClass( 'slim-likes-widget' ) ) {
						$wrapper.find( 'iframe' ).Jetpack( 'resizeable' );
					}
				});
				setTimeout( JetpackLikesWidgetQueueHandler, 250 );
			}
			JetpackLikesWidgetQueueHandler();
		//]]>
		</script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19oowqycgsStEtSCwqqdRNKiotzkgFmeEEYgUBTbHPtTU0tjQ3NzMyNTLMAgBAETvb'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?m=1395343499g&amp;ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414g&amp;ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var recaptcha_options = {"lang":"en"};
/* ]]> */
</script>
<script type='text/javascript' src='http://s0.wp.com/_static/??-eJx9jEEOwiAQRS8kTJsmRhbGoxhCaR1kBsJA1duLC7au/uK99+GVlUtcPVcIAqs/0Pn81kFO0BGyi2318mMuEXVNFZ/jRxPykEZPTeXYdmQB+0QhX9WiJ7j3E9hSoT9+TlLVFi0WkIctyPvYHt3oOi/GmNlM50v4AgRVQGc='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="http://s.stats.wordpress.com/w.js?21" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'56609138','v':'wpcom','tz':'-7','user_id':'0','post':'36','subd':'haroldpimentel'});
ex_go({'crypt':'UE40eW5QN0p8M2Y/RE1oOHBqWkJdYy5wL35xRnR4SVtWLmluVHQrZ3JBRDNRaV9yeU4rX041RXBzU1FiayxfJjYsMDgzbnJVcVJxJW5CRj9vLlMmeXZKQ3ItZWwrbHU0YiVWazlEOUhwXUNCMkl0LFNPKy1ieHxFVFlRVGJrU1UseGc4fEdxZkZkeDZpfjhDU3R4U009bUFZbFdUSXwxSXI0LUdSWVYubU9lVz1iK3xfaHZDeG9LW0VCbXVvVkdDJUNsaUhqLzU/VjdOY0lSeXNlNEFkcUZsVVZMY2RWWjlkY10vdn5mMEw5P2E1SzFXWEEmbz9hVXl5YTRDP2ZHU254OHFlWV80WHFDTVVITzJWc1lnVUdNdGd0QWd5UFE/Q3lCRTJvSWQ/XXRVMHZyeGlhNiZYcD1WPTUwNGZHdXZaLVBxOWJzLDM4cg=='});
addLoadEvent(function(){linktracker_init('56609138',36);});
	</script>
<noscript><img src="http://stats.wordpress.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//stats.wordpress.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>