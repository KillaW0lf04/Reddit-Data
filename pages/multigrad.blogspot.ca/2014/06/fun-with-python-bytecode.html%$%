<!DOCTYPE html>
<html class='v2' dir='ltr' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<script type="text/javascript">(function() { var b=window,f="chrome",g="tick",k="jstiming";(function(){function d(a){this.t={};this.tick=function(a,d,c){var e=void 0!=c?c:(new Date).getTime();this.t[a]=[e,d];if(void 0==c)try{b.console.timeStamp("CSI/"+a)}catch(h){}};this[g]("start",null,a)}var a;b.performance&&(a=b.performance.timing);var n=a?new d(a.responseStart):new d;b.jstiming={Timer:d,load:n};if(a){var c=a.navigationStart,h=a.responseStart;0<c&&h>=c&&(b[k].srt=h-c)}if(a){var e=b[k].load;0<c&&h>=c&&(e[g]("_wtsrt",void 0,c),e[g]("wtsrt_","_wtsrt",h),e[g]("tbsd_","wtsrt_"))}try{a=null,
b[f]&&b[f].csi&&(a=Math.floor(b[f].csi().pageT),e&&0<c&&(e[g]("_tbnd",void 0,b[f].csi().startE),e[g]("tbnd_","_tbnd",c))),null==a&&b.gtbExternal&&(a=b.gtbExternal.pageT()),null==a&&b.external&&(a=b.external.pageT,e&&0<c&&(e[g]("_tbnd",void 0,b.external.startE),e[g]("tbnd_","_tbnd",c))),a&&(b[k].pt=a)}catch(p){}})();b.tickAboveFold=function(d){var a=0;if(d.offsetParent){do a+=d.offsetTop;while(d=d.offsetParent)}d=a;750>=d&&b[k].load[g]("aft")};var l=!1;function m(){l||(l=!0,b[k].load[g]("firstScrollTime"))}b.addEventListener?b.addEventListener("scroll",m,!1):b.attachEvent("onscroll",m);
 })();</script>
<meta content='blogger' name='generator'/>
<link href='http://multigrad.blogspot.ca/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="multigrad - Atom" href="http://multigrad.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="multigrad - RSS" href="http://multigrad.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="multigrad - Atom" href="http://www.blogger.com/feeds/569950264826755092/posts/default" />

<link rel="alternate" type="application/atom+xml" title="multigrad - Atom" href="http://multigrad.blogspot.com/feeds/3996046066174380773/comments/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/1163241896-ieretrofit.js"></script>
<![endif]-->
<link href='http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s1600/dot-analysis.png' rel='image_src'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>multigrad: Fun with Python bytecode</title>
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/static/v1/widgets/1535467126-widget_css_2_bundle.css' />
<link type='text/css' rel='stylesheet' href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=569950264826755092&zx=c287acdf-db3c-46e1-ba85-0f845a6e08bb' />
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Awesome Inc.
Designer: Tina Chen
URL:      tinachen.org
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#ffffff"/>
<Group description="Page" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.background.color" description="Background Color" type="color" default="#000000"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#ffffff"/>
</Group>
<Group description="Links" selector=".main-inner">
<Variable name="link.color" description="Link Color" type="color" default="#888888"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#444444"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#cccccc"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Title Font" type="font"
default="normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#444444" />
<Variable name="header.background.color" description="Header Background" type="color" default="transparent" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="description.text.color" description="Text Color" type="color"
default="#444444" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#444444"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#444444"/>
<Variable name="tabs.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Date Header" selector=".main-inner .widget h2.date-header, .main-inner .widget h2.date-header span">
<Variable name="date.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="date.border.color" description="Border Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, h4, h3.post-title a">
<Variable name="post.title.font" description="Font" type="font"
default="normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="post.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Post Background" selector=".post">
<Variable name="post.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="post.border.color" description="Border Color" type="color" default="#eeeeee" />
<Variable name="post.border.bevel.color" description="Bevel Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadget Title" selector="h2">
<Variable name="widget.title.font" description="Font" type="font"
default="normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Gadget Text" selector=".sidebar .widget">
<Variable name="widget.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.text.color" description="Text Color" type="color" default="#444444"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#666666"/>
</Group>
<Group description="Gadget Links" selector=".sidebar .widget">
<Variable name="widget.link.color" description="Link Color" type="color" default="#1e6dd8"/>
<Variable name="widget.link.visited.color" description="Visited Color" type="color" default="#1e6dd8"/>
<Variable name="widget.link.hover.color" description="Hover Color" type="color" default="#0000ff"/>
</Group>
<Group description="Gadget Background" selector=".sidebar .widget">
<Variable name="widget.background.color" description="Background Color" type="color" default="#141414"/>
<Variable name="widget.border.color" description="Border Color" type="color" default="#222222"/>
<Variable name="widget.border.bevel.color" description="Bevel Color" type="color" default="#000000"/>
</Group>
<Group description="Sidebar Background" selector=".column-left-inner .column-right-inner">
<Variable name="widget.outer.background.color" description="Background Color" type="color" default="transparent" />
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="transparent"/>
<Variable name="image.border.color" description="Border Color" type="color" default="transparent"/>
</Group>
<Group description="Feed" selector=".blog-feeds">
<Variable name="feed.text.color" description="Text Color" type="color" default="#444444"/>
</Group>
<Group description="Feed Links" selector=".blog-feeds">
<Variable name="feed.link.color" description="Link Color" type="color" default="#1e6dd8"/>
<Variable name="feed.link.visited.color" description="Visited Color" type="color" default="#1e6dd8"/>
<Variable name="feed.link.hover.color" description="Hover Color" type="color" default="#0000ff"/>
</Group>
<Group description="Pager" selector=".blog-pager">
<Variable name="pager.background.color" description="Background Color" type="color" default="#ffffff" />
</Group>
<Group description="Footer" selector=".footer-outer">
<Variable name="footer.background.color" description="Background Color" type="color" default="#ffffff" />
<Variable name="footer.text.color" description="Text Color" type="color" default="#444444" />
</Group>
<Variable name="title.shadow.spread" description="Title Shadow" type="length" default="-1px"/>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee"
default="$(color) none repeat scroll top left"/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="none"/>
<Variable name="body.background.size" description="Body Background Size" type="string" default="auto"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="none"/>
<Variable name="header.background.gradient" description="Header Background Gradient" type="url" default="none" />
<Variable name="header.padding.top" description="Header Top Padding" type="length" default="22px" />
<Variable name="header.margin.top" description="Header Top Margin" type="length" default="0" />
<Variable name="header.margin.bottom" description="Header Bottom Margin" type="length" default="0" />
<Variable name="widget.padding.top" description="Widget Padding Top" type="length" default="8px" />
<Variable name="widget.padding.side" description="Widget Padding Side" type="length" default="15px" />
<Variable name="widget.outer.margin.top" description="Widget Top Margin" type="length" default="0" />
<Variable name="widget.outer.background.gradient" description="Gradient" type="url" default="none" />
<Variable name="widget.border.radius" description="Gadget Border Radius" type="length" default="0" />
<Variable name="outer.shadow.spread" description="Outer Shadow Size" type="length" default="0" />
<Variable name="date.header.border.radius.top" description="Date Header Border Radius Top" type="length" default="0" />
<Variable name="date.header.position" description="Date Header Position" type="length" default="15px" />
<Variable name="date.space" description="Date Space" type="length" default="30px" />
<Variable name="date.position" description="Date Float" type="string" default="static" />
<Variable name="date.padding.bottom" description="Date Padding Bottom" type="length" default="0" />
<Variable name="date.border.size" description="Date Border Size" type="length" default="0" />
<Variable name="date.background" description="Date Background" type="background" color="transparent"
default="$(color) none no-repeat scroll top left" />
<Variable name="date.first.border.radius.top" description="Date First top radius" type="length" default="0" />
<Variable name="date.last.space.bottom" description="Date Last Space Bottom" type="length"
default="20px" />
<Variable name="date.last.border.radius.bottom" description="Date Last bottom radius" type="length" default="0" />
<Variable name="post.first.padding.top" description="First Post Padding Top" type="length" default="0" />
<Variable name="image.shadow.spread" description="Image Shadow Size" type="length" default="0"/>
<Variable name="image.border.radius" description="Image Border Radius" type="length" default="0"/>
<Variable name="separator.outdent" description="Separator Outdent" type="length" default="15px" />
<Variable name="title.separator.border.size" description="Widget Title Border Size" type="length" default="1px" />
<Variable name="list.separator.border.size" description="List Separator Border Size" type="length" default="1px" />
<Variable name="shadow.spread" description="Shadow Size" type="length" default="0"/>
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
<Variable name="date.side" description="Side where date header is placed" type="string" default="right"/>
<Variable name="pager.border.radius.top" description="Pager Border Top Radius" type="length" default="0" />
<Variable name="pager.space.top" description="Pager Top Space" type="length" default="1em" />
<Variable name="footer.background.gradient" description="Background Gradient" type="url" default="none" />
<Variable name="mobile.background.size" description="Mobile Background Size" type="string"
default="auto"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: #eeeeee none repeat scroll top left;
}
html body .content-outer {
min-width: 0;
max-width: 100%;
width: 100%;
}
a:link {
text-decoration: none;
color: #1e6dd8;
}
a:visited {
text-decoration: none;
color: #1e6dd8;
}
a:hover {
text-decoration: underline;
color: #0000ff;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 276px;
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
/* Columns
----------------------------------------------- */
.content-inner {
padding: 0;
}
.header-inner .section {
margin: 0 16px;
}
.tabs-inner .section {
margin: 0 16px;
}
.main-inner {
padding-top: 30px;
}
.main-inner .column-center-inner,
.main-inner .column-left-inner,
.main-inner .column-right-inner {
padding: 0 5px;
}
*+html body .main-inner .column-center-inner {
margin-top: -30px;
}
#layout .main-inner .column-center-inner {
margin-top: 0;
}
/* Header
----------------------------------------------- */
.header-outer {
margin: 0 0 0 0;
background: transparent none repeat scroll 0 0;
}
.Header h1 {
font: normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
text-shadow: 0 0 -1px #000000;
}
.Header h1 a {
color: #444444;
}
.Header .description {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.header-inner .Header .titlewrapper,
.header-inner .Header .descriptionwrapper {
padding-left: 0;
padding-right: 0;
margin-bottom: 0;
}
.header-inner .Header .titlewrapper {
padding-top: 22px;
}
/* Tabs
----------------------------------------------- */
.tabs-outer {
overflow: hidden;
position: relative;
background: #eeeeee url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
#layout .tabs-outer {
overflow: visible;
}
.tabs-cap-top, .tabs-cap-bottom {
position: absolute;
width: 100%;
border-top: 1px solid #999999;
}
.tabs-cap-bottom {
bottom: 0;
}
.tabs-inner .widget li a {
display: inline-block;
margin: 0;
padding: .6em 1.5em;
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
border-left: 1px solid #999999;
height: 16px;
line-height: 16px;
}
.tabs-inner .widget li:last-child a {
border-right: 1px solid #999999;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
background: #666666 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat-x scroll 0 -100px;
color: #ffffff;
}
/* Headings
----------------------------------------------- */
h2 {
font: normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
/* Widgets
----------------------------------------------- */
.main-inner .section {
margin: 0 27px;
padding: 0;
}
.main-inner .column-left-outer,
.main-inner .column-right-outer {
margin-top: 0;
}
#layout .main-inner .column-left-outer,
#layout .main-inner .column-right-outer {
margin-top: 0;
}
.main-inner .column-left-inner,
.main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
#layout .main-inner .column-left-inner,
#layout .main-inner .column-right-inner {
margin-top: 0;
}
.sidebar .widget {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
.sidebar .widget a:link {
color: #3778cd;
}
.sidebar .widget a:visited {
color: #4d469c;
}
.sidebar .widget a:hover {
color: #3778cd;
}
.sidebar .widget h2 {
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget {
background-color: #ffffff;
border: 1px solid #eeeeee;
padding: 0 15px 15px;
margin: 20px -16px;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.main-inner .widget h2 {
margin: 0 -15px;
padding: .6em 15px .5em;
border-bottom: 1px solid transparent;
}
.footer-inner .widget h2 {
padding: 0 0 .4em;
border-bottom: 1px solid transparent;
}
.main-inner .widget h2 + div, .footer-inner .widget h2 + div {
border-top: 1px solid #eeeeee;
padding-top: 8px;
}
.main-inner .widget .widget-content {
margin: 0 -15px;
padding: 7px 15px 0;
}
.main-inner .widget ul, .main-inner .widget #ArchiveList ul.flat {
margin: -8px -15px 0;
padding: 0;
list-style: none;
}
.main-inner .widget #ArchiveList {
margin: -8px 0 0;
}
.main-inner .widget ul li, .main-inner .widget #ArchiveList ul.flat li {
padding: .5em 15px;
text-indent: 0;
color: #666666;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid transparent;
}
.main-inner .widget #ArchiveList ul li {
padding-top: .25em;
padding-bottom: .25em;
}
.main-inner .widget ul li:first-child, .main-inner .widget #ArchiveList ul.flat li:first-child {
border-top: none;
}
.main-inner .widget ul li:last-child, .main-inner .widget #ArchiveList ul.flat li:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.main-inner .widget .post-body ul {
padding: 0 2.5em;
margin: .5em 0;
list-style: disc;
}
.main-inner .widget .post-body ul li {
padding: 0.25em 0;
margin-bottom: .25em;
color: #444444;
border: none;
}
.footer-inner .widget ul {
padding: 0;
list-style: none;
}
.widget .zippy {
color: #666666;
}
/* Posts
----------------------------------------------- */
body .main-inner .Blog {
padding: 0;
margin-bottom: 1em;
background-color: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
-goog-ms-box-shadow: 0 0 0 rgba(0, 0, 0, 0);
box-shadow: 0 0 0 rgba(0, 0, 0, 0);
}
.main-inner .section:last-child .Blog:last-child {
padding: 0;
margin-bottom: 1em;
}
.main-inner .widget h2.date-header {
margin: 0 -15px 1px;
padding: 0 0 0 0;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
background: transparent none no-repeat scroll top left;
border-top: 0 solid #eeeeee;
border-bottom: 1px solid transparent;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
position: static;
bottom: 100%;
right: 15px;
text-shadow: 0 0 -1px #000000;
}
.main-inner .widget h2.date-header span {
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
display: block;
padding: .5em 15px;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.date-outer {
position: relative;
margin: 30px 0 20px;
padding: 0 15px;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
}
.date-outer:first-child {
margin-top: 0;
}
.date-outer:last-child {
margin-bottom: 20px;
-moz-border-radius-bottomleft: 0;
-moz-border-radius-bottomright: 0;
-webkit-border-bottom-left-radius: 0;
-webkit-border-bottom-right-radius: 0;
-goog-ms-border-bottom-left-radius: 0;
-goog-ms-border-bottom-right-radius: 0;
border-bottom-left-radius: 0;
border-bottom-right-radius: 0;
}
.date-posts {
margin: 0 -15px;
padding: 0 15px;
clear: both;
}
.post-outer, .inline-ad {
border-top: 1px solid #eeeeee;
margin: 0 -15px;
padding: 15px 15px;
}
.post-outer {
padding-bottom: 10px;
}
.post-outer:first-child {
padding-top: 0;
border-top: none;
}
.post-outer:last-child, .inline-ad:last-child {
border-bottom: none;
}
.post-body {
position: relative;
}
.post-body img {
padding: 8px;
background: transparent;
border: 1px solid transparent;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .2);
box-shadow: 0 0 0 rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
border-radius: 0;
}
h3.post-title, h4 {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a {
font: normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #444444;
}
h3.post-title a:hover {
color: #0000ff;
text-decoration: underline;
}
.post-header {
margin: 0 0 1em;
}
.post-body {
line-height: 1.4;
}
.post-outer h2 {
color: #444444;
}
.post-footer {
margin: 1.5em 0 0;
}
#blog-pager {
padding: 15px;
font-size: 120%;
background-color: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-moz-border-radius: 0;
-webkit-border-radius: 0;
-goog-ms-border-radius: 0;
border-radius: 0;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius-topright: 0;
margin-top: 1em;
}
.blog-feeds, .post-feeds {
margin: 1em 0;
text-align: center;
color: #444444;
}
.blog-feeds a, .post-feeds a {
color: #3778cd;
}
.blog-feeds a:visited, .post-feeds a:visited {
color: #4d469c;
}
.blog-feeds a:hover, .post-feeds a:hover {
color: #3778cd;
}
.post-outer .comments {
margin-top: 2em;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Footer
----------------------------------------------- */
.footer-outer {
margin: -20px 0 -1px;
padding: 20px 0 0;
color: #444444;
overflow: hidden;
}
.footer-fauxborder-left {
border-top: 1px solid #eeeeee;
background: #ffffff none repeat scroll 0 0;
-moz-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-webkit-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
-goog-ms-box-shadow: 0 0 20px rgba(0, 0, 0, .2);
box-shadow: 0 0 20px rgba(0, 0, 0, .2);
margin: 0 -20px;
}
/* Mobile
----------------------------------------------- */
body.mobile {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
*+html body.mobile .main-inner .column-center-inner {
margin-top: 0;
}
.mobile .main-inner .widget {
padding: 0 0 15px;
}
.mobile .main-inner .widget h2 + div,
.mobile .footer-inner .widget h2 + div {
border-top: none;
padding-top: 0;
}
.mobile .footer-inner .widget h2 {
padding: 0.5em 0;
border-bottom: none;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile .main-inner .widget ul,
.mobile .main-inner .widget #ArchiveList ul.flat {
margin: 0 -15px 0;
}
.mobile .main-inner .widget h2.date-header {
right: 0;
}
.mobile .date-header span {
padding: 0.4em 0;
}
.mobile .date-outer:first-child {
margin-bottom: 0;
border: 1px solid #eeeeee;
-moz-border-radius-topleft: 0;
-moz-border-radius-topright: 0;
-webkit-border-top-left-radius: 0;
-webkit-border-top-right-radius: 0;
-goog-ms-border-top-left-radius: 0;
-goog-ms-border-top-right-radius: 0;
border-top-left-radius: 0;
border-top-right-radius: 0;
}
.mobile .date-outer {
border-color: #eeeeee;
border-width: 0 1px 1px;
}
.mobile .date-outer:last-child {
margin-bottom: 0;
}
.mobile .main-inner {
padding: 0;
}
.mobile .header-inner .section {
margin: 0;
}
.mobile .post-outer, .mobile .inline-ad {
padding: 5px 0;
}
.mobile .tabs-inner .section {
margin: 0 10px;
}
.mobile .main-inner .widget h2 {
margin: 0;
padding: 0;
}
.mobile .main-inner .widget h2.date-header span {
padding: 0;
}
.mobile .main-inner .widget .widget-content {
margin: 0;
padding: 7px 0 0;
}
.mobile #blog-pager {
border: 1px solid transparent;
background: #ffffff none repeat scroll 0 0;
}
.mobile .main-inner .column-left-inner,
.mobile .main-inner .column-right-inner {
background: transparent none repeat 0 0;
-moz-box-shadow: none;
-webkit-box-shadow: none;
-goog-ms-box-shadow: none;
box-shadow: none;
}
.mobile .date-posts {
margin: 0;
padding: 0;
}
.mobile .footer-fauxborder-left {
margin: 0;
border-top: inherit;
}
.mobile .main-inner .section:last-child .Blog:last-child {
margin-bottom: 0;
}
.mobile-index-contents {
color: #444444;
}
.mobile .mobile-link-button {
background: #1e6dd8 url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png) repeat scroll 0 0;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .PageList .widget-content {
background: transparent;
border-top: 1px solid;
border-color: #999999;
color: #444444;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #999999;
}
h3, h4 {
margin-top: 1em;
}
--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1040px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1040px;
max-width: 1040px;
_width: 1040px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 280px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 280px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("280px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 280px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 280px;
margin-right: -280px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
--></style>
<script type='text/javascript'>
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38489735-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = (document.location.protocol == 'https:' ?
                  'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();
    </script>
<script src='//code.jquery.com/jquery-1.11.0.min.js'></script>
<script type="text/javascript">var a="indexOf",b="&m=1",e="(^|&)m=",f="?",g="?m=1";function h(){var c=window.location.href,d=c.split(f);switch(d.length){case 1:return c+g;case 2:return 0<=d[1].search(e)?null:c+b;default:return null}}var k=navigator.userAgent;if(-1!=k[a]("Mobile")&&-1!=k[a]("WebKit")&&-1==k[a]("iPad")||-1!=k[a]("Opera Mini")||-1!=k[a]("IEMobile")){var l=h();l&&window.location.replace(l)};
</script><script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('headEnd');
</script></head>
<body class='loading variant-light'>
<div class='navbar section' id='navbar'><div class='widget Navbar' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
        gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
          if (gapi.iframes && gapi.iframes.getContext) {
            gapi.iframes.getContext().openChild({
                url: 'https://www.blogger.com/navbar.g?targetBlogID\075569950264826755092\46blogName\75multigrad\46publishMode\75PUBLISH_MODE_BLOGSPOT\46navbarType\75LIGHT\46layoutType\75LAYOUTS\46searchRoot\75http://multigrad.blogspot.com/search\46blogLocale\75en\46v\0752\46homepageUrl\75http://multigrad.blogspot.com/\46targetPostID\0753996046066174380773\46blogPostOrPageUrl\75http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html\46blogFollowUrl\75https://plus.google.com/106172985094854571984\46vt\0757873516591992359096',
                where: document.getElementById("navbar-iframe-container"),
                id: "navbar-iframe"
            });
          }
        });
      </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div><div class='widget Navbar' id='Navbar2'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type="text/javascript">
        gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
          if (gapi.iframes && gapi.iframes.getContext) {
            gapi.iframes.getContext().openChild({
                url: 'https://www.blogger.com/navbar.g?targetBlogID\075569950264826755092\46blogName\75multigrad\46publishMode\75PUBLISH_MODE_BLOGSPOT\46navbarType\75LIGHT\46layoutType\75LAYOUTS\46searchRoot\75http://multigrad.blogspot.com/search\46blogLocale\75en\46v\0752\46homepageUrl\75http://multigrad.blogspot.com/\46targetPostID\0753996046066174380773\46blogPostOrPageUrl\75http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html\46blogFollowUrl\75https://plus.google.com/106172985094854571984\46vt\0757873516591992359096',
                where: document.getElementById("navbar-iframe-container"),
                id: "navbar-iframe"
            });
          }
        });
      </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header'><div class='widget Header' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='http://multigrad.blogspot.ca/'>multigrad</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs section' id='crosscol'></div>
<div class='tabs section' id='crosscol-overflow'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main'><div class='widget Blog' id='Blog1'>
<div class='blog-posts hfeed'>
<!-- google_ad_section_start(name=default) -->

          <div class="date-outer">
        
<h2 class='date-header'><span>June 8, 2014</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s1600/dot-analysis.png' itemprop='image_url'/>
<meta content='569950264826755092' itemprop='blogId'/>
<meta content='3996046066174380773' itemprop='postId'/>
<a name='3996046066174380773'></a>
<h3 class='post-title entry-title' itemprop='name'>
Fun with Python bytecode
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-3996046066174380773' itemprop='description articleBody'>
<div align="justify">
The Python programming language is now present
everywhere. While significantly slower than other more low-level
languages like C/C++, its ease of use, its power and its various
libraries make it an ideal choice for many projects. Yet for some
cases, performance does matter. For these, many solutions have been
proposed. One of the most common is the use of an underlying,
heavily-optimized, C library along with Python bindings (numpy,
scipy, opencv, etc.). Another is the addition of performance related
features to the interpreter, like JIT or stackless mode with Pypy.
However, what to do when you can't apply neither of them, yet you
still want more performance without sacrificing the Python zen and
simplicity?</div>
<div align="justify">
<br />
One of the answers, at least in the present case,
is to roll up our sleeves, fasten our seat belts, and dive into the
mysteries of the Python bytecode.<br />
<h3>
Wait, what?</h3>
<div align="JUSTIFY">
You have probably already heard that Python, unlike
Fortran, C++ or Go, was an <i>interpreted </i><span style="font-style: normal;">language.
While not completely wrong, it is not entirely true either. You </span><i>could</i><span style="font-style: normal;">
create a Python interpreter that works in a purely interpreted way,
but it is not how it is done in most current Python implementations.
The Python code is first </span><i>compiled </i><span style="font-style: normal;">into
a series of simpler instructions. Thereafter, </span><i>these</i><span style="font-style: normal;">
instructions are actually interpreted by a virtual machine. The main
reason for that design choice is speed: directly interpreting
high-level Python code each time it is executed (think for instance
of a loop or a function executed many times) would be ineffective.
Moreover, some different Python syntax turn out to give the same
result. For instance, using a </span><i>if/elif</i><span style="font-style: normal;">
statement produces </span><i>exactly </i><span style="font-style: normal;">the
same result than a </span><i>if</i><span style="font-style: normal;">
inside the </span><i>else </i><span style="font-style: normal;">clause
of another condition. A list comprehension has the same behavior than
a traditional loop &#8211; except for some underlying details in the
current implementations, but it </span><i>could</i><span style="font-style: normal;">
be exactly the same thing. The use of a simplified, intermediate
language allows the actual interpreter to be simpler, easier to
understand and maintain, and faster, while being entirely hidden to
the user in most cases. With CPython, the most visible effect is the
creation of </span><i>*.pyc</i><span style="font-style: normal;">
files, used to store the bytecode in order to avoid a recompilation
step each time the file is executed.</span></div>
<div align="JUSTIFY">
<br />
It is to be noted that this design is not
Python-specific, since many other prominent languages use it too
(Java, Ruby, etc.). All the designs are more or less identical, the
steps involved being a) the parsing of the high-level language into
an intermediate, simpler representation, and b) the interpretation of
this intermediate representation to actually run the program. One
could note that Python makes use of a fancier design, by
translating the Python code into Abstract Syntax Tree or AST before
create the bytecode, but it is out of the scope of this post.
However, those interested by the CPython internals could refer to the
<a href="https://docs.python.org/devguide/compiler.html">Cpython compiler developers information</a>.<br />
<br /></div>
<div align="JUSTIFY">
In Cpython 3.4 (the reference interpreter), the
bytecode is based on a stack representation, and 101 different
<i>opcodes</i>. Python 2.7 uses 18 more, mainly for slicing
operations, which where separated from the item-based operations, and
<i>print</i> and <i>exec</i> statements, which became functions in
Python 3. For the rest of this post, we will use CPython 3.4. While
the explanations provided here also mostly apply to other versions
and interpreters, they may not be totally accurate.<br />
<br />
Let's take a look at an actual bytecode snippet.
Suppose you have the following simple function :</div>
<div class="gistLoad" data-id="eb58151a91ae789d4ef4" id="gist-eb58151a91ae789d4ef4">
Loading... Please enable Javascript</div>
<div align="JUSTIFY">
We could observe the bytecode generated by Python by
using the __code__ attribute :</div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">In
[9]: myMathOperator.__code__.co_code </span>
</div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">Out[9]:
b'|\x00\x00|\x01\x00|\x02\x00\x17d\x01\x00\x13\x14S'</span></div>
<div align="JUSTIFY">
<br />
Ok... <span style="font-style: normal;">While
expected (since the bytecode is basically a sequence of bytes), the
result is not exactly </span><i>readable</i><span style="font-style: normal;">.
Fortunately, there is a helper module in the Python library which can
render a bit more understandable code. This module is named </span><i>dis</i><span style="font-style: normal;">,
for disassembly. Let's see what it can do :</span></div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">In [12]: import dis </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">In [13]:
print(dis.Bytecode(myMathOperator.__code__).dis()) </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">2          0 LOAD_FAST             
  0 (a) </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">3 LOAD_FAST            
   1 (b) </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">6 LOAD_FAST            
   2 (c) </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">9 BINARY_ADD </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">10 LOAD_CONST           
1 (2) </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">13 BINARY_POWER </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">14 BINARY_MULTIPLY </span>
</div>
<div align="JUSTIFY" style="font-style: normal; line-height: 100%; margin-bottom: 0cm; margin-left: 1.25cm;">
<span style="font-family: Courier, monospace;">15 RETURN_VALUE</span></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">Well, that's
definitely better! The dis module is able to translate the bytecode
into its opcodes and their arguments, which are far more readable.
However, to find what does a bytecode do, we must place ourselves in
a </span><i>stack</i><span style="font-style: normal;"> context. Most
opcodes modify the stack by either adding or removing elements (or
both), or by changing the value of the top of stack pointer. For
instance, </span><i>LOAD_FAST</i><span style="font-style: normal;"> is
described as:</span></div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<i><b>Pushes a reference to
the local co_varnames[var_num] onto the stack.</b></i></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">For now, we can
forget the reference to co_varnames (we will talk about it later on),
and just retain that this opcode fetches a variable and put it onto
the stack. In our example, the stack is initially empty since it is
the beginning of the function (we will represent it as [ ]).
Supposing that the values of a, b, and c arguments are respectively
</span><i>12</i><span style="font-style: normal;">, </span><i>7</i><span style="font-style: normal;">
and </span><i>1</i><span style="font-style: normal;">, then the stack
will contain [12, 7, 1] after the first three statements execution.</span></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">On the next line,
we reach a new opcode, </span><i>BINARY_ADD</i><span style="font-style: normal;">.
In the documentation, it is said that it:</span></div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<i><b>Implements TOS = TOS1
+ TOS</b></i></div>
<div align="JUSTIFY" style="font-style: normal;">
<br />
Ok, that's a bit less
clear. Here, TOS means &#8220;Top Of the Stack&#8221;. So, basically, it
takes the value at the top of the stack and the second value at the
top (TOS1), add them, and push back the result of the top of the
stack. Applying this operation to our [12, 7, 1] stack, we obtain
[12, 8].</div>
<div align="JUSTIFY">
<br />
Moving on to the next opcode, we find a <i>LOAD_CONST</i><span style="font-style: normal;">.
Basically, it does the same job as </span><i>LOAD_FAST</i><span style="font-style: normal;">,
except that it loads constants and not variables (in our case, the
constant loaded is the 2 used as exponent). So our stack now contains
[12, 8, 2].</span></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">The next opcode,
</span><i>BINARY_POWER</i><span style="font-style: normal;"> does,
according to the documentation:</span></div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<i><b>TOS = TOS1 ** TOS</b></i></div>
<div align="JUSTIFY" style="font-style: normal;">
<br />
As for the addition, we
take the two top-most items, exponent the second by the first, and
push back the result on the stack, which now contains [12, 64].</div>
<div align="JUSTIFY" style="font-style: normal;">
<br />
The next opcode is
<i>BINARY_MULTIPLY</i>, which works similarly than  <i>BINARY_POWER</i>
and  <i>BINARY_ADD</i>, and our stack now contains the product of 12
and 64, that is [768]. Finally, the <i>RETURN_VALUE</i> operation is
said to:</div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<i><b>Returns with TOS to
the caller of the function.</b></i></div>
<br />
That is, it pops the value on the top of the stack, and return it
to the calling function. In our case, the answer (768) is effectively
returned, and we're done for this example.<br />
<div align="JUSTIFY">
There are of course many other opcodes, but their
behavior is essentially the same, popping and pushing values and
references on a global stack. As one can see, interpreting (and even
writing) Python bytecode is fairly simple when we get the twist.</div>
<div align="JUSTIFY">
<br />
A last twist before the next step: some opcodes need
arguments. This is the case for <i>LOAD_FAST</i><span style="font-style: normal;">,
which needs the index of the variable to grab. This is achieved very
simply, by using up to three bytes for each operation. The first byte
is the opcode itself, and the two remaining can be used for parameter
passing. If there is no parameter to pass (like </span><i>BINARY_ADD</i><span style="font-style: normal;">),
then only one byte is used. The attentive reader would have noticed
the curious indexes in the bytecode snippet above: they precisely
mark the byte index of each opcode.</span></div>
<br />
Great, so we are now ready! Let's write bytecode instead of Python
code!<br />
<h3>
Wait, why?</h3>
<div align="JUSTIFY">
At this point, a reasonable mind might say: why in
the world would you bother to write bytecode, a limited and difficult
language, instead of actual Python code? Well, because the
compilation procedure is too slow and induces a significant overhead!
To this answer, the same reasonable mind would probably say: who
cares about the compilation time? It is not so slow (a few tenths of
seconds in most cases), and, even if it was not, this must be done
only once &#8211; since the next times, you can just reload the *.pyc and
go happily!</div>
<div align="JUSTIFY">
<br />
In most cases, the clever guy would be right. But
there's a specific use which has to be taken into account. Its name
is GP, standing for <i>Genetic Programming</i><span style="font-style: normal;">.</span></div>
<div align="JUSTIFY">
<br />
Genetic programming is an hyper-heuristics member of
the bigger family of the <i>evolutionary algorithms</i>. Basically,
it uses natural selection, mutations and other evolutionary concepts
to <i>evolve</i><span style="font-style: normal;"> trees (in the
computer sense). As any program can be represented as a tree, genetic
programming is actually able to evolve </span><i>programs</i><span style="font-style: normal;">,
that is learn, alone, the best algorithm for a given problem, like
getting out of a labyrinth, solving the Rubik Cube, etc. We do not
intend to dive into deeper explanations on GP, but the interested
reader could find introductory and advanced material about it at&nbsp;</span><a href="http://www.gp-field-guide.org.uk/">www.gp-field-guide.org.uk</a>.</div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">As a DEAP
contributor and user, I frequently have to work with GP and its DEAP
implementation (<a href="http://github.com/deap/deap">DEAP</a> is a generic evolutionary algorithms framework
in Python, which implements GP among others). Here, the compilation
time becomes a problem. GP uses a </span><i>population</i><span style="font-style: normal;">
of several hundreds, and even thousands of different programs. This
is mandatory to keep a sufficient level of diversity. But in order to
see the results produced by each of these programs, we must execute
them, and, as they change during the evolution, we have to compile
them each time. Consider the next figure, produced with </span><i>gprof2dot</i><span style="font-style: normal;">
and the Python </span><i>profile</i><span style="font-style: normal;">
module, which represents the execution of a typical evolution with
DEAP. One can see that the compilation time represented by the
gp.compile function, in light green, takes almost 50% of the </span><i>total</i><span style="font-style: normal;">
computation time. In other words, we spend half our computational
effort just to compile the programs!</span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s1600/dot-analysis.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s1600/dot-analysis.png" height="480" width="640" /></a></div>
<br />
<div align="JUSTIFY">
A few solution have been proposed to address the
problem. The compilation of the individuals with LLVM, as shown <a href="http://pyevolve.sourceforge.net/wordpress/?p=2353">here</a>, is one of them.
Since it compiles to bare x86 bytecode, it indeed reduces the
execution time, but at the price of an increase in compilation time,
the penalty being more severe if we also add compiler optimizations.
Also, the use of an optimized Python interpreter like Pypy is not of
great help with GP &#8211; it actually <i>decreases </i><span style="font-style: normal;">performance
by a factor 2. Shortly, this can be explained by the JIT design
itself: just-in-time compilers are efficient with long loop and
repetitive code segments, since the whole idea is to make up for the
compilation time by an important speedup in upcoming executions of
the same code. With GP, the code is constantly changing, so the JIT
either does nothing (because it detects that it would not be of any
use) or deteriorate the processing time by trying to compile every
individual at each evaluation. Finally, the use of an heavily
optimized C implementation of the basic functions used in the GP
program is not helpful, since Python still have to compile the high
level code </span><i>before</i><span style="font-style: normal;">
calling this C implementation!</span></div>
<div align="JUSTIFY">
<br />
That's where our bytecode hobby comes on stage. What
if we directly evolve Python bytecode? Well (spoiler alert), the
results obtained with a preliminary implementation are given in the
next figure. It should be noted that we use the exact same problem,
configuration, and random seed for our standard and optimized
implementations. The results are impressive: the compile time is now
negligible (less than 1% of the total execution time), and the
computation time is divided by more than two (47 seconds vs. 107 for
the standard implementation), without altering the results in any
way! It should be noted that this is the maximum speedup achievable,
since the standard compilation procedure took about half of the
program execution time. The small additional edge is a side effect
caused by more effective implementations of other compile related
methods<span style="font-style: normal;">.</span></div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-O8KDFN4VD6A/U5J_mzRQz7I/AAAAAAAABYo/NUjFzA0wMcM/s1600/dot-optim.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-O8KDFN4VD6A/U5J_mzRQz7I/AAAAAAAABYo/NUjFzA0wMcM/s1600/dot-optim.png" height="570" width="640" /></a></div>
<br />
Ok, great, so that was easy! Another problem solved!<br />
<h3>
Wait, how?</h3>
<div align="JUSTIFY">
In order to understand the intricacies of the
solution, we have to learn a bit about how GP is implemented in DEAP.
As we said earlier, GP works by evolving <i>trees</i><span style="font-style: normal;">.
Since there's no tree  implementation in the Python standard library,
DEAP includes one specifically targeted on GP. It works by storing the
trees into an underlying list, along with information about how many
children each node have. For instance, the mathematical function </span><i>f(x)
= (x-1) + x*x</i><span style="font-style: normal;"> can be represented
by the following tree:</span><br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-k8f8E9mIaJQ/U5J_uuNVITI/AAAAAAAABYw/WJA9xYq5rts/s1600/tree-example.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-k8f8E9mIaJQ/U5J_uuNVITI/AAAAAAAABYw/WJA9xYq5rts/s1600/tree-example.png" height="199" width="320" /></a></div>
<span style="font-style: normal;"><br /></span></div>
<div align="CENTER" style="font-style: normal;">
</div>
<div align="JUSTIFY" style="font-style: normal;">
and will be stored in the
following list:</div>
<div align="JUSTIFY" style="font-style: normal;">
<div style="text-align: center;">
<span style="font-family: Courier New, Courier, monospace;"><b>['add', 'subtract', 'x',
1, 'multiply', 'x', 'x']</b></span></div>
</div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">Because DEAP knows
the number of arguments of each function (or, in genetic programming
gibberish, their </span><i>arity</i><span style="font-style: normal;">),
it can reconstitute the tree. Thereafter, when comes the evaluation
step, the following procedure is used:</span></div>
<ol>
<li><div align="JUSTIFY">
<span style="font-style: normal;">The tree is
 converted into its string representation. Basically, it is the
 program that one would write if he wanted to produce the result of
 the tree. For instance, the string representation of the previous
 tree wou</span>ld be <i>add( subtract(x, 1), multiply(x, x) )</i>.</div>
</li>
<li><div align="JUSTIFY">
<span style="font-style: normal;">This string is
 passed to </span><i>eval()</i><span style="font-style: normal;">.
 This function is a powerful (and dangerous!) tool which allows to
 execute arbitrary code from its string representation. For instance,
 the following code would write &#8220;Hello world!&#8221; to the standard
 output:</span></div>
<div align="JUSTIFY">
<blockquote class="tr_bq">
<i><span style="background-color: white; font-family: Courier New, Courier, monospace;">eval('print(&#8220;Hello
 world!&#8221;)')</span></i></blockquote>
</div>
<div align="JUSTIFY" style="font-style: normal;">
It is in this step that
 the Python code is actually compiled into its executable form.</div>
</li>
<li><div align="JUSTIFY" style="font-style: normal;">
The compiled
 function is returned, so it can be evaluated.</div>
</li>
</ol>
<div align="JUSTIFY" style="font-style: normal;">
The reader would have
understood that the last step is mandatory and cannot be suppressed,
which is why we focus on the first two steps with our bytecode hack.</div>
<div align="JUSTIFY">
<br /></div>
<div align="JUSTIFY">
<span style="font-style: normal;">First, one useful
simplification: the resulting program is merely only a sequence of
calls to different functions. We never actually have to understand
what is going </span><i>inside</i><span style="font-style: normal;">
these functions. This leads to the fact that our implementation does
not restrain at all the function choice. If it works in Python, it
will work with our approach! Also, this reduce our solution
complexity, since we only have to call a few opcodes. Basically, we
will need the following:</span></div>
<ul>
<li><div align="JUSTIFY">
<i>LOAD_FAST</i><span style="font-style: normal;">
 : this will be needed to access to our program arguments.</span></div>
</li>
<li><div align="JUSTIFY">
<i>LOAD_CONST</i><span style="font-style: normal;">
 : similarly, this opcode is required to use constant values
 (numerical or not).</span></div>
</li>
<li><div align="JUSTIFY">
<i>LOAD_GLOBAL</i><span style="font-style: normal;">
 : this one will be used to retrieve references to the function
 objects of our tree. As its name suggests, instead of grabbing a
 symbol from the local dictionary like </span><i>LOAD_FAST</i><span style="font-style: normal;">,
 it uses the global dictionary.</span></div>
</li>
<li><div align="JUSTIFY">
<i>CALL_FUNCTION</i><span style="font-style: normal;">
 : obviously, this is mandatory to actually call the functions
 previously loaded. It takes as parameter the number of arguments to
 pass to the function. All these arguments must be on the stack at
 the moment of the call, plus, under them, a reference to the
 function object itself. This particular structure will prove to be
 very useful hereinafter.</span></div>
</li>
<li><div align="JUSTIFY">
<i>RETURN_VALUE</i><span style="font-style: normal;">
 : this one will actually be needed only one time, to return the
 final result value.</span></div>
</li>
</ul>
<div align="JUSTIFY">
<span style="font-style: normal;">Before we can go on
with some code, it is the time to learn about how the functions,
constants and arguments are actually described in a code object. The
</span><i>LOAD_*</i><span style="font-style: normal;"> functions have
an almost common description:</span></div>
<div align="JUSTIFY" style="margin-left: 1.25cm;">
<i><b>Loads the
{global/local/constant} named {co_names/co_varnames/co_consts}[arg]
onto the stack</b></i></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">Fair enough, but
what are these co_names, co_varnames or co_consts fields? Well, they
are simply tuple objects containing all the needed symbols. For
instance, if </span><i>co_names = (add, divide, subtract)</i><span style="font-style: normal;">
and that we want the subtract function, we will write </span><i>LOAD_GLOBAL
(2)</i><span style="font-style: normal;">, that is put the index of
the wanted function in the </span><i>co_names</i><span style="font-style: normal;">
tuple as operation argument. As explained in the first section, the
argument is simply the value of the two bytes following the opcode in
the bytecode.</span></div>
<div align="JUSTIFY">
<span style="font-style: normal;"><br /></span>
<span style="font-style: normal;">For the sake of
simplicity, we will consider in the following part that we already
have these tuples. Let's now see how to convert a list representation
of our tree to its bytecode representation. The important point is to
realize the similarities between the Python bytecode and our list
representation. The following figure shows it quite straightly.</span><br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://1.bp.blogspot.com/-UmKkSa1rP0w/U5J_2n_WgOI/AAAAAAAABY4/5mB-ao0E0Rw/s1600/bytecode-generation.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-UmKkSa1rP0w/U5J_2n_WgOI/AAAAAAAABY4/5mB-ao0E0Rw/s1600/bytecode-generation.png" height="137" width="400" /></a></div>
<span style="font-style: normal;"><br /></span></div>
<div align="JUSTIFY" style="font-style: normal;">
</div>
<div align="JUSTIFY">
<span style="font-style: normal;">As one can see, the
conversion is merely an iteration through our list with the appending
of a corresponding </span><i>LOAD_*</i><span style="font-style: normal;">
for each node, the relative order between the nodes staying the same
(for the record, this order is called </span><i>depth-first</i><span style="font-style: normal;">).
The only tricky part is to add the </span><i>CALL_FUNCTION</i><span style="font-style: normal;">
opcode after the last argument. For this purpose, we keep a list of
the number of arguments of each added node. Whenever we bump into a
terminal node (a leaf), we decrement the argument count of its parent
node. If this count gets to 0, then we know that we are done with
this function, and we add the appropriate </span><i>CALL_FUNCTION</i><span style="font-style: normal;">.
Using this algorithm, we provide a simplified conversion function.</span></div>
<div class="gistLoad" data-id="58de2508f7af2d97506c" id="gist-58de2508f7af2d97506c">
Loading... Please enable Javascript</div>
<div align="JUSTIFY" style="line-height: 120%; margin-bottom: 0.25cm;">
This
function takes a list as argument, and return its corresponding
bytecode. Note that a bytecode must be of type <i>bytes</i><span style="font-style: normal;">,
but this type is not suitable for our manipulations, because it is
non-mutable. Therefore, we use a </span><i>bytearray</i><span style="font-style: normal;">,
a mutable equivalent of </span><i>bytes</i><span style="font-style: normal;">
object. The </span><i>opcode</i><span style="font-style: normal;">
module contains various tools to assist the bytecode creation. In
this case, we use the opmap dictionary, which allows us to write the
opcode in plain text ('CALL_FUNCTION' being far more readable than
0x83).</span></div>
<div align="JUSTIFY" style="line-height: 120%; margin-bottom: 0.25cm;">
We
now have to make Python understand that he has to <i>execute</i><span style="font-style: normal;">
this bytecode. First, we must create a complete code object with it.
While the bytecode obviously plays an important role in a code
object, there are plenty of other information we have to give to
Python:</span><br />
<div class="gistLoad" data-id="4daaa23bb8a7d3d78768" id="gist-4daaa23bb8a7d3d78768">
Loading... Please enable Javascript</div>
<br />
<span style="line-height: 120%;">That's
a bunch of information! Most of these parameters are
self-explanatory, but a few deserve more explanations. The </span><i style="line-height: 120%;">stacksize</i><span style="line-height: 120%;">
parameter controls how many things can be put onto the stack at the
same time. For instance, a recursive call will add elements on the
stack each time. While its exact value is not really important, one
must take care to not exceed it, under threat of a segfault of the
Python interpreter! The </span><i style="line-height: 120%;">flags</i><span style="line-height: 120%;">
argument control various things about the way the code is handle, yet
there is not much documentation about it. The value of 67 (64+2+1)
comes from the actual value given by Python to the executable objects
in the standard GP implementation.</span></div>
<div align="JUSTIFY" style="line-height: 120%;">
<span style="line-height: 120%;"><br /></span>
<span style="line-height: 120%;">Now
that we have the code object, we must associate it with a function.
There are various ways to do it, but one of the most obvious in
Python 3 is to use the </span><i style="line-height: 120%;">types</i><span style="line-height: 120%;">
module again, but to create a function object this time:</span></div>
<div class="gistLoad" data-id="dd3a3b999adbbe78537f" id="gist-dd3a3b999adbbe78537f">
Loading... Please enable Javascript</div>
<div align="JUSTIFY" style="line-height: 120%;">
<span style="font-style: normal;">The
second argument (a dictionary) is mandatory to tell Python which
function actually corresponds to each symbol. Fortunately, its
generation was already implemented in DEAP, since the same mechanism
applies when using the eval function.</span><br />
<span style="line-height: 120%;"><br /></span>
<span style="line-height: 120%;">Another
interesting thing about this approach is that it allows for easy
genetic manipulation, like crossovers or mutations. In a few words,
these operations change the content of the tree by modifying or
exchanging branches. In the standard list implementation, a branch
replacement could be done with a simple slicing operation, since each
branch is stored in a contiguous way. Well, that rationale also
applies to our bytecode representation! In order to identify a
subtree, we just need to obtain the position of the </span><i style="line-height: 120%;">LOAD_GLOBAL</i><span style="line-height: 120%;">
of its root node, and look for the corresponding </span><i style="line-height: 120%;">CALL_FUNCTION</i><span style="line-height: 120%;">
thereafter. These two positions then give us the indices needed for
the slice construction.</span><br />
<span style="line-height: 120%;"><br /></span>
<span style="line-height: 120%;">The
following table and figure show the time required to evaluate trees
of different lengths and the relative speedup. The bytecode
implementation reaches its optimal speedup around 250 nodes, but
provides a considerable gain even for smaller lengths. The speedup
value can be easily understand if we refer to the evaluation
procedure we describe at the beginning of this section: the first two
steps that were executed in O(n) are now done in O(1). Of course, the
result computation itself has not changed, and still has, in our test
case, a O(n) complexity. Overall, in exact notation, we started from
a </span><span style="font-family: Liberation Serif, serif; line-height: 120%;">Θ</span><span style="line-height: 120%;">(3n)
complexity, down to </span><span style="font-family: Liberation Serif, serif; line-height: 120%;">Θ</span><span style="line-height: 120%;">(n+2)
with the bytecode approach, which is coherent with the observed
speedups.</span></div>
<style>
    .data-table {
        border-collapse: collapse;
        margin: 0 auto;
        width: 50%
    }
    .border-top {
        border-top: 1px solid #000;
    }
    .border-bottom {
        border-bottom: 1px solid #000;
    }
    .border-left {
        border-left: 1px solid #000;
    }
    .border-right {
        border-right: 1px solid #000;
    }
    .data-table td {
        padding: 0.3em;
    }
</style>

<br />
<table class="data-table">
    <tbody>
<tr>
        <th class="border-top border-bottom border-left border-right"># of nodes</th>
        <th class="border-top border-bottom border-right">Standard</th>
        <th class="border-top border-bottom border-right">Bytecode</th>
        <th class="border-top border-bottom border-right">Speedup</th>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">1</td>
        <td class="border-bottom border-right">4,2674E-05</td>
        <td class="border-bottom border-right">2,3882E-05</td>
        <td class="border-bottom border-right">1,787</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">3</td>
        <td class="border-bottom border-right">5,9971E-05</td>
        <td class="border-bottom border-right">3,0232E-05</td>
        <td class="border-bottom border-right">1,984</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">7</td>
        <td class="border-bottom border-right">8,1913E-05</td>
        <td class="border-bottom border-right">3,6364E-05</td>
        <td class="border-bottom border-right">2,253</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">15</td>
        <td class="border-bottom border-right">1,5890E-04</td>
        <td class="border-bottom border-right">7,4422E-05</td>
        <td class="border-bottom border-right">2,135</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">31</td>
        <td class="border-bottom border-right">2,5088E-04</td>
        <td class="border-bottom border-right">9,6281E-05</td>
        <td class="border-bottom border-right">2,606</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">63</td>
        <td class="border-bottom border-right">4,5313E-04</td>
        <td class="border-bottom border-right">1,5996E-04</td>
        <td class="border-bottom border-right">2,833</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">127</td>
        <td class="border-bottom border-right">8,6494E-04</td>
        <td class="border-bottom border-right">2,9974E-04</td>
        <td class="border-bottom border-right">2,886</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">255</td>
        <td class="border-bottom border-right">1,6832E-03</td>
        <td class="border-bottom border-right">5,0897E-04</td>
        <td class="border-bottom border-right">3,307</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">511</td>
        <td class="border-bottom border-right">3,3082E-03</td>
        <td class="border-bottom border-right">1,0151E-03</td>
        <td class="border-bottom border-right">3,259</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">1023</td>
        <td class="border-bottom border-right">6,5782E-03</td>
        <td class="border-bottom border-right">1,9996E-03</td>
        <td class="border-bottom border-right">3,290</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">2047</td>
        <td class="border-bottom border-right">1,3001E-02</td>
        <td class="border-bottom border-right">3,8225E-03</td>
        <td class="border-bottom border-right">3,401</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">4095</td>
        <td class="border-bottom border-right">2,6315E-02</td>
        <td class="border-bottom border-right">7,8760E-03</td>
        <td class="border-bottom border-right">3,341</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">8191</td>
        <td class="border-bottom border-right">5,4996E-02</td>
        <td class="border-bottom border-right">1,5786E-02</td>
        <td class="border-bottom border-right">3,484</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">16383</td>
        <td class="border-bottom border-right">1,0808E-01</td>
        <td class="border-bottom border-right">3,1520E-02</td>
        <td class="border-bottom border-right">3,429</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">32767</td>
        <td class="border-bottom border-right">2,1563E-01</td>
        <td class="border-bottom border-right">6,2349E-02</td>
        <td class="border-bottom border-right">3,459</td>
    </tr>
<tr>
        <td class="border-bottom border-left border-right">65535</td>
        <td class="border-bottom border-right">4,3286E-01</td>
        <td class="border-bottom border-right">1,2690E-01</td>
        <td class="border-bottom border-right">3,411</td>
    </tr>
</tbody></table>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://3.bp.blogspot.com/-JjurbvLKE5g/U5J__aqSq0I/AAAAAAAABZA/KohYkZdRu4c/s1600/perf-tree-size.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-JjurbvLKE5g/U5J__aqSq0I/AAAAAAAABZA/KohYkZdRu4c/s1600/perf-tree-size.png" height="408" width="640" /></a></div>
<br />
<h3>
Conclusion</h3>
<div align="JUSTIFY">
We have provided a simple way to speed up a genetic
programming evolution by directly evolving Python bytecode, without
intermediate representations. This generally divides by two the
computation time needed to perform an evolution, which is non
negligible with real world problems. This is especially important
when taking into account that as most stochastic methods,
evolutionary algorithms needs to be run at least a couple of times to
produce statistical significant results. The complete code is
available at <a href="https://github.com/mgard/deap">github.com/mgard/deap</a>. However, it should be
noted that this code includes many hacks to make it fully compliant
with DEAP API (so a lambda user does not have to worry about which
tree implementation he is using), and is still in development to
further improve performance and reliability &#8211; one funny
characteristic of our approach is that it is going so deep into
Python internals that it could actually segfault the interpreter
whenever an error occurs...<br />
<br />
If the clever mind from section 3 did not run away
already (which would probably be the reasonable thing to do instead
of reading an article describing a weird and unclean optimization
technique targeting a very narrow topic of an already narrow field
on a specific language), he might notice one interesting thing in the
second profiling figure. The evaluation itself now takes about two
thirds of the total computation time. Moreover, even basic arithmetic
functions like multiply or divide are called so often (almost 100
million times!) that they take up to 20% of the total execution time!
That's clearly where we should focus in order to further improve
performance. But how could we do it?</div>
<br />
<div align="JUSTIFY">
Well, in this post, we had fun with <i>Python</i>
bytecode. Maybe it's time to take the next step, and use a different
type of bytecode, even more low level. But that will be the subject
of another story...</div>
</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/106926704724745567630' itemprop='url'/>
<a class='g-profile' href='https://plus.google.com/106926704724745567630' rel='author' title='author profile'>
<span itemprop='name'>Marc-André Gardner</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html' itemprop='url'/>
<a class='timestamp-link' href='http://multigrad.blogspot.ca/2014/06/fun-with-python-bytecode.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2014-06-08T13:08:00-04:00'>1:08 PM</abbr></a>
</span>
<span class='reaction-buttons'>
</span>
<span class='star-ratings'>
</span>
<span class='post-comment-link'>
</span>
<span class='post-backlinks post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-832192397'>
<a href='http://www.blogger.com/post-edit.g?blogID=569950264826755092&postID=3996046066174380773&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='http://img2.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='http://www.blogger.com/share-post.g?blogID=569950264826755092&postID=3996046066174380773&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='http://www.blogger.com/share-post.g?blogID=569950264826755092&postID=3996046066174380773&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='http://www.blogger.com/share-post.g?blogID=569950264826755092&postID=3996046066174380773&target=twitter' target='_blank' title='Share to Twitter'><span class='share-button-link-text'>Share to Twitter</span></a><a class='goog-inline-block share-button sb-facebook' href='http://www.blogger.com/share-post.g?blogID=569950264826755092&postID=3996046066174380773&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='http://www.blogger.com/share-post.g?blogID=569950264826755092&postID=3996046066174380773&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a><div class='goog-inline-block dummy-container'><g:plusone source='blogger:blog:plusone' href='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html' size='medium' width='300' annotation='inline'/></div>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>3 comments:</h4>
<div class='comments-content'>
<script async='async' src='//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js' type='text/javascript'></script>
<script type='text/javascript'>
    (function() {
      var items = [{'id': '6029048691656379638', 'body': 'Very cool. How complicated do these tree expressions usually get? Could you define a dictionary of common \46#39;operations\46#39; which could be linked together as snippets of something compiled at a lower level? Keen to read more ...', 'timestamp': '1403304283776', 'permalink': 'http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment\0751403304283776#c6029048691656379638', 'author': {'name': 'Padarn Wilson', 'avatarUrl': '//lh5.googleusercontent.com/-yGOhOPEqUbU/AAAAAAAAAAI/AAAAAAAAApg/reRfdqbZzaE/s512-c/photo.jpg', 'profileUrl': 'http://www.blogger.com/profile/15384507478597706949'}, 'displayTime': 'June 20, 2014 at 6:44 PM', 'deleteclass': 'item-control blog-admin pid-2066046581'}, {'id': '6465182030800360597', 'body': 'Thanks for the great post!\74br /\76A question about the byte code from myMathOperator. The index goes till 15, but I can only see 11 hex numbers. Even more important, the byte string contains \46quot;|\46quot; which I didn\46#39;t find explained in the python docs. Could you elaborate?', 'timestamp': '1403337375765', 'permalink': 'http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment\0751403337375765#c6465182030800360597', 'author': {'name': 'Niklas', 'avatarUrl': 'http://img2.blogblog.com/img/b16-rounded.gif', 'profileUrl': 'http://www.blogger.com/profile/02062627744933379059'}, 'displayTime': 'June 21, 2014 at 3:56 AM', 'deleteclass': 'item-control blog-admin pid-1333412371'}, {'id': '1570254235408598365', 'body': 'Hi Niklas,\74br /\76You are right, this is a tricky part I didn\46#39;t explain. Basically, it has to do with the way Python handles bytes objects when it comes to printing : all valid display ASCII characters (roughly any byte between 0x30 and 0xFF) are displayed as is, and the others (which do not représente displayable characters) are displayed as hex numbers (with the \\x** syntax).\74br /\76In this case, the actual opcode value for LOAD_FAST is 124 (0xFC), which is also the ASCII code for \46quot;|\46quot;. The same rationale applies for RETURN_VALUE :\74br /\76\46gt;\46gt;\46gt; opcode.opmap[\46quot;RETURN_VALUE\46quot;] \75\75 ord(\46quot;S\46quot;)\74br /\76True\74br /\76\74br /\76If you make the count, you will see that there is 3 LOAD_FAST and 1 RETURN_VALUE in the bytecode, the rest being non display characters codes. That explains your difference of 4.', 'timestamp': '1403380937103', 'permalink': 'http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment\0751403380937103#c1570254235408598365', 'author': {'name': 'Marc-André Gardner', 'avatarUrl': 'http://img2.blogblog.com/img/b16-rounded.gif', 'profileUrl': 'http://www.blogger.com/profile/12152684894202279181'}, 'displayTime': 'June 21, 2014 at 4:02 PM', 'deleteclass': 'item-control blog-admin pid-832192397'}];
      var msgs = {'loadMore': 'Load more...', 'loading': 'Loading...', 'loaded': 'No more!', 'addComment': 'Add comment', 'reply': 'Reply', 'delete': 'Delete'};
      var config = {'blogId': '569950264826755092', 'postId': '3996046066174380773', 'feed': 'http://multigrad.blogspot.com/feeds/3996046066174380773/comments/default', 'authorName': 'Marc-André Gardner', 'authorUrl': 'http://www.blogger.com/profile/12152684894202279181', 'baseUri': 'http://www.blogger.com', 'maxThreadDepth': 2};

// <![CDATA[
      var cursor = null;
      if (items && items.length > 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        if (entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '<span class="deleted-comment">' + entry.content.$t + '</span>';
            }
          }
        }
        return entry.content.$t;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data && data.feed && data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author && entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid && pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&v=2&orderby=published&reverse=false&max-results=50';
          if (cursor) {
            url += '&published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length < 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              && comment.author.name == config.authorName
              && comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox && (commentId !== replyParent)) {
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog && window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog && window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]>
</script>
<div id='comment-holder'>
<div id='bc_0_4C' kind='c'><div id='bc_0_4CT'><div id='bc_0_3T' class='comment-thread' kind='r'  t='0' u='0'><ol id='bc_0_3TB'><li id='bc_0_0B' class='comment' kind='b'><div class='avatar-image-container'><img src='//lh5.googleusercontent.com/-yGOhOPEqUbU/AAAAAAAAAAI/AAAAAAAAApg/reRfdqbZzaE/s512-c/photo.jpg'></img></div><div id='c6029048691656379638' class='comment-block'><div id='bc_0_0M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='http://www.blogger.com/profile/15384507478597706949'>Padarn Wilson</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment=1403304283776#c6029048691656379638'>June 20, 2014 at 6:44 PM</a></span></div><p id='bc_0_0MC' class='comment-content'>Very cool. How complicated do these tree expressions usually get? Could you define a dictionary of common &#39;operations&#39; which could be linked together as snippets of something compiled at a lower level? Keen to read more ...</p><span id='bc_0_0MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-2066046581'><a o='d' target='_self' href='http://www.blogger.com/delete-comment.g?blogID=569950264826755092&amp;postID=6029048691656379638'>Delete</a></span></span></div><div id='bc_0_0BR' class='comment-replies'></div><div id='bc_0_0B_box' class='comment-replybox-single'></div></li><li id='bc_0_1B' class='comment' kind='b'><div class='avatar-image-container'><img src='http://img2.blogblog.com/img/b36-rounded.png'></img></div><div id='c6465182030800360597' class='comment-block'><div id='bc_0_1M' class='comment-header' kind='m'><cite class='user'><a rel='nofollow' href='http://www.blogger.com/profile/02062627744933379059'>Niklas</a></cite><span class='icon user'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment=1403337375765#c6465182030800360597'>June 21, 2014 at 3:56 AM</a></span></div><p id='bc_0_1MC' class='comment-content'>Thanks for the great post!<br />A question about the byte code from myMathOperator. The index goes till 15, but I can only see 11 hex numbers. Even more important, the byte string contains &quot;|&quot; which I didn&#39;t find explained in the python docs. Could you elaborate?</p><span id='bc_0_1MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-1333412371'><a o='d' target='_self' href='http://www.blogger.com/delete-comment.g?blogID=569950264826755092&amp;postID=6465182030800360597'>Delete</a></span></span></div><div id='bc_0_1BR' class='comment-replies'></div><div id='bc_0_1B_box' class='comment-replybox-single'></div></li><li id='bc_0_2B' class='comment' kind='b'><div class='avatar-image-container'><img src='http://img2.blogblog.com/img/b36-rounded.png'></img></div><div id='c1570254235408598365' class='comment-block'><div id='bc_0_2M' class='comment-header' kind='m'><cite class='user blog-author'><a rel='nofollow' href='http://www.blogger.com/profile/12152684894202279181'>Marc-André Gardner</a></cite><span class='icon user blog-author'></span><span class='datetime secondary-text'><a rel='nofollow' href='http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html?showComment=1403380937103#c1570254235408598365'>June 21, 2014 at 4:02 PM</a></span></div><p id='bc_0_2MC' class='comment-content'>Hi Niklas,<br />You are right, this is a tricky part I didn&#39;t explain. Basically, it has to do with the way Python handles bytes objects when it comes to printing : all valid display ASCII characters (roughly any byte between 0x30 and 0xFF) are displayed as is, and the others (which do not représente displayable characters) are displayed as hex numbers (with the \x** syntax).<br />In this case, the actual opcode value for LOAD_FAST is 124 (0xFC), which is also the ASCII code for &quot;|&quot;. The same rationale applies for RETURN_VALUE :<br />&gt;&gt;&gt; opcode.opmap[&quot;RETURN_VALUE&quot;] == ord(&quot;S&quot;)<br />True<br /><br />If you make the count, you will see that there is 3 LOAD_FAST and 1 RETURN_VALUE in the bytecode, the rest being non display characters codes. That explains your difference of 4.</p><span id='bc_0_2MN' class='comment-actions secondary-text' kind='m'><a kind='i' href='javascript:;' target='_self' o='r'>Reply</a><span class='item-control blog-admin pid-832192397'><a o='d' target='_self' href='http://www.blogger.com/delete-comment.g?blogID=569950264826755092&amp;postID=1570254235408598365'>Delete</a></span></span></div><div id='bc_0_2BR' class='comment-replies'></div><div id='bc_0_2B_box' class='comment-replybox-single'></div></li></ol><div id='bc_0_3I' class='continue' kind='ci'><a href='javascript:;' target='_self'>Add comment</a></div><div id='bc_0_3T_box' class='comment-replybox-thread'></div><div id='bc_0_3L' class='loadmore loaded' kind='rb'><a href='javascript:;' target='_self'>Load more...</a></div></div></div></div>
</div>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<p>
</p>
<a href='https://www.blogger.com/comment-iframe.g?blogID=569950264826755092&postID=3996046066174380773' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/313381681-comment_from_post_iframe.js"></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html', '04620798066512531250');
    </script>
</div>
</p>
<div id='backlinks-container'>
<div id='Blog1_backlinks-container'>
</div>
</div>
</div>
</div>

        </div></div>
      
<!-- google_ad_section_end -->
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='http://multigrad.blogspot.ca/2014/05/sound-decoding-tale-of-visualization.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='http://multigrad.blogspot.ca/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='http://multigrad.blogspot.com/feeds/3996046066174380773/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
<script type="text/javascript">window.___gcfg = {'lang': 'en'};</script>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogArchive' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>&#9660;&#160;</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/search?updated-min=2014-01-01T00:00:00-05:00&amp;updated-max=2015-01-01T00:00:00-05:00&amp;max-results=3'>2014</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>&#9660;&#160;</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/2014_06_01_archive.html'>June</a>
<span class='post-count' dir='ltr'>(1)</span>
<ul class='posts'>
<li><a href='http://multigrad.blogspot.ca/2014/06/fun-with-python-bytecode.html'>Fun with Python bytecode</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/2014_05_01_archive.html'>May</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/2014_04_01_archive.html'>April</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/search?updated-min=2013-01-01T00:00:00-05:00&amp;updated-max=2014-01-01T00:00:00-05:00&amp;max-results=3'>2013</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/2013_09_01_archive.html'>September</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

          &#9658;&#160;
        
</span>
</a>
<a class='post-count-link' href='http://multigrad.blogspot.ca/2013_07_01_archive.html'>July</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=569950264826755092&widgetType=BlogArchive&widgetId=BlogArchive1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget Profile' id='Profile1'>
<h2>Contributors</h2>
<div class='widget-content'>
<ul>
<li><a class='profile-name-link g-profile' href='http://www.blogger.com/profile/15845316618422771984' style='background-image: url(//www.blogger.com/img/logo-16.png);'>f.m. de rainville</a></li>
<li><a class='profile-name-link g-profile' href='https://plus.google.com/106926704724745567630' style='background-image: url(//www.google.com/images/icons/ui/gprofile_button-16.png);'>Marc-André Gardner</a></li>
<li><a class='profile-name-link g-profile' href='http://www.blogger.com/profile/02537685516788329933' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Félix-Antoine Fortin</a></li>
<li><a class='profile-name-link g-profile' href='https://plus.google.com/106172985094854571984' style='background-image: url(//www.google.com/images/icons/ui/gprofile_button-16.png);'>Yannick Hold-Geoffroy</a></li>
<li><a class='profile-name-link g-profile' href='http://www.blogger.com/profile/17937191399910652408' style='background-image: url(//www.blogger.com/img/logo-16.png);'>Olivier Gagnon</a></li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=569950264826755092&widgetType=Profile&widgetId=Profile1&action=editWidget&sectionId=sidebar-right-1' onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' target='configProfile1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3'><div class='widget Attribution' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Awesome Inc. template. Powered by <a href='http://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' href='//www.blogger.com/rearrange?blogID=569950264826755092&widgetType=Attribution&widgetId=Attribution1&action=editWidget&sectionId=footer-3' onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' target='configAttribution1' title='Edit'>
<img alt='' height='18' src='http://img1.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script type="text/javascript">
if (window.jstiming) window.jstiming.load.tick('widgetJsBefore');
</script><script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3401484092-widgets.js"></script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<script type='text/javascript'>
if (typeof(BLOG_attachCsiOnload) != 'undefined' && BLOG_attachCsiOnload != null) { window['blogger_templates_experiment_id'] = "templatesV2";window['blogger_blog_id'] = '569950264826755092';BLOG_attachCsiOnload('item_'); }_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d569950264826755092','//multigrad.blogspot.ca/2014/06/fun-with-python-bytecode.html','569950264826755092');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '569950264826755092', 'bloggerUrl': 'http://www.blogger.com', 'title': 'multigrad', 'pageType': 'item', 'postId': '3996046066174380773', 'url': 'http://multigrad.blogspot.ca/2014/06/fun-with-python-bytecode.html', 'canonicalUrl': 'http://multigrad.blogspot.com/2014/06/fun-with-python-bytecode.html', 'canonicalHomepageUrl': 'http://multigrad.blogspot.com/', 'homepageUrl': 'http://multigrad.blogspot.ca/', 'blogspotFaviconUrl': 'http://multigrad.blogspot.ca/favicon.ico', 'enabledCommentProfileImages': true, 'adultContent': false, 'disableAdSenseWidget': false, 'analyticsAccountNumber': 'UA-38489735-1', 'searchLabel': '', 'searchQuery': '', 'pageName': 'Fun with Python bytecode', 'pageTitle': 'multigrad: Fun with Python bytecode', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'languageDirection': 'ltr', 'feedLinks': '\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42multigrad - Atom\42 href\75\42http://multigrad.blogspot.com/feeds/posts/default\42 /\76\n\74link rel\75\42alternate\42 type\75\42application/rss+xml\42 title\75\42multigrad - RSS\42 href\75\42http://multigrad.blogspot.com/feeds/posts/default?alt\75rss\42 /\76\n\74link rel\75\42service.post\42 type\75\42application/atom+xml\42 title\75\42multigrad - Atom\42 href\75\42http://www.blogger.com/feeds/569950264826755092/posts/default\42 /\76\n\n\74link rel\75\42alternate\42 type\75\42application/atom+xml\42 title\75\42multigrad - Atom\42 href\75\42http://multigrad.blogspot.com/feeds/3996046066174380773/comments/default\42 /\76\n', 'meTag': '', 'openIdOpTag': '', 'postImageThumbnailUrl': 'http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s72-c/dot-analysis.png', 'postImageUrl': 'http://3.bp.blogspot.com/-_gOaM3n9UKc/U5J_NfKRsmI/AAAAAAAABYg/Tj-RoRYIl-4/s1600/dot-analysis.png', 'latencyHeadScript': '\74script type\75\42text/javascript\42\76(function() { var b\75window,f\75\42chrome\42,g\75\42tick\42,k\75\42jstiming\42;(function(){function d(a){this.t\75{};this.tick\75function(a,d,c){var e\75void 0!\75c?c:(new Date).getTime();this.t[a]\75[e,d];if(void 0\75\75c)try{b.console.timeStamp(\42CSI/\42+a)}catch(h){}};this[g](\42start\42,null,a)}var a;b.performance\46\46(a\75b.performance.timing);var n\75a?new d(a.responseStart):new d;b.jstiming\75{Timer:d,load:n};if(a){var c\75a.navigationStart,h\75a.responseStart;0\74c\46\46h\76\75c\46\46(b[k].srt\75h-c)}if(a){var e\75b[k].load;0\74c\46\46h\76\75c\46\46(e[g](\42_wtsrt\42,void 0,c),e[g](\42wtsrt_\42,\42_wtsrt\42,h),e[g](\42tbsd_\42,\42wtsrt_\42))}try{a\75null,\nb[f]\46\46b[f].csi\46\46(a\75Math.floor(b[f].csi().pageT),e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b[f].csi().startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),null\75\75a\46\46b.gtbExternal\46\46(a\75b.gtbExternal.pageT()),null\75\75a\46\46b.external\46\46(a\75b.external.pageT,e\46\0460\74c\46\46(e[g](\42_tbnd\42,void 0,b.external.startE),e[g](\42tbnd_\42,\42_tbnd\42,c))),a\46\46(b[k].pt\75a)}catch(p){}})();b.tickAboveFold\75function(d){var a\0750;if(d.offsetParent){do a+\75d.offsetTop;while(d\75d.offsetParent)}d\75a;750\76\75d\46\46b[k].load[g](\42aft\42)};var l\75!1;function m(){l||(l\75!0,b[k].load[g](\42firstScrollTime\42))}b.addEventListener?b.addEventListener(\42scroll\42,m,!1):b.attachEvent(\42onscroll\42,m);\n })();\74/script\076', 'mobileHeadScript': '', 'ieCssRetrofitLinks': '\74!--[if IE]\76\74script type\75\42text/javascript\42 src\75\42https://www.blogger.com/static/v1/jsbin/1163241896-ieretrofit.js\42\76\74/script\76\n\74![endif]--\076', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/76f25a6f2e06af76', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'sf': 'n', 'tf': ''}}, {'name': 'skin', 'data': {'vars': {'date_border_size': '0', 'description_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_background_gradient_cap': 'none', 'tabs_selected_background_color': '#666666', 'footer_background_gradient': 'none', 'date_background': 'transparent none no-repeat scroll top left', 'widget_border_radius': '0', 'post_title_text_color': '#444444', 'widget_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_link_hover_color': '#3778cd', 'link_visited_color': '#1e6dd8', 'mobile_background_size': 'auto', 'date_space': '30px', 'post_title_font': 'normal bold 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_text_color': '#444444', 'title_separator_border_size': '1px', 'header_background_gradient': 'none', 'widget_outer_background_gradient': 'none', 'widget_link_color': '#3778cd', 'mobile_button_color': '#ffffff', 'widget_title_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'widget_outer_background_color': 'transparent', 'date_last_border_radius_bottom': '0', 'widget_outer_margin_top': '0', 'shadow_spread': '20px', 'title_shadow_spread': '-1px', 'outer_shadow_spread': '0', 'keycolor': '#eeeeee', 'image_shadow_spread': '0', 'image_background_color': 'transparent', 'header_font': 'normal bold 40px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'header_background_color': 'transparent', 'date_header_border_radius_top': '0', 'widget_border_bevel_color': 'transparent', 'tabs_border_color': '#999999', 'widget_background_color': '#ffffff', 'date_position': 'static', 'post_first_padding_top': '0', 'tabs_background_gradient': 'url(//www.blogblog.com/1kt/awesomeinc/tabs_gradient_light.png)', 'mobile_background_overlay': 'transparent none repeat scroll top left', 'date_border_color': '#eeeeee', 'tabs_background_color': '#eeeeee', 'widget_link_visited_color': '#4d469c', 'feed_text_color': '#444444', 'header_margin_top': '0', 'link_hover_color': '#0000ff', 'date_last_space_bottom': '20px', 'header_margin_bottom': '0', 'date_padding_bottom': '0', 'list_separator_border_size': '1px', 'description_text_color': '#444444', 'body_text_color': '#444444', 'header_padding_top': '22px', 'post_border_color': '#eeeeee', 'footer_text_color': '#444444', 'post_background_color': '#ffffff', 'pager_space_top': '1em', 'endSide': 'right', 'startSide': 'left', 'body_background_size': 'auto', 'tabs_font': 'normal bold 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'body_font': 'normal normal 13px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'date_first_border_radius_top': '0', 'date_header_position': '15px', 'date_text_color': '#444444', 'widget_title_text_color': '#444444', 'image_border_color': 'transparent', 'separator_outdent': '15px', 'widget_text_color': '#444444', 'link_color': '#1e6dd8', 'widget_border_color': '#eeeeee', 'pager_border_radius_top': '0', 'feed_link_color': '#3778cd', 'header_text_color': '#444444', 'footer_background_color': '#ffffff', 'widget_padding_top': '8px', 'feed_link_visited_color': '#4d469c', 'feed_link_hover_color': '#3778cd', 'date_font': 'normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif', 'tabs_selected_text_color': '#ffffff', 'date_side': 'right', 'post_border_bevel_color': '#eeeeee', 'widget_padding_side': '15px', 'body_background_color': '#eeeeee', 'image_border_radius': '0', 'pager_background_color': '#ffffff', 'widget_alternate_text_color': '#666666'}, 'override': 'h3, h4 {\n    margin-top: 1em;\n}'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\75classic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\75flipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\75magazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\75mosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\75sidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\75snapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\75timeslide'}}}]);
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', null, document.getElementById('Attribution1'), {'attribution': 'Awesome Inc. template. Powered by \74a href\75\47http://www.blogger.com\47 target\75\47_blank\47\76Blogger\74/a\76.'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', null, document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', null, document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/1938910137-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/2392111094-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', null, document.getElementById('BlogArchive1'), {'languageDirection': 'ltr'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-1', null, document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', null, document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar2', 'navbar', null, document.getElementById('Navbar2'), {}, 'displayModeFull'));
</script>
</body>
<script type='text/x-mathjax-config'>
  // <![CDATA[   
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']],
                      displayMath: [['\\[','\\]'], ['$$','$$']]}});
  // blogger.ui().viewType_.prototype.onRenderComplete=function(){MathJax.Hub.Queue(['Typeset',MathJax.Hub])};   
  // ]]>
</script><script type='text/x-mathjax-config'>
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  var MML = MathJax.ElementJax.mml,
      TEX = MathJax.InputJax.TeX;

  TEX.Definitions.macros.bfrac = "myBevelFraction";

  TEX.Parse.Augment({
    myBevelFraction: function (name) {
      var num = this.ParseArg(name),
          den = this.ParseArg(name);
      this.Push(MML.mfrac(num,den).With({bevelled: true}));
    }
  });
});
</script><script src='http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' type='text/javascript'></script>
<script type='text/javascript'>
(function() {
    
    var gistBloggerPath = "https://rawgithub.com/moski/gist-Blogger/master/public/gistBlogger.js";

    // Initialize the load the main script.
    try {
        initGist();
    } catch(e) {
        var scriptId = 'gistPrinter';
        if (document.getElementById(scriptId) === null) {
            var elem = document.createElement('SCRIPT');
            elem.id = scriptId;
            elem.onload = function() {
              initGist();
            }
            elem.src = gistBloggerPath;
            var theBody = document.getElementsByTagName('body')[0];
            theBody.appendChild(elem);
        }
    }
})();
</script>
</html>