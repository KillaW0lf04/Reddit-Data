<!DOCTYPE html> 
<html>
<head>

	

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width; initial-scale=1"/>

	<link rel="STYLESHEET" type="text/css" href="https://www.schneier.com/main.css?v=20140620">
	<link rel="alternate" type="application/atom+xml" title="Blog Feed (Atom 1.0)" href="https://www.schneier.com/blog/atom.xml">


	<link rel="STYLESHEET" type="text/css" href="/scripts/jquery.socialshareprivacy.css">
	<script type="text/javascript" src="/scripts/jquery-1.9.1.min.js"></script> 
	<script type="text/javascript" src="/scripts/jquery.cookies.js"></script>
	<script type="text/javascript" src="/scripts/jquery.socialshareprivacy.2.js"></script>
	<script type="text/javascript">
	// <![CDATA[
	// define the default order of the buttons:
	$.fn.socialSharePrivacy.settings.order = ['facebook', 'twitter', 'gplus'];
	$.fn.socialSharePrivacy.settings.path_prefix = '/';
	// ]]>
	</script>



	
		<link rel="alternate" type="application/atom+xml" title="Comments on Software Problems with a Breath Alcohol Detector (Atom 1.0)" href="https://www.schneier.com/blog/archives/2009/05/software_proble.xml" >
	
	
		<link rel="prev" href="https://www.schneier.com/blog/archives/2009/05/using_surveilla.html" title="Using Surveillance Cameras to Detect Cashier Cheating">
	
	
		<link rel="next" href="https://www.schneier.com/blog/archives/2009/05/attacking_the_f.html" title="Attacking the Food Supply">
	

	<script type="text/javascript" src="/blog/mt.js"></script>

	<title>Schneier on Security: Software Problems with a Breath Alcohol Detector</title>

</head>
<body><div id="wrapper"><div id="main">
	<header><div id="header">
	<h1><a href="/">Schneier on Security</a></h1>
	</div></header>
	<nav><div class="nav" id="header-nav">
<ul>
		<li class="menu1 current"><a href="https://www.schneier.com/">Blog</a></li>
		<li class="menu2"><a href="https://www.schneier.com/crypto-gram.html">Newsletter</a></li>
		<li class="menu3"><a href="https://www.schneier.com/books.html">Books</a></li>
    <li class="menu4"><a href="https://www.schneier.com/essays/">Essays</a></li>
		<li class="menu5"><a href="https://www.schneier.com/news.html">News</a></li>
		<li class="menu6"><a href="https://www.schneier.com/schedule.html">Schedule</a></li>
		<li class="menu7"><a href="https://www.schneier.com/cryptography.html">Crypto</a></li>
		<li class="menu8"><a href="https://www.schneier.com/about.html">About Me</a></li>
	</ul>

	</div></nav>


<aside><div class="sidebar" id="sidebar-one">

		<section><div class="sidesection" id="search-widget">
		<h3>Search</h3>
		<p class="small"><em>Powered by <a href="https://duckduckgo.com/">DuckDuckGo</a></em></p>
		<form method="get" action="https://duckduckgo.com/">
		<input type="hidden" name="kh" value="1"><!-- use https -->
		<input id="search" name="q" size="15" maxlength="255">
		<input type="submit" value="Go"><br>
		<input type="radio" name="sites" id="searchblog" value="www.schneier.com/blog" checked><label for="searchblog">blog</label> <input type="radio" name="sites" id="searchessays" value="www.schneier.com/essay" ><label for="searchessays">essays</label>
		<input type="radio" name="sites" id="searchall" value="www.schneier.com" ><label for="searchall">whole site</label>		</form>
		</div></section>
	
		<section><div class="sidesection">
		<h3>Subscribe</h3>
		
			<div id="subscription-buttons">
				<a href="https://www.schneier.com/blog/atom.xml"><img alt="Atom Feed" src="https://www.schneier.com/images/rss-32px.png"></a>
				<a href="https://www.facebook.com/bruce.schneier"><img alt="Facebook" src="https://www.schneier.com/images/facebook-32px.png"></a>
				<a href="http://twitter.com/schneierblog/"><img alt="Twitter" src="https://www.schneier.com/images/twitter-32px.png"></a>
				<a href="http://www.amazon.com/Schneier-on-Security/dp/B0053HDDWW/"><img alt="Kindle" src="https://www.schneier.com/images/kindle-32px.png"></a>
				<a href="/crypto-gram-sub.html"><img alt="E-Mail Newsletter (Crypto-Gram)" src="https://www.schneier.com/images/email-32px.png"></a>
			</div><!--#subscription-buttons-->
		</div></section>

	</div></aside>


	
	<div id="content">
    
 	<div id="timetravel">
		
		<a class="earlier" href="https://www.schneier.com/blog/archives/2009/05/using_surveilla.html">&larr; Using Surveillance Cameras to Detect Cashier Cheating</a>
		
		
		<a class="later" href="https://www.schneier.com/blog/archives/2009/05/attacking_the_f.html">Attacking the Food Supply &rarr;</a>
		
	</div>
    
<article><div class="article">
	<script type="text/javascript">
		// <![CDATA[
		$(document).ready(function () {
			$('#share002839').socialSharePrivacy({uri: 'https://www.schneier.com/blog/archives/2009/05/software_proble.html', title: 'Software Problems with a Breath Alcohol Detector'});
			});
		// ]]>
	</script>
	
	<h2 class="entry" id="a002839">	Software Problems with a Breath Alcohol Detector</h2>
	
		
	
    
	    <p><a href="http://www.dwi.com/new-jersey/state-v-chun/">This</a> is an excellent lesson in the security problems inherent in trusting proprietary software:</p>

<blockquote><p>After two years of attempting to get the computer based source code for the Alcotest 7110 MKIII-C, defense counsel in State v. Chun were successful in obtaining the code, and had it analyzed by Base One Technologies, Inc.</p></blockquote>

<p>Draeger, the manufacturer maintained that the system was perfect, and that revealing the source code would be damaging to its business.   They were right about the second part, of course, because it turned out that the code was terrible.</p>

<blockquote><p>2. Readings are Not Averaged Correctly: When the software takes a series of readings, it first averages the first two readings. Then, it averages the third reading with the average just computed. Then the fourth reading is averaged with the new average, and so on. There is no comment or note detailing a reason for this calculation, which would cause the first reading to have more weight than successive readings. Nonetheless, the comments say that the values should be averaged, and they are not.

<p>3. Results Limited to Small, Discrete Values: The A/D converters measuring the IR readings and the fuel cell readings can produce values between 0 and 4095. However, the software divides the final average(s) by 256, meaning the final result can only have 16 values to represent the five-volt range (or less), or, represent the range of alcohol readings possible. This is a loss of precision in the data; of a possible twelve bits of information, only four bits are used. Further, because of an attribute in the IR calculations, the result value is further divided in half. This means that only 8 values are possible for the IR detection, and this is compared against the 16 values of the fuel cell.</p>

<p>4. Catastrophic Error Detection Is Disabled: An interrupt that detects that the microprocessor is trying to execute an illegal instruction is disabled, meaning that the Alcotest software could appear to run correctly while executing wild branches or invalid code for a period of time. Other interrupts ignored are the Computer Operating Property (a watchdog timer), and the Software Interrupt.</p></blockquote>

<p>Basically, the system was designed to return some sort of result regardless.</p>

<p>This is important.  As we become more and more dependent on software for evidentiary and other legal applications, we need to be able to carefully examine that software for accuracy, reliability, etc.  Every government contract for breath alcohol detectors needs to include the requirement for public source code.  "You can't look at our code because we don't want you to" simply isn't good enough.</p>
    
	
	
	

	<p class="entry-tags">Tags: <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=courts&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">courts</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=disclosure&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">disclosure</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=forensics&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">forensics</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=law%20enforcement&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">law enforcement</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=laws&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">laws</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=searches&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">searches</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=sensors&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">sensors</a>, <a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=transparency&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1" rel="tag">transparency</a></p>


	
	<p class="posted"><a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html">Posted on May 13, 2009 at  2:07 PM</a>
	 &#8226; 
	108 Comments
	
	</p>
	<aside><div class="share" id="share002839"></div></aside>
	</div></article>




    
    

<h3 id="comments">Comments</h3>


<article><div class="comment by-handsomedave" id="c371751">


<p class="commentcredit"><span class="commenter">handsomedave</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371751">May 13, 2009  2:56 PM</a>
</p>

<p>I hope the departments that bought these things sue the pants off the manufacturer. I'm not the type to encourage lawsuits but these idiots are obviously negligent.</p>
</div></article>



<article><div class="comment by-gonzo" id="c371752">


<p class="commentcredit"><span class="commenter">Gonzo</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371752">May 13, 2009  3:00 PM</a>
</p>

<p>Just a heads up, Bruce.  Quotes you said concerning the security Czar just hit Slashdot, and I drove him here.</p>

<p><a href="http://it.slashdot.org/article.pl?sid=09/05/13/1822242" rel="nofollow">http://it.slashdot.org/article.pl?sid=09/05/13/1822242</a> if you're interested.  I'd love to see one of your well reasoned posts on the topic. Especially if we can get the right person to read it for once.</p>
</div></article>



<article><div class="comment by-intelvet" id="c371753">


<p class="commentcredit"><span class="commenter">IntelVet</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371753">May 13, 2009  3:00 PM</a>
</p>

<p>Don't voting machine manufacturers use the same mantra, You can't look at our code because we don't want you to"?</p>
</div></article>



<article><div class="comment by-aikimark" id="c371755">


<p class="commentcredit"><span class="commenter">aikimark</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371755">May 13, 2009  3:03 PM</a>
</p>

<p>Another victory for transparency.</p>

<p>Everyone should remember this when their federa/state/local government considers the use of electronic voting equipment.</p>
</div></article>



<article><div class="comment by-nemryn" id="c371757">


<p class="commentcredit"><span class="commenter">nemryn</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371757">May 13, 2009  3:07 PM</a>
</p>

<p>Wouldn't that system give the *last* reading the most weight, not the first?</p>
</div></article>



<article><div class="comment by-scared" id="c371760">


<p class="commentcredit"><span class="commenter">Scared</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371760">May 13, 2009  3:08 PM</a>
</p>

<p>"Readings are Not Averaged Correctly: When the software takes a series of readings, it first averages the first two readings. Then, it averages the third reading with the average just computed. Then the fourth reading is averaged with the new average, and so on. There is no comment or note detailing a reason for this calculation, which would cause the first reading to have more weight than successive readings."</p>

<p>Isn't it the last reading that has the most weight in this scheme? Basically a simple IIR low-pass filter, rather than an average of all readings.</p>

<p>I could see a use for that kind of filtering, however crude it is. One would imagine that if you keep reading new values, it's because you're not very interested in the first ones.</p>
</div></article>



<article><div class="comment by-eric-in-pdx" id="c371762">


<p class="commentcredit"><span class="commenter">Eric in PDX</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371762">May 13, 2009  3:12 PM</a>
</p>

<p>I wonder if this approach would work with all those speed cameras too? Maybe it was an extra hot day and the software ``though'' it was a red light?<br />
</p>
</div></article>



<article><div class="comment by-don-marti" id="c371763">


<p class="commentcredit"><span class="commenter"><a title="http://zgp.org/~dmarti/" href="http://zgp.org/~dmarti/" rel="nofollow">Don Marti</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371763">May 13, 2009  3:15 PM</a>
</p>

<p>The two alternatives for manufacturers are going to be either (1) publish the code yourself, or (2) the only information about your product's software online will be a bunch of testimony from nit-picking defense experts.  Somebody is going to start using "published code, already reviewed by" and a list of experts as a selling point long before the states get around to requiring it.</p>
</div></article>



<article><div class="comment by-glenn-maynard" id="c371764">


<p class="commentcredit"><span class="commenter">Glenn Maynard</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371764">May 13, 2009  3:19 PM</a>
</p>

<p>> which would cause the first reading to have more weight than successive readings</p>

<p>... the last reading, rather, not that it makes a difference.  The first reading would have the least weight.</p>

<p>> I hope the departments that bought these things sue the pants off the manufacturer. </p>

<p>I'm sure people convicted of drunk driving based on this device will appeal, and I'm sure others convicted based on similar devices will, too.</p>

<p>I'm not wishing more drunks on the road, but if this causes mandatory code audits of this type of device, then all the better.</p>

<p>> Base One, however, did an extensive evaluation, finding 19,400 potential errors in the code.</p>

<p>I'll never understand why people inflate their numbers so grossly that they're plainly ludicrous.  It destroys credibility entirely.  I wouldn't be surprised if this number is greater than the number of compiled instructions.<br />
</p>
</div></article>



<article><div class="comment by-nick" id="c371767">


<p class="commentcredit"><span class="commenter">nick</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371767">May 13, 2009  3:24 PM</a>
</p>

<p>The first two sure seem like bugs which would make this less accurate. I don't want to say the loss of accuracy is enough to substantially change the results without actually testing the thing (you buy the drinks ;-) , but it seems plausible.</p>

<p>The last one isn't necessarily a bug. If the company can demonstrate that those interrupts would not be used if they were enabled, there's no problem here.</p>
</div></article>



<article><div class="comment by-sam" id="c371769">


<p class="commentcredit"><span class="commenter">sam</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371769">May 13, 2009  3:38 PM</a>
</p>

<p>I feel conflicted about this report.  It seems there are some serious errors in the source code, but the report itself blatantly overhypes stuff that isn't even a problem, such as the fact that the processor used was "1970s technology".  Guess what, a lot of the satellites in the sky use "1970s technology", because it's proven to be rock solid.</p>

<p>I suppose some bias is to be expected, since the study was commissioned by the defense, but giving a judge/jury bad information for the "right" reason can bite you later, when they use some malformed idea you fed them to make some unwise decisions of their own.  Think: "our satellites are using outdated 1970s technology!  All new satellites must use Windows Vista!"</p>
</div></article>



<article><div class="comment by-deskin" id="c371770">


<p class="commentcredit"><span class="commenter">Deskin</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371770">May 13, 2009  3:40 PM</a>
</p>

<p>I'm with @Scared, #2 looks like an exponentially weighted moving average, where the last item has the most weight.</p>
</div></article>



<article><div class="comment by-seth-breidbart" id="c371771">


<p class="commentcredit"><span class="commenter">Seth Breidbart</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371771">May 13, 2009  3:40 PM</a>
</p>

<p>The last reading has the highest weight in the last value shown; but it says to average all the values shown, which gives the first reading the highest weight.</p>
</div></article>



<article><div class="comment by-seth-breidbart" id="c371772">


<p class="commentcredit"><span class="commenter">Seth Breidbart</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371772">May 13, 2009  3:42 PM</a>
</p>

<p>The last reading has the highest weight in the last value shown; but it says to average all the values shown, which gives the first reading the highest weight.</p>
</div></article>



<article><div class="comment by-fp" id="c371774">


<p class="commentcredit"><span class="commenter">FP</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371774">May 13, 2009  3:50 PM</a>
</p>

<p>Playing devil's advocate: Wouldn't it be sufficient for a manufacturer to demonstrate to an independent authority that results were sufficiently accurate across the entire range?  I.e., if you set up a testing rig that produces a set of reference inputs and then check that the device produces the expected results?</p>

<p>Just like a drug manufacturer does not have to open-source their drugs but only has to demonstrate to the FDA that the drug is effective across a somewhat representive cross-section of humanity.<br />
</p>
</div></article>



<article><div class="comment by-lazlo" id="c371775">


<p class="commentcredit"><span class="commenter"><a title="http://dynamicequilibria.blogspot.com/" href="http://dynamicequilibria.blogspot.com/" rel="nofollow">Lazlo</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371775">May 13, 2009  3:51 PM</a>
</p>

<p>"Other interrupts ignored are the Computer Operating Property (a watchdog timer), and the Software Interrupt."</p>

<p>Anyone else amused at the acronym there?  The breathalizer is ignoring the COP, as opposed to the other way around...</p>
</div></article>



<article><div class="comment by-alvin" id="c371778">


<p class="commentcredit"><span class="commenter">alvin</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371778">May 13, 2009  4:08 PM</a>
</p>

<p>With this "averaging" method described here used by the software, it would be the successive readings that would have more weight instead of the first reading.</p>
</div></article>



<article><div class="comment by-joel" id="c371781">


<p class="commentcredit"><span class="commenter">Joel</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371781">May 13, 2009  4:17 PM</a>
</p>

<p>As far as the LINT report showing 19K errors, I defy anyone to not have nearly that number on  any sizable code base.  LINT is notorious for providing false positives, particularly when unfiltered.  At best it gives you an idea of where to look for errors.</p>
</div></article>



<article><div class="comment by-tangerine-blue" id="c371784">


<p class="commentcredit"><span class="commenter">Tangerine Blue</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371784">May 13, 2009  4:41 PM</a>
</p>

<p>@Don Marti<br />
> Somebody is going to start using "published code, <br />
> already reviewed by" and a list of experts as a<br />
> selling point long before the states get around to<br />
> requiring it.</p>

<p>If the customers (states) don't care about (require) it, what would induce the vendor to change?<br />
</p>
</div></article>



<article><div class="comment by-peri" id="c371785">


<p class="commentcredit"><span class="commenter">peri</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371785">May 13, 2009  4:44 PM</a>
</p>

<p>@Glenn Maynard: I wouldn't be surprised if this number is greater than the number of compiled instructions.</p>

<p>Consider this detector program listing:</p>

<p>  noop</p>

<p>I am certain I packed more than one problem into a program with only one instruction.</p>
</div></article>



<article><div class="comment by-bryan-feir" id="c371786">


<p class="commentcredit"><span class="commenter">Bryan Feir</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371786">May 13, 2009  4:50 PM</a>
</p>

<p>@Joel:</p>

<p>Agreed on that.  LINT is a fairly simple code analysis tool, which has limits on what it can and cannot flag, and tends to err heavily on the side of caution.  Not to mention that it was written back before most compilers would produce detailed warning outputs.</p>

<p>Granted, I've seen bad outputs from compilers as well.  One compiler I've worked with would consistently report that an array had been used before being initialized, even though I could prove all elements in the array had been initialized before they were used.  As far as I could tell, unless I initialized the entire array at once when it was defined, it would throw the error, because it treated the array as a separate item from the sum of its elements.</p>

<p>Initializing the array on definition removed the warning... and promptly caused a noticeable slowdown in the code because of the brain-dead method the compiler used to clear the array.</p>
</div></article>



<article><div class="comment by-steve" id="c371789">


<p class="commentcredit"><span class="commenter">Steve</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371789">May 13, 2009  5:01 PM</a>
</p>

<p>Old tech has its virtues.  Back in the Z-80 era, I read about an engineer who designed a railway (the San Francisco BART, IIRC) control system around the Intel 8008.  Using the 8085 or the (then) latest-and-greatest 8086 would have required less code and less hardware, but the designer was confident that he fully understood the 8008, bugs and all, so there would be no loud surprises involving trains full of people.</p>
</div></article>



<article><div class="comment by-jason" id="c371790">


<p class="commentcredit"><span class="commenter">Jason</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371790">May 13, 2009  5:06 PM</a>
</p>

<p>"This means that only 8 values are possible for the IR detection, and this is compared against the 16 values of the fuel cell."</p>

<p>I would have thought that some patrolman somewhere, who uses this thing daily, might have noticed that "hey, the readout is always one of only 8 different values", and started to ask questions.  But maybe cops that have actual powers of observation end up being promoted to detective.  At least, I hope so.</p>
</div></article>



<article><div class="comment by-xls" id="c371793">


<p class="commentcredit"><span class="commenter">xls</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371793">May 13, 2009  5:15 PM</a>
</p>

<p>For those interested, here's what the "buckets" of analog to digital (might) look like given error 3 in the article. Buckets are a range of real values that would be reported as a single output reading after D/A processing.</p>

<p>Assuming the machine was sensitive up to .5% BAC (just above LD50 for human adults)</p>

<p><br />
4095 discrete D/A conversions = 0.0001221% BAC per bucket</p>

<p>4095/255 ~= 16 discrete D/A conversions = 0.03125% BAC per bucket</p>

<p>4095/255/2 = 8 discrete D/A conversions per bucket = 0.0625% BAC per bucket</p>

<p>The specific problem here is illustrated by the second bucket in the 8 discrete measures scenario: that bucket spans a large conversion domain from 0.0625 (legal, most states) to 0.125 (illegal, most states). </p>

<p>In fact, the "legal" part of that bucket (.0625 up to .1) occupies 60% of the domain, and the "illegal" part (.1 up to 1.25) occupies only 40% of that domain. </p>

<p>If the device shows that a person is blowing a BAC in that bucket, there's a 60% chance that they're actually under the legal limit (assuming no other source of error).  </p>
</div></article>



<article><div class="comment by-anonymous" id="c371795">


<p class="commentcredit"><span class="commenter">Anonymous</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371795">May 13, 2009  5:25 PM</a>
</p>

<p>I just searched for the manufactures homepage and found this wonderful piece:</p>

<p>>DrÃ¤ger AlcotestÂ® 7110 Evidential</p>

<p>>The AlcotestÂ® 7110 MK III-C is proven evidential breath breath analyzer. <br />
>It is the only evidential breath tester on the market whose source code has been reviewed by independent third parties and approved by a Supreme Court decision.</p>

<p><a href="http://www.draeger.com/US/en_US/products/alcohol_drug_detection/evidential/cdi_alcotest_7110_evidential.jsp" rel="nofollow">http://www.draeger.com/US/en_US/products/alcohol_drug_detection/evidential/cdi_alcotest_7110_evidential.jsp</a></p>

<p>ROFL!</p>
</div></article>



<article><div class="comment by-roy" id="c371796">


<p class="commentcredit"><span class="commenter">Roy</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371796">May 13, 2009  5:30 PM</a>
</p>

<p>For six samples, the scalings have the denominator of 6!, with the numerators 0!, 1!, 2!, 3!, 4!, 5!</p>
</div></article>



<article><div class="comment by-reader" id="c371801">


<p class="commentcredit"><span class="commenter">Reader</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371801">May 13, 2009  5:47 PM</a>
</p>

<p>"12. Defects In Three Out Of Five Lines Of Code: A universal tool in the open-source community, called Lint, was used to analyze the source code written in C."</p>

<p>lol, that's just bad!</p>
</div></article>



<article><div class="comment by-peter-e-retep" id="c371806">


<p class="commentcredit"><span class="commenter">Peter E. Retep</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371806">May 13, 2009  6:18 PM</a>
</p>

<p>Isn't this whole dynamic of <br />
[a] interfacing physical processes, <br />
[b] for pre-packaged chemical processes, <br />
[c] and adjunct software processes, <br />
[d] each constructed from limited human knowledge, <br />
[e] and  limited human and physical capabilities, <br />
[f] and limiting cost priorities,<br />
[g] as interpreted by limited human and physical capabilities <br />
[h] and mediated by limited human judgement <br />
is sort of a micro-lab of issues of social regulation, <br />
especially as the whole is <br />
[i] regulated by chain of custody <br />
[j] administatively determined priorities [such as r.o.i.<br />
and [k] sworn adherences to presumed-to-be-effective-and-accurate protocols?<br />
Did I leave out any other fountain of uncertainty?<br />
Oh, yes. <br />
[L] The problem of the willfulness of the operating agents! <br />
Anything else?</p>
</div></article>



<article><div class="comment by-m" id="c371810">


<p class="commentcredit"><span class="commenter">M</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371810">May 13, 2009  6:41 PM</a>
</p>

<p>@Tangerine:</p>

<p>Once convictions start getting overturned, I'm willing to bet customers (law enforcement agencies) will start demanding code-reviewed breath testers.</p>
</div></article>



<article><div class="comment by-therac-25" id="c371811">


<p class="commentcredit"><span class="commenter">Therac-25</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371811">May 13, 2009  6:47 PM</a>
</p>

<p>"The Safety division's current portfolio includes stationary and mobile gas detection systems, respiratory protection, firefighting equipment, professional diving gear, and alcohol and drug-testing instruments.</p>

<p>The Medical division's product range covers anesthesia workstations, ventilation equipment for intensive and home care, emergency and mobile ventilation units, warming therapy equipment for infants, patient monitoring equipment, IT solutions and gas management systems."</p>

<p>How long before customers for some of these other products also start wondering about code quality...?</p>
</div></article>



<article><div class="comment by-packagedblue" id="c371817">


<p class="commentcredit"><span class="commenter">PackagedBlue</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371817">May 13, 2009  7:48 PM</a>
</p>

<p>A great article and a great case for the need for open systems.  I wish this stuff would be on the front page on many newspapers and magazines.</p>

<p>Truth is very disturbing today.</p>

<p>Truth needs a peer review process, like good science, over superstition.</p>

<p>Reminds me of the 90's with NSA and clipper chip.  Sadly, the NSA still wants to play subverted traffic cop and fracture IT.  GRR, I leave the details alone.</p>

<p>We need a vibrant community to handle the complexity of technology.  This is not happening.  I leave those details for others to write in article/comments.</p>
</div></article>



<article><div class="comment by-altjira" id="c371832">


<p class="commentcredit"><span class="commenter"><a title="http://www.gregrperry.com" href="http://www.gregrperry.com" rel="nofollow">altjira</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371832">May 13, 2009  9:32 PM</a>
</p>

<p>Ah, once again the technical details are not enough to overcome the legal and political issues. The NJ Supreme Court says that the equipment is good enough to convict:</p>

<p><a href="http://www.thenewspaper.com/news/22/2280.asp" rel="nofollow">http://www.thenewspaper.com/news/22/2280.asp</a></p>
</div></article>



<article><div class="comment by-killick" id="c371834">


<p class="commentcredit"><span class="commenter">killick</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371834">May 13, 2009  9:51 PM</a>
</p>

<p>It only matters what code was compiled and installed on the machine at the time it was used to gather evidence.  Where's the chain of evidence that shows that THIS code in the courtroom really was the code running on the machine at the time in question?</p>

<p>This is not limited to breath analyzers-- it could be anything that gathers evidence-- red light and speed cameras, voting machines, etc.</p>
</div></article>



<article><div class="comment by-karl-lembke" id="c371838">


<p class="commentcredit"><span class="commenter"><a title="http://ritestuff.blogspot.com" href="http://ritestuff.blogspot.com" rel="nofollow">Karl Lembke</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371838">May 13, 2009 10:12 PM</a>
</p>

<p>I agree with commenters who say the averaging method gives a higher weight to the last data read, not the first.</p>

<p>In general, if you average together N numbers by this method, the first two numbers in the series have a weight of 1/2^(N-1); and each succeeding element has double the weight, until you reach the last element with a weight of 1/2.</p>

<p>If you read a person's breath for long enough, he'll sober up, and only the last few readings of zero BAC will have enough weight to affect the final result.</p>
</div></article>



<article><div class="comment by-john-d" id="c371839">


<p class="commentcredit"><span class="commenter">John D</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371839">May 13, 2009 10:24 PM</a>
</p>

<p>In the 1950s I read a science fiction story where a person accused of a crime really had only one possible defense... to find a flaw in the assumed-to-be-correct judicial software that judged everyone. It was a scary thought then and it's a scary thought now.<br />
I can't remember the name or author. It wasn't the main theme of the story... just a side note. Anybody remember it?</p>
</div></article>



<article><div class="comment by-harry-johnston" id="c371842">


<p class="commentcredit"><span class="commenter">Harry Johnston</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371842">May 13, 2009 10:46 PM</a>
</p>

<p>For comparison, in New Zealand if you fail a breath test you are then given a blood test.  Only the results of the blood test are admissible in court.<br />
</p>
</div></article>



<article><div class="comment by-charles" id="c371851">


<p class="commentcredit"><span class="commenter"><a title="http://technomancer.me.uk" href="http://technomancer.me.uk" rel="nofollow">Charles</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371851">May 13, 2009 11:42 PM</a>
</p>

<p>@John D, you might be thinking of Philip K Dick's "The Minority Report", although this features the future as seen by three mutated humans interpreted by a computer system. </p>

<p>If this isn't the case then there's a book out there I really need to read.</p>
</div></article>



<article><div class="comment by-clive-robinson" id="c371866">


<p class="commentcredit"><span class="commenter">Clive Robinson</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371866">May 14, 2009  1:37 AM</a>
</p>

<p>Oh dear people are arguing about the wrong thing here...</p>

<p>Sure the code as described by the defense appears bad (not seen the real thing so cannot say) but that is not the real issue.</p>

<p>The real issue is a political 455protector system dressed up as a safety measure, that has over time turned into revenue system both by fines and the claim from central resourses for the entire system (follow the money).</p>

<p>A court actualy has little or no interest in if you where above or below the limit they realy do not care or want to care. </p>

<p>What interests them is arguing about the pieces of paper infront of them.</p>

<p>They court does not have the ability to understand the technical or scientific data presented nor does it care, as I said it's only interested in the argument and such things as "gravity" (in the legal sense).</p>

<p>Any physical evidence presented by prosecution or defense is "99 times out of 100" (only slightly exa ;) of no merit just of argument.</p>

<p>There are a whole host of reasons from human failings down to the laws of time and physics.</p>

<p>For instance,</p>

<p>Evedentiary chains are just myths that lend some psudo scientific mumbo jumbo to the procedings.</p>

<p>The simple fact is that you have paperwork saying something has... what proof is there, only the word of a human who is reliant on the words of other humans and so on up the chain. At any point somebody could have made a mistake and just not seen it or cared to see it or for other reasons reported things in a maner that lends the incorect burden to the evidentiary item.</p>

<p>At the other end you have a "signal to noise" issue which is equivalent to seeing paterns in clouds or the static on a TV screen when it's not tuned in.</p>

<p>Scientific tests under ideal conditions (noise less than signal level) have a sensitivity where they will pickup single molecules of chemicals and amplify the signal to the point it can be measured.</p>

<p>But you have to ask two questions,</p>

<p>What is the signal to noise prior to amplification?</p>

<p>Can the test reliably detect the difference between a signal and the noise at the ratio present when taking the measurment?</p>

<p>The majority of these tests have two charecteristics, the first is that they destroy what they are measuring, the second is the output of the amplification is effectivly hard limited prior to measurment.</p>

<p>For instance DNA the process of testing boils down to the following steps,</p>

<p>0, Obtain sample.<br />
1, Transport sample to test.<br />
2, Chop sample up into small pieces<br />
3, Replicate the small pieces tens of millions of times.<br />
4, Use an overly time, and energy sensitive test to produce a chart.<br />
5, Compare the resulting chart with another chart.</p>

<p>The chain of evidence documentation says absolutly nothing about,</p>

<p>0, How the sample was actually obtained (not the standard procedure used or the quality controls used in the process).</p>

<p>1, How the sample was transported if it was subject to cross contamination or degredation by energy (light, temprature, preasure, sound, RF...) or time.</p>

<p>2, How the sample was purified before being irevocably being choped up along with anything else that was present (ie the noise).</p>

<p>3, How the amplification works with impure or damaged samples. Ie does it have a prefrence factor which would skew results in the presance of noise.</p>

<p>4, Again how linear is the test and what are it's sensativities, how relaiable are control markers etc.</p>

<p>5, Now how is the comparison between the chart of data taken from a noisy environment (at scene) and the chart of data taken from a quiet environment (swab of suspect).</p>

<p>If you start asking these quite reasonable questions in a court the judge will not take kindly. They will turn around and say that you are wasting the courts time, as such matters are of "established fact"...</p>

<p>Oh and in the UK judges take a very dim view of defence council "beating up" on "Expert witnesses" as it "confuses the tribunal" (but not if it's of "truth" or "law")and the expert is technicaly a court officer...</p>

<p>So your expert witness gives "opinion" this is actually "hearsay" which would normaly be barred from being heard by the jury (tribunal of truth) by the judge (tribunal of law).</p>

<p>However it is alowed providing "in the courts view" the person is "of sufficient standing" to present "opinion" and sufficiently well versed as to not show prejudice in their presentation of "hearsay" as "facts"...</p>

<p>In the UK we currently have a number of cases under review due to Prof Roy Medows who to put it bluntly provided biased and unsubstantiated whims and bad science as "excepted practice in the field"...</p>

<p>He is not the only such expert witness (Walter Mitty type) to come under the spotlight in recent times.</p>

<p>At the end of the day the jury judge performance of the players and the judge assesses the quality of the presentation. Nobody actually judges the evidence...    </p>
</div></article>



<article><div class="comment by-moz" id="c371869">


<p class="commentcredit"><span class="commenter">moz</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371869">May 14, 2009  1:52 AM</a>
</p>

<p>Used properly Lint is part of a whole process in which the you write in a limited C-like (C-subset really) language less likely to contain errors.  Obviously if software hasn't been written in "Lint-C" it will fail lots.  However this doesn't make the test invalid.  The defence in a legal case has the job to show doubt.  The answer to 19K 'potential errors' is to show a different software engineering methodology which rules most/all of them out as errors.  In the absence of that methodology there's no simple mechanical way to know which errors are errors and which are not.  It's the prosecution's job to prove each one individually is not an error.  Suggesting that a defendant should have to worry about that kind of difficult task is unfair.  There's nothing wrong with quoting this number since it shows the impossibility of the court being sure the defendant has been justifiably prosecuted.</p>
</div></article>



<article><div class="comment by-alex" id="c371870">


<p class="commentcredit"><span class="commenter">Alex</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371870">May 14, 2009  1:55 AM</a>
</p>

<p>Bruce, you appear a to be a bit behind with your reading. The Base One report is two years old....</p>
</div></article>



<article><div class="comment by-bob" id="c371924">


<p class="commentcredit"><span class="commenter">bob</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371924">May 14, 2009  6:44 AM</a>
</p>

<p>Nobody but me vomiting uncontrollably over the "new one is better because it uses Windows" part? Well, if it was Vista maybe it would be better because then it would hang up and refuse to give any answer at all for hours, then it would intentionally reduce the accuracy of the results because MS could not see where the person being tested had paid a DRM fee for the use of the device that day by which time you would be completely sober and could demand a blood test instead.</p>

<p>One of the times I was on a jury one of the other jurors kept saying over and over that the defendant must be guilty because if he was innocent he would have taken the stand and stated such. I kept pointing out the fact that the rule in the US is (was) a presumption of innocence and that the Bill of Rights (back when it was in effect) states explicitly that you do not have to testify, but he just held his position. I suspect that most people believe the same as he did, they just dont say so. Cant wait until people try to cross-examine a poorly designed piece of software which is damning them and have THAT get by these jurors. I imagine their position will be "the box said so so it must be true".<br />
</p>
</div></article>



<article><div class="comment by-tom-welsh" id="c371944">


<p class="commentcredit"><span class="commenter">Tom Welsh</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371944">May 14, 2009  7:51 AM</a>
</p>

<p>'Removing the error messages "now that the program is working" is like wearing a parachute on the ground, but taking it off once you're in the air'.</p>

<p>- Kernighan & Plauger [Software Tools]<br />
</p>
</div></article>



<article><div class="comment by-sooth-sayer" id="c371958">


<p class="commentcredit"><span class="commenter">sooth sayer</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371958">May 14, 2009  8:58 AM</a>
</p>

<p>Maybe the programmers were drunk while coding?</p>

<p>There is a lot of crap out there in industrial products - I am not very surprised.</p>
</div></article>



<article><div class="comment by-john-leach" id="c371983">


<p class="commentcredit"><span class="commenter"><a title="http://geekz.co.uk/schneierfacts" href="http://geekz.co.uk/schneierfacts" rel="nofollow">John Leach</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c371983">May 14, 2009 10:14 AM</a>
</p>

<p>Bruce Schneier fact #1302:</p>

<p>Bruce Schneier never gets a speeding ticket because the camera manufacturers don't want to have to show him their source code in court.</p>

<p><a href="http://geekz.co.uk/schneierfacts/fact/1302" rel="nofollow">http://geekz.co.uk/schneierfacts/fact/1302</a></p>
</div></article>



<article><div class="comment by-escapedwestofthebigmuddy" id="c372001">


<p class="commentcredit"><span class="commenter">EscapedWestOfTheBigMuddy</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372001">May 14, 2009 12:15 PM</a>
</p>

<p>There are a whole slew of manufacturers out there who produce embedded medical devices. Glucometers (blood sugar meters) would seem to be a good analogy to breathalizers. I would be very interested in knowing what kind of process these companies use for code production and review, and how it compares to that used by breathalizer makers. </p>

<p>[ rant ]<br />
That said, I know (from device-to-device and device-to-blood-draw tests) that some OTC glucometers are well calibrated for high values and ill calibrated for low values. This appears to be a deliberate decision on the part of the manufacturer. Presumable they figure that most of their customers are Type II, and have more trouble with highs than lows.  But they won't admit to it, which leaves Type I's with a false impression of what the meter will do for them...</p>

<p>Worse still, these widgets appear to have power processors and copious memory, so they could fix it in software if they cared...<br />
[ /rant ]</p>
</div></article>



<article><div class="comment by-anna" id="c372009">


<p class="commentcredit"><span class="commenter">Anna</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372009">May 14, 2009  1:09 PM</a>
</p>

<p>@FP- Catastrophic Error Detection Is Disabled.  The new machine could have been successfully tested under ideal conditions.  Then, is is left in a hot or freezing car for years, it gets dropped a few dozen times and rained on a bit.  Unless the machine is regularly tested under less than ideal conditions it'd be tough to accept the tests.</p>
</div></article>



<article><div class="comment by-juergen" id="c372011">


<p class="commentcredit"><span class="commenter">Juergen</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372011">May 14, 2009  1:13 PM</a>
</p>

<p>Looks like normal sloppy coding for a non-safety critical embedded device.</p>

<p>So the problem is that there doesn't seem to be a required quality standard for software that produces legal evidence, requiring for example</p>

<p>- disclosure of the source code<br />
- a decent quality standard and software development process as required for safety-critical devices<br />
- an audit trail from the pre-average raw values to the final computed result<br />
- in this special case making sure that blood alcohol is either underestimated or no value is produced in case of problems<br />
</p>
</div></article>



<article><div class="comment by-rich-gibbs" id="c372030">


<p class="commentcredit"><span class="commenter">Rich Gibbs</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372030">May 14, 2009  2:09 PM</a>
</p>

<p>@FP: "Just like a drug manufacturer does not have to open-source their drugs but only has to demonstrate to the FDA that the drug is effective across a somewhat representive cross-section of humanity."</p>

<p>They don't have to open-source the drug, in the sense of allowing other people to make it, if it's patented.  But if it's patented, the formulation of the drug has to be disclosed in the patent.  You (I hope) can't patent table salt as a treatment for cancer, because no one would believe that it worked. <br />
 <br />
Similarly here, the manufacturer does not have to put the code under the GPL (let's say) in order for it to be examined.  They would still have the copyright and could license it under any terms that they can persuade people to agree to.</p>
</div></article>



<article><div class="comment by-aegeus" id="c372036">


<p class="commentcredit"><span class="commenter">Aegeus</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372036">May 14, 2009  2:30 PM</a>
</p>

<p>The loss of precision when the input is divided by 256 would only happen if they were using integer division, right?  I find it hard to believe that the breathalyzer only outputs 8 different values.</p>
</div></article>



<article><div class="comment by-jeff-bell" id="c372039">


<p class="commentcredit"><span class="commenter">Jeff Bell</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372039">May 14, 2009  2:53 PM</a>
</p>

<p>What in the world is an Atari style chip?</p>

<p>Did they mean a 6502?</p>

<p>Maybe "Atari style" sounded more unreliable than an "Apple II style"?<br />
</p>
</div></article>



<article><div class="comment by-observer" id="c372043">


<p class="commentcredit"><span class="commenter">Observer</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372043">May 14, 2009  3:06 PM</a>
</p>

<p>"For instance DNA the process of testing boils down to the following steps"</p>

<p>Being someone who's actually read some of the research behind modern DNA analysis and it's use for forensics, your post is probably the most uneducated thing I've seen on the internet all day.</p>

<p>(Bruce's original post is pretty bad too.  Surely he should know better than to trust everything an pay-us-and-we'll-say-anything source states, especially when even the claims he cite contain obvious errors?)</p>
</div></article>



<article><div class="comment by-mike" id="c372049">


<p class="commentcredit"><span class="commenter">Mike</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372049">May 14, 2009  3:20 PM</a>
</p>

<p>All I want for any of these things--breath alcohol testers, voting machines, ATMs, etc--is for them to be as carefully monitored and tested as slot machines.  The code on those is actually audited by gaming authorities (Nevada is really good at this.)  There's tons and tons of regulations and periodic testing, and everything is audited.</p>

<p>Open code is probably even more important for matters of personal criminal activity or voting, but at the minimum if a credible agency had complete access to the code and could audit its operation with a valid testing matrix, that would be helpful.</p>
</div></article>



<article><div class="comment by-khb" id="c372061">


<p class="commentcredit"><span class="commenter">khb</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372061">May 14, 2009  4:05 PM</a>
</p>

<p>No doubt the "reason" for their averaging technique was not wanting to have a buffer for all the input values. However, they could have used a "kalman filter" style recursion. Using awkish notation<br />
xbar=0.; sig2=0.; delta=0.<br />
{<br />
delta = $1 - xbar ; xbar = xbar+delta/NR; <br />
if (NR > 3) { sig2=(NR-2)/(NR-1) * sig2 +delta*delta/NR}<br />
}<br />
This requires no memory buffer, probably requires a few more values to converge to the "true" estimates (that you'd get with a buffer) but I imagine they are capable of taking hundreds of samples in a few seconds rather than just using 5 or so</p>
</div></article>



<article><div class="comment by-andy" id="c372064">


<p class="commentcredit"><span class="commenter">Andy</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372064">May 14, 2009  4:11 PM</a>
</p>

<p>Draeger triggers a deja-vu. Dräger as we write it in German was a reference customer of my former employer.<br />
Guess what they build (handycraft?) too? Yes, airpacks, scuba-dive devices.</p>

<p>I'm kind of scared...<br />
~Andy</p>
</div></article>



<article><div class="comment by-gil" id="c372074">


<p class="commentcredit"><span class="commenter">Gil</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372074">May 14, 2009  4:52 PM</a>
</p>

<p>From reddit: This article is a piece of junk.</p>

<p>Most of these comments are quibbles.</p>

<p>1) The averaging algorithm sounds to me like a "running average" algorithm, used to construct a running average over time when you have an unknown number of incoming samples. Furthermore, mlw72z (see below) gave some rationalization to make the last sample more important than the first.</p>

<p>2) Results limited to small, discrete values: This is normal for sensors. A pregnancy test takes a large amount of input, the levels of various hormones, and tries to return a small, discrete value: Pregnant or Not.</p>

<p>So summarizing the output to small, discrete values is indeed the expected behavior of a sensor.</p>

<p>3) Removing the crash detector: many embedded systems remove these interrupts, as they can test every possible code branch, unlike larger and more generally unstable systems like windows PCs.<br />
</p>
</div></article>



<article><div class="comment by-carsten" id="c372083">


<p class="commentcredit"><span class="commenter">Carsten</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372083">May 14, 2009  5:03 PM</a>
</p>

<p>The code-review has some translations from german to english which sounds like the good old Altavista bablefish.</p>

<p>Messablauf was translated as 'measure expiration', but this ablauf has nothing to do with expiration. It means the processing of the measurement. I'm not sure about the correct translastion, but 'measurement processing' should describe it good enough.</p>
</div></article>



<article><div class="comment by-flug" id="c372084">


<p class="commentcredit"><span class="commenter">flug</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372084">May 14, 2009  5:07 PM</a>
</p>

<p>"The specific problem here is illustrated by the second bucket in the 8 discrete measures scenario: that bucket spans a large conversion domain from 0.0625 (legal, most states) to 0.125 (illegal, most states)."</p>

<p>The interesting thing (it seems, based on the very limited info in Bruce's summary) is the very large discrete steps it actually measures (#3), are being covered up by the smoothing/averaging scheme (#2).</p>

<p>Thus, even though the machine is actually measuring in large, discrete steps the display will show various values in between the discrete values because of the averaging scheme.</p>

<p>I would guess that if your actual alcohol level is somewhere between two of the discrete values, what happens is the actual value sort of pops back and forth between the two nearest values.</p>

<p>So you're getting a stream of data something like this:</p>

<p>0.0625 0.125 0.125 0.125 0.0625 0.0625 0.125 0.125 0.125 0.0625 0.125 0.0625 0.125 0.125 0.0625 0.125 0.125 </p>

<p>Then the averaging scheme kicks in and so the display seems to converge to a single number somewhere in between the two values.</p>

<p>This strikes me as not the most reliable way to determine the actual value for those 'in between' values.  (However it might not be that bad--you'd have to do some controlled tests to see.  It could easily have some systematic bias in certain ranges.)</p>

<p>Also one reason they likely came up with the averaging scheme is without the display would leap around in a very discontinuous way.  </p>
</div></article>



<article><div class="comment by-jeff" id="c372087">


<p class="commentcredit"><span class="commenter">Jeff</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372087">May 14, 2009  5:11 PM</a>
</p>

<p>It may be useful for the algorithm to give more weight to samples at the end.  Presumably the most accurate samples will be from the air at the bottom of your lungs as you finish exhaling.  Whether that weighting was by design or not... who knows?</p>
</div></article>



<article><div class="comment by-ech" id="c372090">


<p class="commentcredit"><span class="commenter">ech</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372090">May 14, 2009  5:19 PM</a>
</p>

<p>"There are a whole slew of manufacturers out there who produce embedded medical devices. Glucometers (blood sugar meters) would seem to be a good analogy to breathalizers. I would be very interested in knowing what kind of process these companies use for code production and review, and how it compares to that used by breathalizer makers."</p>

<p>I haven't worked in medical device software in quite a while, but the FDA has standards for software in medical devices. IIRC, they get to look at the source code. Here is one of their guidance documents:<br />
<a href="http://www.fda.gov/cdrh/comp/guidance/938.html" rel="nofollow">http://www.fda.gov/cdrh/comp/guidance/938.html</a></p>
</div></article>



<article><div class="comment by-syfran" id="c372102">


<p class="commentcredit"><span class="commenter"><a title="http://syfran.com" href="http://syfran.com" rel="nofollow">syfran</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372102">May 14, 2009  6:22 PM</a>
</p>

<p>These companies should be required to release their source code as a standard. It would provide the accountability that is need in this sort of environment. Only exceptions that should be made are with national security, in that case it should be frequently reviewed by trusted sources. </p>

<p>I wrote a full article on the topic here <a href="http://syfran.com/component/content/article/5-linux/12-is-open-source-the-answer-for-quality-government-software" rel="nofollow">http://syfran.com/component/content/article/5-linux/12-is-open-source-the-answer-for-quality-government-software</a><br />
</p>
</div></article>



<article><div class="comment by-susan" id="c372107">


<p class="commentcredit"><span class="commenter">Susan</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372107">May 14, 2009  6:48 PM</a>
</p>

<p>I am a software engineer and, unfortunately, I see code like this all the time. Even in medical devices! Software engineers skip the most fundamental of practices: coding standards, code reviews, static analysis tools, etc. that would catch a majority of problems like these. It is time the software engineering field grew up!!!</p>
</div></article>



<article><div class="comment by-nemo" id="c372108">


<p class="commentcredit"><span class="commenter">Nemo</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372108">May 14, 2009  6:51 PM</a>
</p>

<p>Someone please name one instance where this test was contradicted by another device or blood test?<br />
</p>
</div></article>



<article><div class="comment by-gavin" id="c372109">


<p class="commentcredit"><span class="commenter">Gavin</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372109">May 14, 2009  6:53 PM</a>
</p>

<p>@John D The timeline is off, but the theme you describe is similar to "Little Brother" in Walter Mosely's Futureland<br />
</p>
</div></article>



<article><div class="comment by-simmee64" id="c372115">


<p class="commentcredit"><span class="commenter">Simmee64</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372115">May 14, 2009  8:03 PM</a>
</p>

<p>This just goes to prove the following: you should not use machines for voting and all software in things like breath testers should be transparent. I am not surprised that the code is a mess, I would be willing to bet that the code in Diebold's (or what ever they are called now)voting machine is a mess as well.</p>
</div></article>



<article><div class="comment by-booyah" id="c372117">


<p class="commentcredit"><span class="commenter">booyah</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372117">May 14, 2009  8:09 PM</a>
</p>

<p>Definitely need this type of investigation on voting machines. I don't understand how voting machine software can be proprietary when we actually pay for them with our taxes. Not to mention the fact that the only math a voting machine should ever do is plus-1. There should be no subtraction, multiplication or division, ever!! Seriously, how hard or complex can $candidate++ actually be.</p>
</div></article>



<article><div class="comment by-brian-tung" id="c372118">


<p class="commentcredit"><span class="commenter">Brian Tung</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372118">May 14, 2009  8:19 PM</a>
</p>

<p>@khb: Wouldn't it be simpler to simply do something like the following?</p>

<p>for (count = 0; sample = getSample(); count++)<br />
    avg = (avg*count+value(sample))/(count+1);</p>

<p>This computes a running average with equal weights without resorting to a Kalman filter.</p>

<p>@Gil: I'm assuming you're just quoting reddit, because those are just weird defenses of the software.  Imagine if your digital scale quantized its results into {weightless, non-weightless}.</p>

<p>@flug: The averaging scheme apparently used by the vendor would be subject to *more* "jumping around" than a constant-weighting averager, not less.</p>

<p>As to whether it could produce a valid result, given enough samples, it should be relatively easy to show that it wouldn't do so in general unless the measurement error had some pretty unusual characteristics.  It would, I think, give correct results *in general* if the measurement error were uniformly distributed over an interval that was a (non-zero) multiple of 0.0625, centered at 0, and the representative values were at the center at their respective ranges (e.g., the machine measures 0.0625 for true values between 0.03125 to 0.9375), but not otherwise.  Of course, it might give correct results for isolated true values in any event, but that hardly justifies what they do.</p>

<p>@Jeff: I think the best you could say is that it wouldn't affect the answer.  Even if the physiology justified it, the odds that this particular exponential weighting is optimal are pretty low.  It might make more sense, rather, to use constant weighting, but to ignore the first N values, where N is determined through testing.  Better yet, the actual weighting scheme should be determined through testing.</p>
</div></article>



<article><div class="comment by-brian-tung" id="c372120">


<p class="commentcredit"><span class="commenter">Brian Tung</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372120">May 14, 2009  8:27 PM</a>
</p>

<p>@booyah: I'm sure the fundamental operation of an electronic voting machine is pretty simple.  Ostensibly, the complexity arises when you try to make the machine tamper-proof and self-checking.  That's not to defend the performance by Diebold et al., but I do think there's more to it than candidate.incrementVote().</p>
</div></article>



<article><div class="comment by-tj" id="c372124">


<p class="commentcredit"><span class="commenter">TJ</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372124">May 14, 2009  9:01 PM</a>
</p>

<p>When you rely on a machine to decide whether to ruin someone's life, you've already made an egregious error ... whether or not it's "accurate".</p>

<p>How many people will swear that Lie Detectors (note authorative caps!) can actually detect lies accurately? Yet their "testimony" was relied on *long* before there was science to decide their legitimacy.</p>

<p>Anyway ... law enforcement is a highly subjective field that's hardly consonant with the use of machines to give primitive (but SCIENTIFIC!!) indicators about complex questions.</p>
</div></article>



<article><div class="comment by-steve" id="c372125">


<p class="commentcredit"><span class="commenter">Steve</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372125">May 14, 2009  9:03 PM</a>
</p>

<p>I've seen averaging (actually, more accurately, I suppose, weighting) schemes like the one discussed above in image processing applications, mostly for noise reduction in systems where you have a limited number of buffers and a limited dynamic range.</p>

<p>Yes, it gives more weight to the last reading than previous readings, so that the earliest readings eventually slide off the end after a number of iterations.<br />
</p>
</div></article>



<article><div class="comment by-bob-s" id="c372131">


<p class="commentcredit"><span class="commenter">Bob S</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372131">May 14, 2009  9:50 PM</a>
</p>

<p>I also fear that Scared may have had it right yesterday. As implemented, the averaging process will tend to make it feasible to keep taking new measurements until random variation among the measurements gives you a result along the lines of what you're looking for.</p>

<p>Ordinary averaging would halve the measurement-error variance in your estimate of the mean (presumably true) breath alcohol level each time you double your number of measurements. In contrast, the averaging process as implemented would tend to cause the error in the estimate of breath alcohol level to approach (as the number of measurements approaches infinity) one-half that of an ordinary sample comprising just two measurements--or some value not very different from that.</p>
</div></article>



<article><div class="comment by-nl" id="c372134">


<p class="commentcredit"><span class="commenter">NL</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372134">May 14, 2009  9:52 PM</a>
</p>

<p>It is horrible that this device is used to ruin many lives, but is this really surprising?  They just exposed the dirty-little-secret of most software development efforts to the general public.  When it comes to creating software, it is usually more about making money than it is about quality of the product.</p>

<p>People really need to stop drinking and driving though. </p>
</div></article>



<article><div class="comment by-dex" id="c372138">


<p class="commentcredit"><span class="commenter">Dex</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372138">May 14, 2009 10:29 PM</a>
</p>

<p>I work with medical software. FDA isn't really interested in the source code. They are interested in the company's internal quality protocol with documentation that shows that software has been planned, documented, and tested.</p>

<p>In the end, it doesn't tell much about the actual quality of the code. Seeing a bunch of unit tests pass at 100% is certainly good enough for FDA. I've never seen an FDA auditor actually even peek at what the unit tests do.</p>

<p>There's really no way they'd ever get to know about Lint warnings, missing watchdogs, or even bad averaging algorithms. Unless the functional tests fail in spectacular ways or enough customers make official complaints to warrant a deeper investigation.</p>
</div></article>



<article><div class="comment by-stevec" id="c372143">


<p class="commentcredit"><span class="commenter">SteveC</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372143">May 14, 2009 11:02 PM</a>
</p>

<p>We don't really need to know how the code works if the box can produce controlled and reproducible results. Being able to 'calibrate' the unit to reliably produce PASS/FAIL results is all you need.</p>

<p>If you are going to make a big issue of the accuracy and resolution of the system, you have to consider ALL the factors in determining the result - such as blood-lung permeability for alcohol transfers, the capabilities of the mechanics to accurately transfer the exhaled breath to the sensor, the accuracy of the sensor in various chemical environments (think garlic sausage burp!), the analogue to digital processing and the screen representation. Furthermore, this is a piece of field equipment and subject to wide range of temperature, humidity, vibration conditions as well as pocket lint, dirt, and all that sort of stuff. If you cannot control these elements with precise and consistent accuracy then there is no point arguing about fine detail. It's a bit like complaining about the length of a meter of cloth because it was not measured with a micrometer, or measuring the vehicle battery voltage with a 4 1/2 digit multimeter, or complaining because your gas tank only shows 1/4 tank increments.<br />
In Australia, as in other parts, a conviction is recorded on a blood alcohol test. The breath test is just to triage the likely suspects from those under the limit and so the test does not have to have laboratory accuracy.</p>

<p>Don't get too hung up on the averaging either. The program would most likely have been written in assembler for a processor with 16 bit registers. The moving average solution that was applied would be a reasonably simple programming exercise without requiring additional programming gymnastics to calculate the average in a more conventional sense in order to produce a result that, ultimately, did not require that level of precision.<br />
</p>
</div></article>



<article><div class="comment by-simon" id="c372145">


<p class="commentcredit"><span class="commenter">simon</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372145">May 14, 2009 11:06 PM</a>
</p>

<p>I think two comments above raise the real issue; which is are the assumptions behind the math and science right.  </p>

<p>Even if the signal is being computed correctly, regardless of interrupts/timers etc.., and there is a 60% (random) chance of being in illegal between .06-1% (remember these machines were developed when a DUI was a 1.25%), and the conviction value is 0.8, then something is clearly wrong, not just compiler errors, but in methodology.</p>

<p>The assumptions the software was built upon do not conform to the legal standard.</p>

<p>I'd rather the cop flip a coin flip.  Odds are better.  Maybe two-face had the right idea.</p>
</div></article>



<article><div class="comment by-simon" id="c372146">


<p class="commentcredit"><span class="commenter">simon</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372146">May 14, 2009 11:10 PM</a>
</p>

<p>edit: corrections for readability..</p>

<p>I think two comments above raise the real issues; the first is whether the assumptions behind the math and science right, assuming the code is perfect:</p>

<p>If the signal is being computed correctly, regardless of interrupts/timers etc..., there is a 60% (random) chance of being between .06-1% (remember these machines were developed when a DUI was a 1.25%), and having that output as a 1.0.  The current DUI value is 0.8. Something is clearly wrong, not just compiler errors, but in methodology when you have a 60% change of being guilty.  This is the false positive rate.  These are measured by calibration protocols, which it would be interesting<br />
to see what they calibrate too, and if the machine is aware of the calibration (special routines).</p>

<p>The assumptions the software was built upon do not conform to the legal standard.</p>

<p>I'd rather the cop flip a coin. Odds are better. Maybe two-face had the right idea.<br />
</p>
</div></article>



<article><div class="comment by-clive-robinson" id="c372147">


<p class="commentcredit"><span class="commenter">Clive Robinson</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372147">May 14, 2009 11:11 PM</a>
</p>

<p>The odd "average" may be due to trying to get around a hardware sensor problem (no I'm not defending just saying insufficient info to judge fairly).</p>

<p>Oh and what is an average any way, there appears to be more of them than your average girl about town has shoes...<br />
 <br />
If you assume that your breath is a little under 37C and outside at night in North EU is rarely above 15C and can be lower than -20C frequently. You have a very real issue of a lot of significant temprature change in three to six seconds or so which is a very awkward design issue at the best of times.</p>

<p>So if you blow across a "silicon" type detector you would expect to see a curve where the latest readings should be given more weight than previous.</p>

<p>Further to get cost size and weight down, as well as battery life up (and MTBF figures) you generaly try to minimise the component count.</p>

<p>So the "average" could not only be trying to track sensor offset but also be trying to do "DC" offset correction for changing battery voltage as well...</p>

<p>You would need the spec sheets on the sensors used as well as the actual circuit diagram to have a chance at making a valid judgment call.</p>

<p>With regards the actual sampling to get accurate results, have a look into "over sampling" and "dither".</p>

<p>You would be surprised at just how many extra bits of valid data you can wring out of repeated samples and random (ish) sample points.</p>

<p>There for the "odd average" could actually be aproximating two or more different averages in one. A slow average (low pass) to get the DC or temprature offset and a medium speed average (band pass) to get the measurment resolution up and a high speed average (high pass) to detect interferance / readings not valid state (yes I'm guilty of this sort of sin in medical, and other related equipment.  Diathermy and de-fib machines play hell with patient monitoring systems as they can dump joules of energy onto long sensor cables at unexpected times).<br />
 <br />
As anyone who has had to design RTOS or embeded systems based around analogue sensors in the late 80's early 90's will know first you wrote understandable top down code tested it block by block bolted it all to gether, then you squished it down to make it fit the available resources and (should have) then regression test to check it was still working to spec.</p>

<p>How ever depending on who you listen to and what technology area you work with hardware resources overall tend to double around every 18 months (individual items faster or slower).</p>

<p>However software development on embedded systems can take over three years if starting from scratch on a moderatly complex but fairly harmless item like a cordless phone, longer on more safety critical or higher reliability products.</p>

<p>So major "code re-use" is where it is at in embeded system design.</p>

<p>Unfortunatly (puts on old grumpy hat and effecting Grand Pa Simpson voice as befitting status ;) the young whipersnapper code cutters of today driven by hop head no nothing crazed marketing types are not interested in product that does what you would hope as a customer but product that sells at good margin in their pay packet...</p>

<p>So software, like the old battered and nearly worn out kindergarden building / alphabet blocks, just keeps getting stack up in new and wildley different ways by young and eager hands until it falls over (or blows up on the launch pad / shortly after take off) or the owners of the young and eager hands lose interest and toddle off to go tourture the cat etc.</p>

<p>Remeber folks that the RTOS/Embedded code you write today be it right or wrong will still be around to cause you (and others) sleepless nights when you are a grey grizzeled old engineering manager being wheeled in and out of your box to various design meetings. And unfortunatly long after you can remember the why let alone the how of it, some thirty years after that night you wrote it and thought it "neat / cool"...</p>

<p>And as for all those tools currently loved by business managment and consultants such as "lean" "Six Sigma" etc that supposadly came from engineering and manufacturing roots do not realy resolve the fundemental problems involved just make them happen faster and encorage people to move on even quicker (best time CV wise to move is about 20% of the time into the project you can claim all sorts of things and get away with it)...<br />
 <br />
As has been noted "Old hardware goes the way of any bucket full of WEEE, but software like roaches just never goes awy no matter how many bugs you squash". </p>
</div></article>



<article><div class="comment by-clive-robinson" id="c372149">


<p class="commentcredit"><span class="commenter">Clive Robinson</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372149">May 14, 2009 11:25 PM</a>
</p>

<p>@ Observer,</p>

<p>"Being someone who's actually read some of the research behind modern DNA analysis and it's use for forensics, your post is probably the most uneducated thing I've seen on the internet all day."</p>

<p>When you where trolling around doing your reading on research, did you happen to check how much of it is actually being used today or five or ten years ago (which is still current in court terms)?</p>

<p>Oh and perhaps you would like to have a go at providing a brief ovreview of the process without jargon, and then identifying the attendent flaws with each stage?</p>

<p>It should make interesting reading. </p>
</div></article>



<article><div class="comment by-math-is-fun" id="c372151">


<p class="commentcredit"><span class="commenter">Math is fun</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372151">May 14, 2009 11:39 PM</a>
</p>

<p>@Aegeus, who wrote "I find it hard to believe that the breathalyzer only outputs 8 different values."</p>

<p>I think that's 8 discrete values BEFORE averaging.  The assumption is that the sensor is producing non-identical values as the air flows by.  Those are then averaged (with some weighting).<br />
</p>
</div></article>



<article><div class="comment by-ianal" id="c372152">


<p class="commentcredit"><span class="commenter">IANAL</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372152">May 14, 2009 11:42 PM</a>
</p>

<p>I certainly don't condone drunk driving but if I were defending people with DUI's I would hate the code being released. I would rather have them keep it a secret and get my clients off because the accuracy of the deviced could not be verified. Sure, having the code released makes them look bad and is good for getting current convictions overturned but this just means that better code is going to be written and implemented in the future which is going to make breath tests more valid as evidence of drunk driving.</p>
</div></article>



<article><div class="comment by-anonymous" id="c372153">


<p class="commentcredit"><span class="commenter">Anonymous</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372153">May 15, 2009 12:12 AM</a>
</p>

<p>@</p>

<p>"We don't really need to know how the code works if the box can produce controlled and reproducible results. Being able to 'calibrate' the unit to reliably produce PASS/FAIL results is all you need."</p>

<p>There are a couple of issues here, the fisrst is PASS/FAIL from what has been said so far on this blog the reliability of this device is the equivalent of blindly tossing a coin. So it would appear that it can not "produce controlled and reproducible results" (nor that any tests have been done to verify either way).</p>

<p>The second issue is more important.</p>

<p>As you say,</p>

<p>"In Australia, as in other parts, a conviction is recorded on a blood alcohol test. The breath test is just to triage the likely suspects"</p>

<p>Unfortunatly this is changing, in some parts of the world the system is being moved away from "justice at any cost" to "conviction on the cheep".</p>

<p>In the UK we have removed the option for trial by jury from many types of crime, removed the oportunity of many to get legal aid to defend themselves.</p>

<p>Oh and we have a model of if you pay now it's X but if you argue it starts at 2X pluss costs for motoring offences recorded by automatic technology.</p>

<p>What has been shown with this is where people have the gumption to chalenge 80-90% get over turned. </p>

<p>Now I know you should not argue backwards about specifics from that result but I think it is an indicator that something is wrong with the system and it needs to be looked at.</p>

<p>Oh and one thing the brakes in your car may well use a microprocessor. What level of not working are you prepared to accept on them?</p>

<p>Once in a hundred million times you put your foot on, one in a million or how about one in ten thousand?</p>

<p>Currently most embeded software has an "unknown" fail rate nearer one in ten thousand than a hundred million...</p>

<p>This is often due to inter action between interupts and main flow and is very very difficult to test for as the window of oportunity could be just a few micro seconds in duration on events that might happen once or twice a day. A classic example is having two instructions swapped over such as disabaling an interupt and clearing a flag, that effectivly renders an input or process disabled untill some other event happens (key debounce being a not unknown issue in this regard or the runaway mouse seen in Windows XP and Vista due to driver software issues).</p>

<p>Now if you take the number of cars in Australia and the number of times a day a driver put's their foot on the brake on avarage how many days or part days do you think it would take to get to one hundred million brake peddle uses?</p>

<p>And if the brakes do fail on a car what are the odds of it ruining the drivers life within society?</p>

<p>As a "drunk in charge" or whatever it is called in your juresdiction conviction can and often does ruin a drivers life due to loss of job / income standing in the community etc,</p>

<p>Would it be unfair to ask that the machine be atleast as reliable in operation as the foot brake of a car?</p>
</div></article>



<article><div class="comment by-bob-s" id="c372154">


<p class="commentcredit"><span class="commenter">Bob S</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372154">May 15, 2009 12:13 AM</a>
</p>

<p>As described, the averaging algorithm isn't a moving average (although I guess you could call it an expanding average). Perhaps the description is mistaken. However, it calls the algorithm an  incorrect calculation and goes on to describe what is, in fact, an incorrect calculation regardless of whether it was intended to be a moving average or a simple average that's updated upon the arrival of new observations.</p>

<p>The idea voiced by some that an algorithm can be ok, even if it's wrong, as long as it passes acceptance tests is mistaken. An important reason for making sure of the correct implemention of an algorithm is to ensure that the device being controlled performs correctly and predictably over its full range of inputs, not just in the necessarily restricted sample of conditions employed in acceptance testing. (Think encryption, for example.)</p>
</div></article>



<article><div class="comment by-simontewbi" id="c372161">


<p class="commentcredit"><span class="commenter">SimonTewbi</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372161">May 15, 2009  1:12 AM</a>
</p>

<p>@Eric in PDX, RE: Speed Cameras:  Maybe 10 or 12 years ago in New Zealand an electronic engineer or physicist (can't remember the details) was given a speeding ticket.  Rather than roll over and pay up he elected to fight it in court.  He was able to show that with sunlight reflecting at just the right angle off the car the speed camera (or radar gun, can't remember) would give a significantly incorrect reading.  The police dropped the case before the judge could rule as they didn't want a court ruling stating that their equipment was inaccurate.</p>
</div></article>



<article><div class="comment by-swa" id="c372221">


<p class="commentcredit"><span class="commenter">Swa</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372221">May 15, 2009  7:01 AM</a>
</p>

<p>For everyone saying that the last result has the most weight. NO. The first two are averaged. 50/50. That result is averaged. 66/33. That result is averaged. 75/25. That result is averaged. Each time the initial results have 50% of the upper average. So the initial results always have the plurality of the average used.</p>
</div></article>



<article><div class="comment by-sengan" id="c372242">


<p class="commentcredit"><span class="commenter"><a title="http://www.ansemond.com" href="http://www.ansemond.com" rel="nofollow">sengan</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372242">May 15, 2009  8:18 AM</a>
</p>

<p>Later readings count more. For 3 readings you get:</p>

<p>0.5 * ( 0.5 * (a + b) + c) = 0.25 * a + 0.25 * b + 0.5 * c</p>
</div></article>



<article><div class="comment by-swa" id="c372247">


<p class="commentcredit"><span class="commenter">Swa</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372247">May 15, 2009  8:24 AM</a>
</p>

<p>You're doing it wrong. They take an average. then the average of an average. Which is 50/50. 100/50, etc etc.</p>
</div></article>



<article><div class="comment by-difranco" id="c372265">


<p class="commentcredit"><span class="commenter">Difranco</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372265">May 15, 2009  9:11 AM</a>
</p>

<p>Attorney Lawerence Taylor at the DWI blog was hot on this back in 2007, for more commentary: <a href="http://www.duiblog.com/2007/09/04/secret-breathalyzer-software-finally-revealed/" rel="nofollow">http://www.duiblog.com/2007/09/04/secret-breathalyzer-software-finally-revealed/</a></p>
</div></article>



<article><div class="comment by-c" id="c372270">


<p class="commentcredit"><span class="commenter">C</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372270">May 15, 2009  9:54 AM</a>
</p>

<p>Oh how nice, always return a value. Doesn't matter how it does it, just that it does. </p>

<p>I'm all for getting drunks off the road. But if you have a system that could potentially let off the drunkards but convict the innocent then there is a huge problem.</p>

<p>For that reason I hope the manuefacturers are put out of business and charged. This level of negligence is unnacceptable. Hell, look at all the years they've had to make this product better and yet here, according to Base One, the code is still absolute garbage.</p>

<p>Its been said by many of you, I'll say it again. Situations like this is why we need transparency; it could have been avoided from the start.</p>
</div></article>



<article><div class="comment by-bob-s" id="c372296">


<p class="commentcredit"><span class="commenter">Bob S</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372296">May 15, 2009 11:52 AM</a>
</p>

<p>As originally described, the average of the first i measurements, mean(i), is incorrectly calculated:</p>

<p>mean(i) = [measurement(i) + mean(i-1)] / 2</p>

<p>The calculation should be:</p>

<p>mean(i) = [measurement(i) + (i-1) * mean(i-1)] / i</p>

<p>In response to a previous comment, note that the correct calculation requires nothing more in the way of resources than the incorrect calculation.</p>

<p><br />
 </p>
</div></article>



<article><div class="comment by-averros" id="c372334">


<p class="commentcredit"><span class="commenter">averros</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372334">May 15, 2009  4:12 PM</a>
</p>

<p>I was always wondering why driving while intoxicated is a crime when much more serious and dangerous condition called driving while stupid isn't?</p>
</div></article>



<article><div class="comment by-the-monster" id="c372338">


<p class="commentcredit"><span class="commenter"><a title="http://e3gazette.com" href="http://e3gazette.com" rel="nofollow">The Monster</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372338">May 15, 2009  4:57 PM</a>
</p>

<p>"Someone please name one instance where this test was contradicted by another device or blood test?"</p>

<p>The law in states where breathalyzers are used doesn't provide for another test to contradict the breathalyzer.  It is declared to be accurate by fiat, much like radar guns are presumed to be accurate even when used in moving patrol cars subject to "cosine error" or various other problems. </p>
</div></article>



<article><div class="comment by-brian-tung" id="c372339">


<p class="commentcredit"><span class="commenter">Brian Tung</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372339">May 15, 2009  5:01 PM</a>
</p>

<p>@averros: At the risk of painting with a broad brush, I'd say that driving a car, though it requires some modicum of intelligence, isn't rocket science.  It requires careful attention more than it requires abstract intelligence.  It relies on the same sort of 3-D tracking that allowed our ancestors to spear prey and avoid being eaten.  None of this is what we normally consider advanced skills.</p>

<p>Of course, if by "stupid" you mean "unwise to the point of driving while doing a New York Times crossword on the freeway," then actually some of that is illegal.  But not easily enforceable, though.</p>
</div></article>



<article><div class="comment by-roger" id="c372347">


<p class="commentcredit"><span class="commenter">Roger</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372347">May 15, 2009  6:01 PM</a>
</p>

<p>@The Monster:<br />
That might be true in some states, but it certainly is not in mine. Here a BAC is not accepted as evidence at all. Rather, a reading over the legal limit is normally followed up by a blood test. The blood test can be refused but that is deemed as admitting the breathalyser reading in evidence. (Lawyers recommend you always take the blood test, unless you know you had a large drink -- more than one "unit"-- in the last half hour. If you had, your BAC is probably still rising and the short delay before the blood test will likely give an even worse reading.)</p>

<p>If you had a drink very soon before the test the alcohol in your mouth will also elevate the results, and so in this state you also have the right to ask to repeat the test after waiting 15 minutes. If you don't want to wait, generally they will also allow to take it again after rinsing your mouth with water, and in my experience that works for removing mouth alcohol, but that one is at the officer's discretion.</p>

<p>Jurisdictions without an obligatory blood test usually have a second test at a "control machine" at the station, which is simply another breathalyser that is more carefully maintained and calibrated than the field units. It probably is more accurate than the field units but suffers the same systemic problems i.e. alcohol is not the only thing it detects. In many jurisdictions without obligatory blood testing, it can still be requested by the accused and will normally be provided more or less automatically; even in jurisdictions where the right to request a blood test is not legislated, a refusal by the police to provide the test will impair their case.</p>
</div></article>



<article><div class="comment by-john-q-smith" id="c372380">


<p class="commentcredit"><span class="commenter">John Q. Smith</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372380">May 15, 2009 10:00 PM</a>
</p>

<p>The averaging technique is the well-known exponential average.  Although personally, I think a weighting of 1/2 is too high.</p>

<p>The thing here is that if someone is going to be convicted on the sole evidence of a breathalyzer, then the breathalyzer has to be accurate "beyond reasonable doubt".  In fact, WELL beyond reasonable doubt, so there's room for some imperfection elsewhere in the prosecution.</p>

<p>Either that, or the claim of intoxication has to be supported by additional, independent evidence.</p>
</div></article>



<article><div class="comment by-bugsme" id="c372387">


<p class="commentcredit"><span class="commenter">bugsme</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372387">May 15, 2009 10:47 PM</a>
</p>

<p>Assuming the intent is to compute the "mean" of the samples, all you need is an accumulator and a counter.  Simply add each new sample to the accumulator and increment the counter.  When the timer dings, divide the sum by the count and you've got the mean.</p>

<p>Since the device has a known sample rate, and you have to blow into the sample tube for a set time, you now know how big to make your accumulator, and how much precision your math must handle.<br />
</p>
</div></article>



<article><div class="comment by-bob-s" id="c372404">


<p class="commentcredit"><span class="commenter">Bob S</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372404">May 16, 2009  1:05 AM</a>
</p>

<p>Not to flog a dead horse, but I thought exponential averages were characterized by moving windows.</p>

<p>The problem of defining accuracy "beyond a reasonable doubt" is interesting. The straightforward method would seem to be to treat the problem as a one-sided hypothesis test in which (a) the null hypothesis is that measured breath alcohol content (BrAC) does not exceed the legal limit, and (b) the false-positive probability is small enough that it's beyond reasonable to doubt that an observation large enough to cause rejection of the null would indicate an illegally high BrAC. If a false positive rate of 2.5% were judged sufficiently low, for a simple example, then you would need to obtain a measured BrAC level about two standard deviations of measurement error above the legal limit (assuming normally distributed errors) to support a principled, beyond-reasonable-doubt argument for conviction based on a high BrAC. The determination of measurement error would be tricky, perhaps expensive (because to do it right might possibly require a lot of empirical work), and might ultimately lead to disturbing conclusions about the reliability of the test.</p>

<p>Of course (to echo previous commenters), life would be better and simpler if people would just not drink and drive.</p>
</div></article>



<article><div class="comment by-max" id="c372515">


<p class="commentcredit"><span class="commenter"><a title="http://www.maxthe3rd.com" href="http://www.maxthe3rd.com" rel="nofollow">Max</a></span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372515">May 16, 2009  2:50 PM</a>
</p>

<p>If they had acceptance tests which were public - tests that specify product design rather than technical design - they would be able to show what their code does without showing the code, itself.</p>

<p>While that may not have prevented them from from having to show the code in a court of law, it at least would have saved them the embarrassment of having their software be so flawed when it was examined...</p>
</div></article>



<article><div class="comment by-dogfood" id="c372530">


<p class="commentcredit"><span class="commenter">Dogfood</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372530">May 16, 2009  4:16 PM</a>
</p>

<p>I always knew these breathalyzer tests were a bunch of crap.  I got arrested for DUI because I got pulled over for a broken taillight, the cop smelled beer, and drunk tested me.  I blew a 0.12 BAC and he hauled me in for the night.  Guess what the blood test showed?  0.03 BAC.  I had two pints of beer with food at a restaurant in 90 minutes, so there's no way I should've registered anywhere near 0.12.</p>

<p>I beat the rap even though the cop took it to court and told the judge that my eyes were bloodshot, I smelled "strongly" of alcohol, and I was stumbling.  After being found not-guilty, the judge chewed me out for 5 minutes and told me that I was lucky "this time".  0.03 and they act like I'm on a 3-day binge, driving over lampposts and shit.  </p>

<p>Screw them, that was 1991 and I've only had two tickets since!!  I say the breathalyzer sucks.</p>
</div></article>



<article><div class="comment by-reality" id="c372534">


<p class="commentcredit"><span class="commenter">Reality</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372534">May 16, 2009  4:31 PM</a>
</p>

<p>?I hope the departments that bought these things sue the pants off the manufacturer."</p>

<p>Are you kidding?  They are probably giving a per-arrest kick-back to Draeger.  Every lawyer knows that if a cop needs or wants to make a DUI arrest, the suspect (aka victim) will blow over the limit.  It makes no difference how much he/she has actually had to drink or the level of actual impairment. And everyone fails the sobriety tests, even sober people.  DUI is a major cash cow for police and county governments.  They're going to stack the deck in their favor.  They know that a good lawyer can beat a bad DUI rap, but most people don't have the $10K in legal fees needed to do so.</p>
</div></article>



<article><div class="comment by-engineer-in-training" id="c372570">


<p class="commentcredit"><span class="commenter">Engineer in Training</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372570">May 16, 2009  9:42 PM</a>
</p>

<p>I'm a 3rd year Computer Engineer, and I'm calling them out on being just plain lazy. The average is computed exponentially because they didn't want to include libraries for floating-points or for 32-bit integers. Add up more than 16 12-bit integers, and you have to worry about overflowing a 16-bit int. I ran into the same problem in lab. And I tried the same solution. And my professor rightly bitched me out, because I was taking the lazy way out, and losing precision in the process. THIS DOESN'T FLY IN UNDERGRAD UNIVERSITY CLASSES.</p>

<p>Same thing with the interrupts. If you write code in C and use an assembler, sometimes it's going to "optimize" something critical out, or overflow a buffer, with the end result being the processor gets lost, and tries to interpret data as code. This causes an illegal op-code interrupt, which is basically a red flag that tells you that something went wrong, and you probably shouldn't trust your data, because the processor has been following garbage instead of instructions. When you get these interrupts in the debugging/testing phase of development, it means that you really ought to go back, figure out what's going wrong, and correct the bugs. Of course, this is difficult, as it means you have to wade through hundreds to thousands of lines of Assembly code, which is second only to machine code in terms of unreadability. So, if you're lazy, or pressed for time, you just ignore the warning signs, and put the processor back on track SOMEWHERE around where it left off. You've probably overwritten some of your data with nonsense at this point, but you hope that it wasn't important. If you're, say, trying to get something working long enough to get a passing grade in a class, this can work. If you're trying to create a tool that will be used by law enforcement officers to determine whether someone has been recklessly endangering lives, GO BACK AND FIX IT.</p>
</div></article>



<article><div class="comment by-forever-me" id="c372576">


<p class="commentcredit"><span class="commenter">Forever Me</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372576">May 16, 2009 10:48 PM</a>
</p>

<p>I'd like to see any document where the claim was made that operation was 'perfect'. Nothing is perfect, certainly not a product. There are just levels of reliability and repeatability. There are also likely environmental variables such as whether a person may have properly used mouthwash containing alcohol during previous hours.</p>
</div></article>



<article><div class="comment by-markm" id="c372577">


<p class="commentcredit"><span class="commenter">markm</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372577">May 16, 2009 10:51 PM</a>
</p>

<p>1) In embedded control software, this<br />
is an easy way to balance over-reacting <br />
to input changes that might just be<br />
glitches versus reacting too slowly to<br />
real changes as one waits for the <br />
average to change. A very simple <br />
calculation weights the readings 1/2, <br />
1/4, 1/8, ... It only cuts the impact <br />
of noise in the readings by 1/2, but <br />
it gets most of a consistent change <br />
into the average after two readings. <br />
A straight unweighted running average <br />
of the last two readings would work <br />
slightly better, but would double the <br />
memory requirements and add or <br />
subtract steps. </p>

<p>But this is grossly mis-applied <br />
in a breathalyzer; there's no need for <br />
a running average, instead it should be <br />
adding up a complete run of data and <br />
only then computing the average. No <br />
way is that weighting scheme a <br />
reasonable approximation to any <br />
mathematically defensible weighting <br />
of the average. In other words, they <br />
copied a program meant for a quite <br />
different purpose without thinking <br />
about the real goal. </p>

<p>OTOH, given the backwards explanation <br />
of the averaging scheme in the report, <br />
can we trust the report (or the translation) to be usefully accurate?</p>

<p>2) If the report is accurate, this feature of the program is just plain ridiculous.</p>

<p>3) The report is at least partly nitpicking here. Not using COP may be a bad sign.  Not using interrupts is a good thing, when you can get the job done without them - it makes the software more predictable and easier to test and debug.  <br />
</p>
</div></article>



<article><div class="comment by-clive-robinson" id="c372626">


<p class="commentcredit"><span class="commenter">Clive Robinson</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372626">May 17, 2009  5:59 AM</a>
</p>

<p>@ Engineer in Training,</p>

<p>Although I agree with you that they could have put more effort in, all embeded systems engineering has resource constraints. However not all the constraints are immediatly obvious to ordinary software engineers and are very rarely taught at Uni or other formal educational establishment.</p>

<p>One such constraint is battery life, it is usually an excedingly complex thing to "trade off" with differing technologies in use. The usuall solution is to minimise CPU speed and time that parts of the circuit are powered up.</p>

<p>Even for CPUs with FPUs the use of FP is usually battery hungry and therfore best avoided when ever and where ever possable (and if you can get rid of int mul and div so much the better).</p>

<p>When you say,</p>

<p>"Add up more than 16 12-bit integers, and you have to worry about overflowing a 16-bit int."</p>

<p>You are making a number of assumptions which sugest a lack of familiarity with consumer grade embeded design.</p>

<p>Most analogue inputs are based on an unsigned value read from an AD converter. This at some point MAY have to be converted to a signed number or not (and lose a bit of precision in the process). </p>

<p>Also invariably only a small part of the AD range is actually used due to avoiding the use of expensive high tolarance components (that's what software is for ;).</p>

<p>Also the thing about analogue input from instrumentation is that it changes oh so slowly with respect to the CPU clock. Which opens up a number of possabilities.</p>

<p>A simple solution for the avarage and sign convertion is to use a delta average. Basicaly you either know or compute an artificial zero point and subtract this from the unsigned AD value the result will be a signed int usually of a quite small value. These values can usually be averaged to some considerable extent without any loss of    precision or risk of overflow.</p>

<p>The simplest and fastest way is to use a "running window average". Where you have three values, new, old, window. For each reading you subtract the old value and add the new value to the window value. The distance between the old value and the new value in the number of readings defines the size of the window and hence the precision of the data held in the window. If this size is chosen to be a power of two then normalising back is simply a case of copying the window value and shifting it down, then add on the artificial zero value if required (which offten it is not).</p>

<p>So no "muls" "divs" or pointers etc required.</p>

<p>You can use a similar trick when doing DSP with bi-quad filters where you want to have a significantly small cut off frequency with respect to the sampling frequency.</p>

<p>The usuall MAD constants will be very very close to an integer value such as 2 therfore instead of using the value use 2-value and shift the values appropriatly. You can get close to effectivly doubling the size of the number of bits available to you (ie a 16bit DSP producing results similar to a 30bit DSP).</p>

<p>Oh and if you intend going down the embeded route learn the ins and outs of 1's and 2's complement and work out how you can use either as sometimes you will save yourself a lot of time and CPU cycles which can be of better use else where.</p>

<p>Oh and with regards the CPU losing it's way. For this application which is neither a one shot or safety critical the best solution is to exit with an error number on the display forcing the operator to turn the unit off and on again forcing a compleate re-initialisation of the device.</p>

<p>And if you are going to develop an embeded system first split the job into two parts the first is a BIOS or OS the second the actuall functionality.</p>

<p>When developing your BIOS/OS make it as close to *nix or Possix as you can that way you ease not only your development tool chain issues, you also make it easier to use existing code from other places. Just remember not to use the I/O "blocking" and threading methodology unless the CPU can support context switching (which most low cost CPU's cannot due to stack issues). Remember to be multi-thredded does not require an MMU (multi process does) but it can make life a lot easier 8)</p>

<p>Oh and avoid "signals" they are oh so slow, develop IPC via ring buffers (or C-Lists if you have the RAM) use proper top and bottom handlers on interupts and prioratise acording to function Hard Real Time, High speed Async, etc.</p>

<p>Use the highest system tic you can and break I/O control into small blocks that will fully compleate in around 1/4 max of the tic interval. State machine design and buffers realy are your friends when you are trying to get past 50% utilisation of CPU resources.</p>
</div></article>



<article><div class="comment by-anonymous" id="c372668">


<p class="commentcredit"><span class="commenter">Anonymous</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372668">May 17, 2009 10:58 AM</a>
</p>

<p>This is the very definition of moving average:</p>

<p>"Readings are Not Averaged Correctly: When the software takes a series of readings, it first averages the first two readings. Then, it averages the third reading with the average just computed. Then the fourth reading is averaged with the new average, and so on. There is no comment or note detailing a reason for this calculation, which would cause the first (last?) reading to have more weight than successive readings. Nonetheless, the comments say that the values should be averaged, and they are not. "</p>
</div></article>



<article><div class="comment by-geoff-sherrington" id="c372773">


<p class="commentcredit"><span class="commenter">Geoff Sherrington</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372773">May 17, 2009  9:39 PM</a>
</p>

<p>The whole discussion, though important for standards, is academic. As the former owner of a large analytical chemistry laboratory, we used to work on a sound principle. </p>

<p>You do not take a measurement when the property is changing, then use it as a representation of a fixed condition.</p>

<p>Blood alcohol rises to a peak about half an hour after ingestion then decays away over 8 hours to a quite low value. Breath alcohol can be all over the place in the short term from fluid retained in the mouth.</p>

<p>A breath test taken in the rising period is likely to be quite unreliable. Also, the driver could be safely home and asleep in that time, a menace to nobody.</p>

<p>Even where the breath analyser is used for triage, one needs to examine the software of the following blood alcohol device. I would expect more programming errors in the latter, because it's more complex.</p>
</div></article>



<article><div class="comment by-chris-williams" id="c372954">


<p class="commentcredit"><span class="commenter">Chris Williams</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c372954">May 18, 2009 12:43 PM</a>
</p>

<p>Those who have access to it could usefully check out this:<br />
International Review of Law, Computers & Technology, Jul2004, Vol. 18 Issue 2,<br />
It was a special issue on electronic evidence.</p>

<p>PS - sorry if someone's mentioned it upthread - this comment is just a driveby from a guy in a hurry.</p>
</div></article>



<article><div class="comment by-mysticdog" id="c373306">


<p class="commentcredit"><span class="commenter">Mysticdog</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c373306">May 19, 2009  3:24 PM</a>
</p>

<p>It is also interesting to note that by overweighting the later values during "averaging", it is going to tend to skew to the higher numbers. This is because the lungs keep a resevoir of air that isn't exchanged much except when blowing out hard, and that air builds up more alcohol. So when the cops tell you to blow hard, your last readings will almost be higher than your first readings, and then the machine's code skews the "average" to those higher readings.</p>
</div></article>



<article><div class="comment by-ebt" id="c374027">


<p class="commentcredit"><span class="commenter">EBT</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c374027">May 22, 2009  9:58 AM</a>
</p>

<p>I am not a programmer, but rather work with breath testing and have found the posts here most interesting.  </p>

<p>I currently have a file on a guy that blew a 0.223 and a 0.227 (7 minutes apart) and an hour later a 0.014 blood.  A programmer I know suggested that maybe the decimal place on the breath was shifted and should have read 0.022 not 0.22 on the breath samples.  This would make sense with the blood results an hour later.  </p>

<p>So my question to you folks is, are decimal shifts really possible as my friend has indicated?  Is there anywhere I can learn about this? </p>

<p>(and for the record, the blood was analyzed at two separate labs with the identical results.)</p>
</div></article>



<article><div class="comment by-alan-candeletti" id="c1816997">


<p class="commentcredit"><span class="commenter">ALAN CANDELETTI</span> &bull; <a href="https://www.schneier.com/blog/archives/2009/05/software_proble.html#c1816997">October  2, 2013  4:47 PM</a>
</p>

<p>Well,  all this means is  good people  lost there right to drive, there jobs, maybe time in jail, and paid like $ 12,000 DOLLARS IN FINES,<br />
just because software is bad.</p>
</div></article>




<p class="subscribe-comments"><a href="https://www.schneier.com/blog/archives/2009/05/software_proble.xml"><img alt="Atom Feed" src="/images/rss-16px.png">Subscribe to comments on this entry</a></p>

  <div class="postcomment notpreviewed">

    
    
    <div class="comments-open" id="comments-open">
        <h2 class="comments-open-header">Leave a comment</h2>
        <div class="comments-open-content">

        
            <div id="comment-greeting"></div>

            <form method="post" action="https://www.schneier.com/cgi-bin/mt/mt-comments.cgi" name="comments_form" id="comments-form" onsubmit="return mtCommentOnSubmit(this)">
                <input type="hidden" name="static" value="https://www.schneier.com/blog/archives/2009/05/software_proble.html?nc=108">
                <input type="hidden" name="entry_id" value="2839" />
                <input type="hidden" name="__lang" value="en-us" />

                <script language="javascript" type="text/javascript"><!--
	                document.write('<input type="hidden" name="armor" value="" /><input type="hidden" name="sid" value="" /><input type="hidden" name="preview" value="" />');
                // --></script>
                <div id="comments-open-data">
                    <div id="comment-form-name">
                        <label for="comment-author">Name (required):</label>
                        <input id="comment-author" name="author" size="30" value="" onfocus="mtCommentFormOnFocus()" />
                    </div>
                    <div id="comment-form-email">
                        <label for="comment-email">E-mail Address:</label>
                        <input id="comment-email" name="email" size="30" value="" onfocus="mtCommentFormOnFocus()" />
                    </div>
                    <div id="comment-form-url">
                        <label for="comment-url">URL:</label>
                        <input id="comment-url" name="url" size="30" value="" onfocus="mtCommentFormOnFocus()" />
                    </div>
                <script language="javascript" type="text/javascript"><!--
                document.write('<div id="comment-form-remember-me"><input type="checkbox" id="comment-bake-cookie" name="bakecookie" onclick="mtRememberMeOnClick(this)" value="1" accesskey="r" /><label class="checkbox" for="comment-bake-cookie">Remember personal info?<\/label><\/div>');
                // --></script>
                </div>
<p id="comments-open-challenge"><input type="hidden" id="commchallenge_beacon" name="commchallenge_beacon" value="1" /><label for="commchallenge_answer">Fill in the blank: the name of this blog is Schneier on ___________ <strong>(required)</strong>:</label>
<input type="text" id="commchallenge_answer" name="commchallenge_answer" size="30" value="" /></p><script type="text/javascript">
<!--    
if ((typeof commenter_name != 'undefined') ||
    (typeof getCommenterName != 'undefined' &&  getCommenterName())) {
    mtHide('comments-open-challenge');
} else {
    mtShow('comments-open-challenge');
} 
// -->
</script>


                <div id="comments-open-text">
                    <label for="comment-text">Comments:</label>
                    <textarea id="comment-text" name="text" onfocus="mtCommentFormOnFocus()"></textarea>
                </div>
		            <p id="allowed"><strong>Allowed HTML:</strong> &lt;a href="URL"&gt; &bull; &lt;em&gt; &lt;cite&gt; &lt;i&gt; &bull; &lt;strong&gt; &lt;b&gt; &bull; &lt;sub&gt; &lt;sup&gt; &bull; &lt;ul&gt; &lt;ol&gt; &lt;li&gt; &bull; &lt;blockquote&gt; &lt;pre&gt;</p>
                <div id="comments-open-captcha"></div>
                <div id="comments-open-footer">

  	                <script language="javascript" type="text/javascript"><!--
										document.write('<input type="submit" accesskey="v" name="preview_button" id="comment-preview" value="Preview" onclick="this.form.preview.value=\'1\';" />');
		                // --></script>
		                <noscript><input type="submit" accesskey="v" name="preview" id="comment-preview" value="Preview"></noscript>
                    
                    <input type="submit" accesskey="s" name="post" id="comment-submit" value="Submit" />
                </div>
            </form>



        </div>
    </div>
    <script type="text/javascript">
    <!--
    mtAttachEvent("load", mtEntryOnLoad);
    mtAttachEvent("unload", mtEntryOnUnload);
    //-->
    </script>
    
    
  </div>








    
    
    
<p id="powered">Photo of Bruce Schneier by Per Ervland.
	
	<p id="disclaim">Schneier on Security is a personal website.  Opinions expressed are not necessarily those of <a href="https://www.co3sys.com/">Co3 Systems, Inc.</a>.


	
	</div><!--#content-->
<aside><div class="sidebar" id="sidebar-two">
		<section><div class="sidesection" id="about">
		
		<h3>About Bruce Schneier</h3>
		<img id="authorphoto" src="https://www.schneier.com/images/bruce-blog3.jpg" width="150" height="194" alt="Bruce Schneier"><p class="small">I've been writing about security issues on my <a href="https://www.schneier.com/">blog</a> since 2004, and in my monthly <a href="https://www.schneier.com/crypto-gram.html">newsletter</a> since 1998. I write <a href="https://www.schneier.com/books.html">books</a>, <a href="https://www.schneier.com/essays.html">articles</a>, and <a href="cryptography.html">academic papers</a>. Currently, I'm the Chief Technology Officer of <a href="https://www.co3sys.com/">Co3 Systems</a>, a fellow at Harvard's <a href="http://berkman.harvard.edu/">Berkman Center</a>, and a board member of <a href="https://www.eff.org/">EFF</a>.</p>
		</div></section>


		<section><div class="sidesection">
			<h3>Related Entries</h3>
			<ul>
     			<li><a href="https://www.schneier.com/blog/archives/2008/11/us_court_rules.html">U.S. Court Rules that Hashing = Searching</a></li>
   			
     			<li><a href="https://www.schneier.com/blog/archives/2013/03/technologies_of.html">Technologies of Surveillance</a></li>
   			
     			<li><a href="https://www.schneier.com/blog/archives/2010/06/filming_the_pol.html">Filming the Police</a></li>
   			
     			<li><a href="https://www.schneier.com/blog/archives/2009/01/the_exclusionar.html">The Exclusionary Rule and Security</a></li>
   			
     			<li><a href="https://www.schneier.com/blog/archives/2007/06/third_party_con.html">Third Party Consent and Computer Searches</a></li>
   			</ul>
		</div></section>


	<section><div class="sidesection">

    

		<h3>Featured Essays</h3>
		<ul>
			<li><a href="https://www.schneier.com/essay-472.html">It's Time to Break Up the NSA</a></li>
			<li><a href="https://www.schneier.com/essay-469.html">How the NSA Threatens National Security</a></li>
			<li><a href="https://www.schneier.com/essay-258.html">Terrorists May Use Google Earth, but Fear is No Reason to Ban It</a></li>
			<li><a href="https://www.schneier.com/essay-154.html">In Praise of Security Theater</a></li>
			<li><a href="https://www.schneier.com/essay-114.html">The Eternal Value of Privacy</a></li>
			<li><a href="https://www.schneier.com/essay-087.html">Terrorists Don't Do Movie Plots</a></li>
		</ul>
		
    <p><a href="https://www.schneier.com/essays/">more essays</a></p>
		</div></section>




		<section><div class="sidesection">
		
			<h3>Blog Archives</h3>
			<ul>
				<li><a href="https://www.schneier.com/blog/calendar.html">Archives by Date</a></li>
				<li><a href="https://www.schneier.com/blog/newcomments.html">100 Latest Comments</a></li>
			</ul>
		


        
		<h4>Blog Tags</h4>
<ul class="top-tags">
		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=privacy&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">privacy</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=terrorism&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">terrorism</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=surveillance&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">surveillance</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=squid&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">squid</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=air%20travel&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">air travel</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=DHS&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">DHS</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=homeland%20security&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">homeland security</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=law%20enforcement&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">law enforcement</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=academic%20papers&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">academic papers</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=cryptography&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">cryptography</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=economics%20of%20security&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">economics of security</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=crime&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">crime</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=NSA&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">NSA</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=Schneier%20news&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">Schneier news</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=TSA&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">TSA</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=hacking&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">hacking</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=essays&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">essays</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=laws&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">laws</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=national%20security%20policy&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">national security policy</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=computer%20security&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">computer security</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=malware&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">malware</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=encryption&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">encryption</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=fraud&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">fraud</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=psychology%20of%20security&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">psychology of security</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=police&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">police</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=physical%20security&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">physical security</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=cost-benefit%20analysis&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">cost-benefit analysis</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=fear&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">fear</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=bombs&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">bombs</a></li>

		<li><a href="https://www.schneier.com/cgi-bin/mt/mt-search.cgi?search=courts&amp;__mode=tag&amp;IncludeBlogs=2&amp;limit=10&amp;page=1">courts</a></li>
</ul>
<p><a href="https://www.schneier.com/blog/tags.html">more tags</a></p>


	
		</div></section>
		
		<section><div class="sidesection">
		<h3>Latest Book</h3>
		<a href="https://www.schneier.com/book-co.html"><img class="sidepic"  alt="Carry On" src="https://www.schneier.com/images/book-co-175w.jpg"></a>
		<p><a href="https://www.schneier.com/books.html">more books</a></p>
		</div></section>
		
		<section><div class="sidesection">
		<a href="https://www.eff.org/issues/bloggers/legal/join"><img id="effbutton" src="https://www.schneier.com/images/eff-150x40.gif" ALT="Support Bloggers' Rights!" width="150" height="40"></a>
		
		<a href="https://npo.networkforgood.org/Donate/Donate.aspx?npoSubscriptionId=8252"><img src="https://www.schneier.com/images/epic-150w.png" width="150" height="54" alt="Defend Privacy--Support Epic"></a>

		</div></section>

		<section><div class="sidesection">
		<a href="https://www.co3sys.com/"><img class="sidepic" alt="Co3 Systems" src="https://www.schneier.com/images/co3-logo-175w.jpg"></a>	

		</div></section>

		
	</div></aside>


<footer><nav><div class="nav" id="footer-nav">
<ul>
		<li class="menu1 current"><a href="https://www.schneier.com/">Blog</a></li>
		<li class="menu2"><a href="https://www.schneier.com/crypto-gram.html">Newsletter</a></li>
		<li class="menu3"><a href="https://www.schneier.com/books.html">Books</a></li>
    <li class="menu4"><a href="https://www.schneier.com/essays/">Essays</a></li>
		<li class="menu5"><a href="https://www.schneier.com/news.html">News</a></li>
		<li class="menu6"><a href="https://www.schneier.com/schedule.html">Schedule</a></li>
		<li class="menu7"><a href="https://www.schneier.com/cryptography.html">Crypto</a></li>
		<li class="menu8"><a href="https://www.schneier.com/about.html">About Me</a></li>
	</ul>
	
	</div></nav></footer>

</div><!--#main-->
</div><!--#wrapper-->

</body>
</html>



